!function(){angular.module("appModule",["ngRoute","ngCookies","ui.bootstrap","clientModule","supplierModule","vehicleModule","itemModule","app","dashBoardModule","itemSalesModule","paymentVoucherModule","purchaseOrderApproveModule","purchaseOrderRequestModule","grnApproveModule","directGrnModule","grnModule","accountSettingModule","userPermissionModule"]),angular.module("appModule").constant("systemConfig",{apiUrl:"localhost"===location.hostname?"http://localhost:8080":location.protocol+"//"+location.hostname+(location.port?":"+location.port:"")}),angular.module("appModule").config(["$routeProvider",function(e){e.when("/",{redirectTo:"/account/home"}).when("/login",{templateUrl:"app/system/login/login.html",controller:"LoginController"}).when("/account/home",{templateUrl:"app/service/dash-board/dash-board.html",controller:"dashBoardController"}).when("/reports/general/report-viewer",{templateUrl:"app/reports/report-viewer/report-viewer.html",controller:"ReportViewerController"}).when("/master/create-account",{templateUrl:"app/master/create-account/create-account.html",controller:"createAccountController"}).when("/master/client",{templateUrl:"app/master/client/client.html",controller:"clientController"}).when("/master/supplier",{templateUrl:"app/master/supplier/supplier.html",controller:"supplierController"}).when("/master/item",{templateUrl:"app/master/item/item.html",controller:"itemController"}).when("/transaction/bank-reconciliation",{templateUrl:"app/accounts/bank-reconciliation/bank-reconciliation.html",controller:"bankReconciliationController"}).when("/transaction/fund-transfer",{templateUrl:"app/accounts/fund-transfer/fund-transfer.html",controller:"fundTransferController"}).when("/transaction/general-voucher",{templateUrl:"app/accounts/voucher/voucher.html",controller:"voucherController"}).when("/transaction/trial-balance",{templateUrl:"app/accounts/trial-balance/trial-balance.html",controller:"trialBalanceController"}).when("/transaction/supplier-payment",{templateUrl:"app/accounts/supplier-payment/supplier-payment.html",controller:"supplierPaymentController"}).when("/transaction/return-cheque",{templateUrl:"app/accounts/return-cheque/return-cheque.html",controller:"returnChequeController"}).when("/transaction/accrued-bill",{templateUrl:"app/accounts/accrued-bill/accrued-bill.html",controller:"accruedBillController"}).when("/transaction/journal",{templateUrl:"app/accounts/journal/journal.html",controller:"journalController"}).when("/service/item-sales",{templateUrl:"app/service/item-sales/item-sales.html",controller:"itemSalesController"}).when("/service/customer-payment",{templateUrl:"app/service/payment-voucher/payment-voucher.html",controller:"customerPaymentVoucherController"}).when("/service/grn-request",{templateUrl:"app/service/grn/grn-request/grn-request.html",controller:"grnController"}).when("/service/grn-approve",{templateUrl:"app/service/grn/grn-approve/grn-approve.html",controller:"grnApproveController"}).when("/service/grn-direct",{templateUrl:"app/service/grn/grn-direct/grn.html",controller:"directGrnController"}).when("/service/purchase-order-request",{templateUrl:"app/service/purchase-order/request/purchase-order-request.html",controller:"purchaseOrderRequestController"}).when("/service/purchase-order-approve",{templateUrl:"app/service/purchase-order/approve/purchase-order-approve.html",controller:"purchaseOrderApproveController"}).when("/setting/account-settings",{templateUrl:"app/setting/account-setting/account-settings.html",controller:"accountSettingController"}).when("/setting/user-permission",{templateUrl:"app/setting/user-permission/user-permission.html",controller:"userPermissionController"}).otherwise({redirectTo:"/"})}])}(),function(){angular.module("appModule").controller("accruedBillController",["$scope","accruedBillModel","$timeout","$filter","Notification","ConfirmPane",function(e,t,n,a,i,o){e.model=new t,e.ui={},e.model.currentBranch={},e.model.type=null,e.ui.focus=function(e){n(function(){document.querySelectorAll(e)[0].focus()},10)},e.ui.new=function(){e.ui.mode="NEW",e.ui.focus("#account"),e.model.tempData.transactionDate=new Date,e.model.data.transactionDate=new Date,e.model.tempData.branch=e.model.data.branch},e.ui.addData=function(){var t=!0;e.model.tempData.accAccount||(t=!1,i.error("select a account to add !")),e.model.tempData.branch||(t=!1,i.error("select a branch to add !")),e.model.tempData.description||(t=!1,i.error("insert description to add !")),e.model.data.transactionDate||(t=!1,i.error("insert a Date to add !")),e.model.tempData.debit||(t=!1,i.error("insert amount to add !")),e.model.data.accAccount||(t=!1,i.error("select a main account to add !")),e.model.data.typeIndexNo||(t=!1,i.error("select an accrued account to save !")),a("date")(e.model.data.transactionDate,"yyyy-MM-dd")>a("date")(new Date,"yyyy-MM-dd")&&(t=!1,i.error("transfer date not valid ! ")),t&&(e.model.addData(),e.ui.new(),e.ui.focus("#subAccount"))},e.ui.save=function(){var t=!0;e.model.data.accAccount||(t=!1,i.error("select a main account to save !")),0===e.model.saveDataList.length&&(t=!1,i.error("empty transfer item to save !")),e.model.data.credit||(t=!1,i.error("total value 0.00 !")),e.model.data.description||(t=!1,i.error("insert description to save !")),e.model.userPermission.add||(t=!1,i.error("you have no permission ")),a("date")(e.model.data.transactionDate,"yyyy-MM-dd")>a("date")(new Date,"yyyy-MM-dd")&&(t=!1,i.error("transfer date not valid ! ")),t&&o.primaryConfirm("DO YOU WANT TO SAVE THIS FUND TRANSFER !").confirm(function(){e.model.save().then(function(t){i.success("payment voucher save Sucess"),e.ui.mode="IDEAL",e.model.data={},e.model.saveDataList=[]})})},e.ui.edit=function(t,n){e.model.tempData=n,e.model.saveDataList.splice(t,1),e.model.totalCalculation()},e.ui.delete=function(t){e.model.saveDataList.splice(t,1),e.model.totalCalculation()},e.ui.selectAccType=function(t){e.model.selectAccType=t,e.model.type=t.value,e.ui.focus("#account"),e.model.setClear(),console.log(e.model.selectAccType)},e.ui.focusAdd=function(t){13===t.which&&e.ui.addData()},e.ui.init=function(){e.ui.mode="IDEAL"},e.ui.init()}])}(),function(){angular.module("appModule").factory("accruedBillFactory",function(){var e={};return e.Data=function(){return{indexNo:null,transactionDate:null,currentDate:null,time:null,branch:null,currentBranch:null,user:null,debit:0,credit:0,accAccount:null,formName:"accrued_bill",refNumber:null,type:"accrued",typeIndexNo:null,description:"",chequeDate:null,bankReconciliation:!1,reconcileAccount:null,reconcileGroup:0}},e.tempData=function(){return{indexNo:null,transactionDate:null,currentDate:null,time:null,branch:null,currentBranch:null,user:null,debit:0,credit:0,accAccount:null,formName:"accrued_bill",refNumber:null,type:"accrued",typeIndexNo:null,description:"",chequeDate:null,bankReconciliation:!1,reconcileAccount:null,reconcileGroup:0}},e})}(),function(){var e=function(e,t,n,a,i,o){function r(){this.constructor()}return r.prototype={data:{},tempData:{},currentBranch:{},selectAccType:{},userPermission:{},accAccountList:[],branchList:[],supplierList:[],saveDataList:[],accTypeList:[],accflowList:[],constructor:function(){var n=this;n.data=e.Data(),n.tempData=e.tempData(),t.loadBranch().success(function(e){n.branchList=e}),t.loadSupplier().success(function(e){n.supplierList=e}),t.currentBranch().success(function(e){n.currentBranch=e,n.data.branch=e.indexNo}),t.loadAccTypes().success(function(e){n.accTypeList=e}),t.getPermission("Accrued Bill").success(function(e){console.log(e),n.userPermission=e}),this.loadAccAccount()},loadAccAccount:function(){var e=this;t.loadAccAccounts().success(function(t){e.accAccountList=t})},getValue:function(e){var n=this,a=null;angular.forEach(n.supplierList,function(t){if(e===parseInt(t.indexNo))return void(a=t.accAccount)}),n.data.accAccount=a,console.log(a),null!==a?(t.loadAccBalance(a).success(function(e){n.data.value=e}),n.setAccountFlow(a)):o.error("this supplier not link  to account system !")},setAccountFlow:function(e){var n=this;t.setAccFlow(e).success(function(e){n.accflowList=e,console.log(e)})},branchLable:function(e){var t;return angular.forEach(this.branchList,function(n){if(n.indexNo===e)return void(t=n.branchCode+" - "+n.name)}),t},supplierLable:function(e){var t;return angular.forEach(this.supplierList,function(n){if(n.indexNo===e)return void(t=n.indexNo+" - "+n.name)}),t},accountLable:function(e){var t;return angular.forEach(this.accAccountList,function(n){if(n.indexNo===e)return void(t=n.accCode+" - "+n.name)}),t},addData:function(){var t=this;this.tempData.transactionDate=i("date")(this.data.transactionDate,"yyyy-MM-dd"),this.saveDataList.push(this.tempData),this.tempData=e.tempData(),a(function(){t.totalCalculation()},30)},totalCalculation:function(){var e=0;angular.forEach(this.saveDataList,function(t){console.log(t),e+=parseFloat(t.debit)}),this.data.credit=e},save:function(){var e=this,a={};a.dataList=this.saveDataList,this.data.transactionDate=i("date")(this.data.transactionDate,"yyyy-MM-dd"),this.data.chequeDate=i("date")(this.data.chequeDate,"yyyy-MM-dd"),a.data=this.data,console.log(a);var o=n.defer();return t.saveAccruedBill(JSON.stringify(a)).success(function(t){e.saveDataList=[],o.resolve(t)}).error(function(e){o.reject(e)}),o.promise},setClear:function(){this.tempData=e.tempData(),this.data=e.Data(),this.tempData.transactionDate=new Date,this.data.transactionDate=new Date,this.tempData.branch=this.currentBranch.indexNo,this.data.branch=this.currentBranch.indexNo,this.saveDataList=[]}},r};e.$inject=["accruedBillFactory","accruedBillService","$q","$timeout","$filter","Notification"],angular.module("appModule").factory("accruedBillModel",e)}(),function(){var e=function(e,t){this.loadAccAccounts=function(){return e.get(t.apiUrl+"/api/care-point/account/master/acc-account/find-type-accounts")},this.currentBranch=function(){return e.get(t.apiUrl+"/api/care-point/master/branch/current-branch")},this.loadBranch=function(){return e.get(t.apiUrl+"/api/care-point/master/branch")},this.loadSupplier=function(){return e.get(t.apiUrl+"/api/care-point/master/supplier")},this.loadAccBalance=function(n){return e.get(t.apiUrl+"/api/care-point/account/master/acc-account/find-account-value/"+n)},this.loadAccTypes=function(){return e.get(t.apiUrl+"/api/care-point/master/account-type")},this.saveAccruedBill=function(n){return e.post(t.apiUrl+"/api/care-point/transaction/accred-bill/save",n)},this.setAccFlow=function(n){return e.get(t.apiUrl+"/api/care-point/account/master/acc-account/get-account-flow/"+n)},this.getPermission=function(n){return e.get(t.apiUrl+"/api/care-point/account/account-setting/user-permission/by-form/"+n)}};e.$inject=["$http","systemConfig"],angular.module("appModule").service("accruedBillService",e)}(),function(){angular.module("appModule").controller("bankReconciliationController",["$scope","$filter","bankReconciliationModel","$timeout","$uibModalStack","$uibModal","Notification","ConfirmPane",function(e,t,n,a,i,o,r,c){e.model=new n,e.ui={},e.model.currentBranch={},e.ui.focus=function(e){a(function(){document.querySelectorAll(e)[0].focus()},10)},e.ui.new=function(){e.ui.mode="NEW",e.ui.focus("#bankAccount"),e.model.tempData.transactionDate=new Date},e.ui.selectReconciliationCheque=function(n){var a=!0;e.model.data.transactionDate||(a=!1,r.error("select a reconciliation date !")),e.model.data.accAccount||(a=!1,r.error("select an account to reconcile selected cheque !")),t("date")(e.model.data.transactionDate,"yyyy-MM-dd")>t("date")(new Date,"yyyy-MM-dd")&&(a=!1,r.error("transfer date not valid ! ")),a&&c.primaryConfirm("DO YOU WANT TO RECONCILE THIS CHEQUE !").confirm(function(){e.model.addReconciliationCheque(n)})},e.ui.addReconciliationData=function(){e.model.data.accAccount?(e.model.setIncomeExpenceAccount(),o.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"reconciliationPopup.html",scope:e,size:"lg"})):r.error("select a bank account to view oher reconcile popup ! ")},e.ui.addClass=function(e){return"reconcile"===e.class?"bg-danger":"other"===e.class?"bg-success":"background-dark"},e.ui.modelCancel=function(){i.dismissAll()},e.ui.save=function(){var t=!0;e.ui.reconcileCheque()||(t=!1,r.error("Reconcile Cheque is empty !")),e.model.userPermission.add||(t=!1,r.error("you have no permission ")),t&&e.model.save()},e.ui.reconcileCheque=function(){var t=!1;return angular.forEach(e.model.saveDataList,function(e){if("reconcile"===e.class)return void(t=!0)}),t},e.ui.delete=function(t){if(t.class)e.model.remove(t);else{var n=!0;e.model.userPermission.delete||(n=!1,r.error("you have no permission ")),n&&c.warningConfirm("DO YOU WANT TO DELETE THIS TRANSACTION !").confirm(function(){e.model.delete(t)})}},e.ui.popupSelectAccAccount=function(t){e.model.disableValue="",angular.forEach(e.model.incomeExpenceAccList,function(n){if(n.indexNo===t)return void(e.model.disableValue=n.accMain.isExpence?"debit":"credit")})},e.ui.popupAddData=function(){var t=!0;e.model.tempData.accAccount||(t=!1,r.error("select an account to add data ")),e.model.tempData.branch||(t=!1,r.error("select a branch to add data")),e.model.tempData.transactionDate||(t=!1,r.error("select a date to add data")),e.model.tempData.credit||e.model.tempData.debit||(t=!1,r.error("add credit or debit amount to add date")),t&&e.model.popupAddData()},e.ui.popupSave=function(){var t=!0;e.model.popupDataList.length||(t=!1,r.error("Empty data to save")),e.model.userPermission.add||(t=!1,r.error("you have no permission ")),t&&(e.model.popupSave(),e.ui.modelCancel())},e.ui.init=function(){e.ui.mode="IDEAL"},e.ui.init()}])}(),function(){angular.module("appModule").factory("bankReconciliationFactory",function(){var e={};return e.Data=function(){return{indexNo:null,transactionDate:null,currentDate:null,time:null,branch:null,currentBranch:null,user:null,debit:0,credit:0,accAccount:null,formName:"bank_reconciliation",refNumber:null,type:"reconciliation",typeIndexNo:null,description:"",chequeDate:null,monthStart:null,balance:0,deleteRefNo:0,reconcileAccount:null,reconcileGroup:0}},e.tempDate=function(){return{indexNo:null,transactionDate:null,currentDate:null,time:null,branch:null,currentBranch:null,user:null,debit:0,credit:0,accAccount:null,formName:"bank_reconciliation",refNumber:null,type:"reconciliation",typeIndexNo:null,description:"",chequeDate:null,deleteRefNo:0,reconcileAccount:null,reconcileGroup:0}},e})}(),function(){var e=function(e,t,n,a,i,o){function r(){this.constructor()}return r.prototype={data:{},tempData:{},currentBranch:{},userPermission:{},accAccountList:[],incomeExpenceAccList:[],branchList:[],reconciliationList:[],saveDataList:[],popupDataList:[],accTypeList:[],totBalance:0,constructor:function(){var n=this;n.data=e.Data(),n.tempData=e.tempDate(),t.loadBranch().success(function(e){n.branchList=e}),t.currentBranch().success(function(e){n.currentBranch=e,n.data.branch=e.indexNo}),t.getPermission("Bank Reconciliation").success(function(e){console.log(e),n.userPermission=e}),this.loadAccAccount()},loadAccAccount:function(){var e=this;t.loadAccAccounts().success(function(t){e.accAccountList=t})},selectBankAccount:function(e,n){var a=this,o=i("date")(n,"yyyy-MM-dd");t.getReconciliationDetail(e,o).success(function(e){a.reconciliationList=e,a.reconciliationValueCaluclator()}),t.loadAccBalance(e).success(function(e){a.data.value=e})},selectDate:function(){this.reconciliationList.length||this.selectBankAccount(this.data.accAccount,this.data.transactionDate);var e=i("date")(this.data.transactionDate,"yyyy"),n=i("date")(this.data.transactionDate,"MM"),a=e+"-"+n+"-1",o=this;t.getStartBalance(a,this.data.accAccount).success(function(e){o.data.monthStart=e,o.totBalance=e}),this.saveDataList.length||o.loadTransactions(e,n,o.data.accAccount)},loadTransactions:function(n,a,i){var o=this,r=n+"-"+a+"-1";console.log("load Transaction"),t.loadTransactions(n,a,i).success(function(t){o.saveDataList=t;var n=e.Data();n.transactionDate=new Date(r),n.description="B / f ",n.balance=o.data.monthStart,o.saveDataList.unshift(n),o.balanceCalculator()})},balanceCalculator:function(){var e=this;e.saveDataList=i("orderBy")(e.saveDataList,"transactionDate"),e.totBalance=e.data.monthStart;var t=0,n=0;angular.forEach(e.saveDataList,function(a){e.totBalance+=a.debit,e.totBalance-=a.credit,a.balance=e.totBalance,t+=a.debit,n+=a.credit}),e.data.value=e.totBalance,e.data.creditTotal=n,e.data.debitTotal=t},reconciliationValueCaluclator:function(){var e=0,t=0;angular.forEach(this.reconciliationList,function(n){e+=n.debit,t+=n.credit}),this.data.reconcileValue=e-t},addReconciliationCheque:function(e){var t=this;angular.forEach(this.reconciliationList,function(n,a){e.class="reconcile",e.transactionDate=i("date")(t.data.transactionDate,"yyyy-MM-dd"),e.indexNo===n.indexNo&&(t.saveDataList.push(e),t.reconciliationList.splice(a,1))}),t.reconciliationValueCaluclator(),t.balanceCalculator()},branchLable:function(e){var t;return angular.forEach(this.branchList,function(n){if(n.indexNo===e)return void(t=n.branchCode+" - "+n.name)}),t},accountLable:function(e){var t;return angular.forEach(this.accAccountList,function(n){if(n.indexNo===e)return void(t=n.indexNo+" - "+n.name)}),t},save:function(){var a=n.defer(),i=this,r=[];angular.forEach(this.saveDataList,function(e){"reconcile"===e.class&&r.push(e)});var c={data:this.data,dataList:r};t.saveBankReconciliation(JSON.stringify(c)).success(function(t){o.success("Reconcile Cheque Save Success"),i.saveDataList=[],i.reconciliationList=[],i.data=e.Data(),a.resolve(t)}).error(function(e){a.reject(e)})},remove:function(e){var t=this;angular.forEach(this.saveDataList,function(n,a){if(e===parseInt(n.indexNo))return t.saveDataList.splice(a,1),void t.reconciliationValueCaluclator()}),t.getDeleteReconciliationCheque(e),t.balanceCalculator()},delete:function(e){var n=this;t.delete(e.deleteRefNo).success(function(t){angular.forEach(n.saveDataList,function(t,a){if(console.log(e.indexNo+" = "+t.indexNo),e.indexNo===parseInt(t.indexNo))return void n.saveDataList.splice(a,1)}),n.balanceCalculator(),o.success("delete success")})},getDeleteReconciliationCheque:function(e){var n=this;t.getDeleteReconciliationCheque(e).success(function(e){n.reconciliationList.push(e),n.reconciliationValueCaluclator()})},setIncomeExpenceAccount:function(){var e=this;angular.forEach(this.accAccountList,function(t){(t.accMain.isExpence||t.accMain.isIncome)&&e.incomeExpenceAccList.push(t)})},popupAddData:function(){var t=this;t.tempData.transactionDate=i("date")(t.tempData.transactionDate,"yyyy-MM-dd"),t.popupDataList.push(t.tempData),t.tempData=e.tempDate(),t.tempData.branch=t.currentBranch.indexNo},popupSave:function(){var e=n.defer(),a=this,r={data:a.data,dataList:a.popupDataList};console.log(r),t.savePopupData(JSON.stringify(r)).success(function(t){o.success("Other Reconcile data Save Success !"),a.popupDataList=[];var n=i("date")(a.data.transactionDate,"yyyy"),r=i("date")(a.data.transactionDate,"MM");a.loadTransactions(n,r,a.data.accAccount),e.resolve(t)}).error(function(t){e.reject(t)})}},r};e.$inject=["bankReconciliationFactory","bankReconciliationService","$q","$timeout","$filter","Notification"],angular.module("appModule").factory("bankReconciliationModel",e)}(),function(){var e=function(e,t){this.loadAccAccounts=function(){return e.get(t.apiUrl+"/api/care-point/account/master/acc-account/find-only-account")},this.currentBranch=function(){return e.get(t.apiUrl+"/api/care-point/master/branch/current-branch")},this.loadBranch=function(){return e.get(t.apiUrl+"/api/care-point/master/branch")},this.loadAccBalance=function(n){return e.get(t.apiUrl+"/api/care-point/account/master/acc-account/find-account-value-all/"+n)},this.getReconciliationDetail=function(n,a){return e.get(t.apiUrl+"/api/care-point/transaction/bank-reconciliation/get-reconciliation-detail/"+a+"/"+n)},this.getStartBalance=function(n,a){return e.get(t.apiUrl+"/api/care-point/transaction/bank-reconciliation/get-start-balance/"+n+"/"+a)},this.loadTransactions=function(n,a,i){return e.get(t.apiUrl+"/api/care-point/transaction/bank-reconciliation/load-transactions/"+n+"/"+a+"/"+i)},this.saveBankReconciliation=function(n){return e.post(t.apiUrl+"/api/care-point/transaction/bank-reconciliation/save",n)},this.savePopupData=function(n){return e.post(t.apiUrl+"/api/care-point/transaction/bank-reconciliation/savePopup",n)},this.getDeleteReconciliationCheque=function(n){return e.get(t.apiUrl+"/api/care-point/transaction/bank-reconciliation/get-delete-reconciliation-cheque/"+n)},this.delete=function(n){return e.delete(t.apiUrl+"/api/care-point/transaction/bank-reconciliation/delete/"+n)},this.getPermission=function(n){return e.get(t.apiUrl+"/api/care-point/account/account-setting/user-permission/by-form/"+n)}};e.$inject=["$http","systemConfig"],angular.module("appModule").service("bankReconciliationService",e)}(),function(){angular.module("appModule").controller("fundTransferController",["$scope","fundTransferModel","$timeout","$filter","Notification","ConfirmPane",function(e,t,n,a,i,o){e.model=new t,e.ui={},e.model.currentBranch={},e.model.type=null,e.ui.focus=function(e){n(function(){document.querySelectorAll(e)[0].focus()},10)},e.ui.new=function(){e.ui.mode="NEW",e.ui.focus("#account"),e.model.tempData.transactionDate=new Date,e.model.data.transactionDate=new Date,e.model.tempData.branch=e.model.data.branch},e.ui.addData=function(){var t=!0;e.model.tempData.accAccount||(t=!1,i.error("select a account to add !")),e.model.tempData.branch||(t=!1,i.error("select a branch to add !")),e.model.tempData.description||(t=!1,i.error("insert description to add !")),e.model.data.transactionDate||(t=!1,i.error("insert a Date to add !")),e.model.tempData.debit||(t=!1,i.error("insert amount to add !")),e.model.data.accAccount||(t=!1,i.error("select a main account to add !")),e.model.saveDataList.length>=1&&(t=!1,i.error("transfer account Limited to one")),a("date")(e.model.data.transactionDate,"yyyy-MM-dd")>a("date")(new Date,"yyyy-MM-dd")&&(t=!1,i.error("transfer date not valid ! ")),t&&(e.model.addData(),e.ui.new(),e.ui.focus("#subAccount"))},e.ui.save=function(){var t=!0;e.model.data.accAccount||(t=!1,i.error("select a main account to save !")),e.model.userPermission.add||(t=!1,i.error("you have no permission ")),0===e.model.saveDataList.length&&(t=!1,i.error("empty transfer item to save !")),e.model.data.credit||(t=!1,i.error("total value 0.00 !")),e.model.data.description||(t=!1,i.error("insert description to save !")),a("date")(e.model.data.transactionDate,"yyyy-MM-dd")>a("date")(new Date,"yyyy-MM-dd")&&(t=!1,i.error("transfer date not valid ! ")),t&&o.primaryConfirm("DO YOU WANT TO SAVE THIS FUND TRANSFER !").confirm(function(){e.model.save().then(function(t){i.success("payment voucher save Sucess"),e.ui.mode="IDEAL",e.model.data={},e.model.saveDataList=[]})})},e.ui.edit=function(t,n){e.model.tempData=n,e.model.saveDataList.splice(t,1),e.model.totalCalculation()},e.ui.delete=function(t){e.model.saveDataList.splice(t,1),e.model.totalCalculation()},e.ui.selectAccType=function(t){e.model.selectAccType=t,e.model.type=t.value,e.ui.focus("#account"),e.model.setClear(),console.log(e.model.selectAccType)},e.ui.focusAdd=function(t){13===t.which&&e.ui.addData()},e.ui.init=function(){e.ui.mode="IDEAL"},e.ui.init()}])}(),function(){angular.module("appModule").factory("fundTransferFactory",function(){var e={};return e.Data=function(){return{indexNo:null,transactionDate:null,currentDate:null,time:null,branch:null,currentBranch:null,user:null,debit:0,credit:0,accAccount:null,formName:"fund_transfer",refNumber:null,type:"voucher",typeIndexNo:null,description:"",chequeDate:null,bankReconciliation:!1,reconcileAccount:null,reconcileGroup:0}},e.tempData=function(){return{indexNo:null,transactionDate:null,currentDate:null,time:null,branch:null,currentBranch:null,user:null,debit:0,credit:0,accAccount:null,formName:"fund_transfer",refNumber:null,type:"voucher",typeIndexNo:null,description:"",chequeDate:null,bankReconciliation:!1,reconcileAccount:null,reconcileGroup:0}},e})}(),function(){var e=function(e,t,n,a,i,o){function r(){this.constructor()}return r.prototype={data:{},tempData:{},currentBranch:{},selectAccType:{},userPermission:{},accAccountList:[],branchList:[],saveDataList:[],accTypeList:[],constructor:function(){var n=this;n.data=e.Data(),n.tempData=e.tempData(),t.loadBranch().success(function(e){n.branchList=e}),t.currentBranch().success(function(e){n.currentBranch=e,n.data.branch=e.indexNo}),t.loadAccTypes().success(function(e){n.accTypeList=e}),t.getPermission("Fund Transfer").success(function(e){console.log(e),n.userPermission=e}),this.loadAccAccount()},loadAccAccount:function(){var e=this;t.loadAccAccounts().success(function(t){e.accAccountList=t})},getValue:function(e){var n=this;t.loadAccBalance(e).success(function(e){n.data.value=e})},branchLable:function(e){var t;return angular.forEach(this.branchList,function(n){if(n.indexNo===e)return void(t=n.branchCode+" - "+n.name)}),t},accountLable:function(e){var t;return angular.forEach(this.accAccountList,function(n){if(n.indexNo===e)return void(t=n.accCode+" - "+n.name)}),t},addData:function(){var t=this;this.tempData.transactionDate=i("date")(this.data.transactionDate,"yyyy-MM-dd"),this.saveDataList.push(this.tempData),this.tempData=e.tempData(),a(function(){t.totalCalculation()},30)},totalCalculation:function(){var e=0;angular.forEach(this.saveDataList,function(t){console.log(t),e+=parseFloat(t.debit)}),this.data.credit=e},save:function(){var e=this,a={};a.dataList=this.saveDataList,this.data.transactionDate=i("date")(this.data.transactionDate,"yyyy-MM-dd"),this.data.chequeDate=i("date")(this.data.chequeDate,"yyyy-MM-dd"),a.data=this.data,console.log(a);var o=n.defer();return t.saveFundTransfer(JSON.stringify(a)).success(function(t){e.saveDataList=[],o.resolve(t)}).error(function(e){o.reject(e)}),o.promise},setClear:function(){this.tempData=e.tempData(),this.data=e.Data(),this.tempData.transactionDate=new Date,this.data.transactionDate=new Date,this.tempData.branch=this.currentBranch.indexNo,this.data.branch=this.currentBranch.indexNo,this.saveDataList=[]}},r};e.$inject=["fundTransferFactory","fundTransferService","$q","$timeout","$filter","Notification"],angular.module("appModule").factory("fundTransferModel",e)}(),function(){var e=function(e,t){this.loadAccAccounts=function(){return e.get(t.apiUrl+"/api/care-point/account/master/acc-account/find-only-cahs-bank")},this.currentBranch=function(){return e.get(t.apiUrl+"/api/care-point/master/branch/current-branch")},this.loadBranch=function(){return e.get(t.apiUrl+"/api/care-point/master/branch")},this.loadAccBalance=function(n){return e.get(t.apiUrl+"/api/care-point/account/master/acc-account/find-account-value/"+n)},this.loadAccTypes=function(){return e.get(t.apiUrl+"/api/care-point/master/account-type")},this.saveFundTransfer=function(n){return e.post(t.apiUrl+"/api/care-point/transaction/fund-transfer/save",n)},this.getPermission=function(n){return e.get(t.apiUrl+"/api/care-point/account/account-setting/user-permission/by-form/"+n)}};e.$inject=["$http","systemConfig"],angular.module("appModule").service("fundTransferService",e)}(),function(){angular.module("appModule").controller("journalController",["$scope","journalModel","$timeout","Notification","ConfirmPane",function(e,t,n,a,i){e.model=new t,e.ui={},e.ui.focus=function(e){n(function(){document.querySelectorAll(e)[0].focus()},10)},e.ui.new=function(){e.ui.mode="NEW",e.ui.focus("#date"),e.model.new()},e.ui.save=function(){var t=!0;e.model.data.transactionDate||(t=!1,a.error("insert date to save !")),e.model.data.description||(t=!1,a.error("insert description to save !")),e.model.dataList.length||(t=!1,a.error("insert data to save !")),e.model.data.totalDebit!==e.model.data.totalCredit&&0!==e.model.data.totalCredit&&(t=!1,a.error("total debit and credit amount is deference!")),e.model.userPermission.add||(t=!1,a.error("you have no permission ")),t&&i.successConfirm("DO YOU WANT TO SAVE !").confirm(function(){e.model.save().then(function(t){a.success(t+" data records save success !"),e.ui.mode="IDEAL"})})},e.ui.addData=function(){var t=!0;e.model.data.transactionDate||(t=!1,a.error("insert date to add !")),e.model.data.description||(t=!1,a.error("insert description to add !")),e.model.tempData.debit||e.model.tempData.credit||(t=!1,a.error("insert debit or credit amount to add !")),e.model.tempData.debit&&e.model.tempData.credit&&(t=!1,a.error("invalied debit and credit amount !")),e.model.tempData.accAccount||(t=!1,a.error("select a account name to add !")),e.model.tempData.branch||(t=!1,a.error("select a branch name to add !")),t&&(e.model.add(),e.ui.focus("#accMain"))},e.ui.focusAddFunction=function(t){13===(t?t.keyCode||t.which:13)&&e.ui.addData()},e.ui.init=function(){e.ui.mode="IDEAL"},e.ui.init()}])}(),function(){angular.module("appModule").factory("journalFactory",function(){var e={};return e.Data=function(){return{indexNo:null,transactionDate:null,currentDate:null,time:null,branch:null,currentBranch:null,user:null,debit:0,credit:0,accAccount:null,formName:null,refNumber:null,type:null,typeIndexNo:null,description:null,bankReconciliation:!1,reconcileAccount:null}},e.tempData=function(){return{accMain:null,accountName:null,branch:null,debit:0,credit:0,cop:!1,description:null,date:null}},e})}(),function(){var e=function(e,t,n,a,i){function o(){this.constructor()}return o.prototype={data:{},tempData:{},currentBranch:{},userPermission:{},dataList:[],accAccountList:[],accflowList:[],branchList:[],constructor:function(){var n=this;n.data=e.Data(),n.tempData=e.tempData(),t.loadAccAccounts().success(function(e){n.accAccountList=e}),t.loadBranch().success(function(e){n.branchList=e}),t.currentBranch().success(function(e){n.currentBranch=e}),t.getPermission("Journal").success(function(e){n.userPermission=e})},setAccountFlow:function(e){var n=this;t.setAccFlow(e).success(function(e){n.accflowList=e,console.log(e)})},new:function(){this.data.transactionDate=new Date,this.tempData.branch=this.currentBranch.indexNo},accountLable:function(e){var t;return angular.forEach(this.accAccountList,function(n){if(n.indexNo===e)return void(t=n.accCode+" - "+n.name)}),t},branchLable:function(e){var t;return angular.forEach(this.branchList,function(n){if(n.indexNo===e)return void(t=n.branchCode+" - "+n.name)}),t},setMainAccount:function(e){this.setAccountFlow(e)},add:function(){var t={};t.indexNo=null,t.transactionDate=a("date")(new Date(this.data.transactionDate),"yyyy-MM-dd"),t.currentDate=null,t.time=null,t.branch=this.tempData.branch,t.currentBranch=null,t.user=null,t.debit=this.tempData.debit,t.credit=this.tempData.credit,t.accAccount=this.tempData.accAccount,t.formName=null,t.refNumber=null,t.type=null,t.typeIndexNo=null,t.description=this.data.description,this.dataList.unshift(t),this.tempData=e.tempData(),this.totalCalculated()},totalCalculated:function(){var e=0,t=0;angular.forEach(this.dataList,function(n){e+=n.debit,t+=n.credit}),this.data.totalDebit=e,this.data.totalCredit=t},save:function(){var e=n.defer(),a=this;return t.saveJournal(JSON.stringify(a.dataList)).success(function(t){a.refresh(),e.resolve(t)}).error(function(t){e.reject(t)}),e.promise},refresh:function(){this.data=e.Data(),this.tempData=e.tempData(),this.dataList=[],this.accflowList=[]}},o};e.$inject=["journalFactory","journalService","$q","$filter","Notification"],angular.module("appModule").factory("journalModel",e)}(),function(){var e=function(e,t){this.loadAccAccounts=function(){return e.get(t.apiUrl+"/api/care-point/account/master/acc-account/find-only-account")},this.loadBranch=function(){return e.get(t.apiUrl+"/api/care-point/master/branch")},this.currentBranch=function(){return e.get(t.apiUrl+"/api/care-point/master/branch/current-branch")},this.setAccFlow=function(n){return e.get(t.apiUrl+"/api/care-point/account/master/acc-account/get-account-flow/"+n)},
this.saveJournal=function(n){return e.post(t.apiUrl+"/api/care-point/transaction/journal/save",n)},this.getPermission=function(n){return e.get(t.apiUrl+"/api/care-point/account/account-setting/user-permission/by-form/"+n)}};e.$inject=["$http","systemConfig"],angular.module("appModule").service("journalService",e)}(),function(){angular.module("appModule").controller("returnChequeController",["$scope","returnChequeModel","$timeout","$filter","Notification","ConfirmPane",function(e,t,n,a,i,o){e.model=new t,e.ui={},e.model.currentBranch={},e.model.type=null,e.ui.focus=function(e){n(function(){document.querySelectorAll(e)[0].focus()},10)},e.ui.new=function(){e.ui.mode="NEW",e.model.data.transactionDate=new Date},e.ui.checkType=function(t){e.model.checkType(t)},e.ui.save=function(){var t=!0;e.model.userPermission.add||(t=!1,i.error("you have no permission to delete Consumable Item !")),t&&o.primaryConfirm("DO YOU WANT TO SAVE CHEQUE RETURN !").confirm(function(){e.model.save().then(function(t){i.success("cheque return save Success !"),e.ui.mode="IDEAL"})})},e.ui.focusAdd=function(t){13===t.which&&e.ui.addData()},e.ui.init=function(){e.ui.mode="IDEAL"},e.ui.init()}])}(),function(){angular.module("appModule").factory("returnChequeFactory",function(){var e={};return e.Data=function(){return{indexNo:null,transactionDate:null,currentDate:null,time:null,branch:null,currentBranch:null,user:null,debit:0,credit:0,accAccount:null,formName:"cheque_return",refNumber:null,type:"cheque_return",typeIndexNo:null,description:null,chequeDate:null,bankReconciliation:!1,reconcileAccount:null,reconcileGroup:0}},e.tempData=function(){return{supplier:null,transactionNo:null,transactionDate:null,formName:null,user:null}},e})}(),function(){var e=function(e,t,n,a,i,o){function r(){this.constructor()}return r.prototype={data:{},tempData:{},currentBranch:{},accAccountList:[],typeAccAccountList:[],branchList:[],supplierList:[],accTypeList:[],userList:[],chequeDetailList:[],accType:null,selectedCheque:{},userPermission:{},constructor:function(){var n=this;n.data=e.Data(),n.tempData=e.tempData(),t.loadBranch().success(function(e){n.branchList=e}),t.loadSupplier().success(function(e){n.supplierList=e}),t.currentBranch().success(function(e){n.currentBranch=e,n.data.branch=e.indexNo}),t.getUsers().success(function(e){n.userList=e}),t.getPermission("Item Registration").success(function(e){console.log(e),n.userPermission=e}),this.loadAccAccount()},loadAccAccount:function(){var e=this;t.loadAccAccounts().success(function(t){e.accAccountList=t})},selectCheque:function(e){var t=this;t.selectedCheque=e,t.tempData.supplier="",angular.forEach(t.supplierList,function(n){if(n.indexNo===e.typeIndexNo)return void(t.tempData.supplier=n.indexNo+" - "+n.name)}),angular.forEach(t.userList,function(n){if(n.indexNo===e.user)return void(t.tempData.user=n.indexNo+" - "+n.username)}),t.tempData.transactionNo=e.number,t.tempData.transactionDate=e.transactionDate,t.tempData.formName=e.formName,this.getChequeDetails(e.deleteRefNo)},getChequeDetails:function(e){var n=this;t.getSelectedChequeDetails(e).success(function(e){n.chequeDetailList=e,console.log(e)})},checkType:function(e){var n=this;n.data.accType=e,n.chequeList=[],t.getCheques(e).success(function(e){n.chequeList=e})},branchLable:function(e){var t;return angular.forEach(this.branchList,function(n){if(n.indexNo===e)return void(t=n.branchCode+" - "+n.name)}),t},supplierLable:function(e){var t;return angular.forEach(this.supplierList,function(n){if(n.indexNo===e)return void(t=n.indexNo+" - "+n.name)}),t},accountLable:function(e){var t;return angular.forEach(this.accAccountList,function(n){if(n.indexNo===e)return void(t=n.accCode+" - "+n.name)}),t},save:function(){var a=this,o={};o.dataList=this.chequeDetailList,this.data.transactionDate=i("date")(this.data.transactionDate,"yyyy-MM-dd"),o.data=this.data,console.log(o);var r=n.defer();return t.save(JSON.stringify(o)).success(function(t){a.chequeDetailList=[],a.chequeList=[],a.data=e.Data(),a.tempData=e.tempData(),r.resolve(t)}).error(function(e){r.reject(e)}),r.promise}},r};e.$inject=["returnChequeFactory","returnChequeService","$q","$timeout","$filter","Notification"],angular.module("appModule").factory("returnChequeModel",e)}(),function(){var e=function(e,t){this.loadAccAccounts=function(){return e.get(t.apiUrl+"/api/care-point/account/master/acc-account/find-only-account")},this.currentBranch=function(){return e.get(t.apiUrl+"/api/care-point/master/branch/current-branch")},this.loadBranch=function(){return e.get(t.apiUrl+"/api/care-point/master/branch")},this.loadAccBalance=function(n){return e.get(t.apiUrl+"/api/care-point/account/master/acc-account/find-account-value/"+n)},this.loadSupplier=function(){return e.get(t.apiUrl+"/api/care-point/master/supplier")},this.getCheques=function(n){return e.get(t.apiUrl+"/api/care-point/transaction/return-cheque/get-cheques/"+n)},this.getUsers=function(){return e.get(t.apiUrl+"/security/user-list")},this.getSelectedChequeDetails=function(n){return e.get(t.apiUrl+"/api/care-point/transaction/return-cheque/get-selected-cheque-details/"+n)},this.getPermission=function(n){return e.get(t.apiUrl+"/api/care-point/account/account-setting/user-permission/by-form/"+n)},this.save=function(n){return e.post(t.apiUrl+"/api/care-point/transaction/return-cheque/save",n)}};e.$inject=["$http","systemConfig"],angular.module("appModule").service("returnChequeService",e)}(),function(){angular.module("appModule").controller("supplierPaymentController",["$scope","supplierPaymentModel","$timeout","$filter","Notification","ConfirmPane",function(e,t,n,a,i,o){e.model=new t,e.ui={},e.model.currentBranch={},e.model.type=null,e.ui.focus=function(e){n(function(){document.querySelectorAll(e)[0].focus()},10)},e.ui.new=function(){e.ui.mode="NEW",e.ui.focus("#supplier"),e.model.typeCash=!0,e.model.typeOverPayment=!1,e.model.data.transactionDate=new Date},e.ui.checkType=function(t){e.ui.focus("#account"),e.model.checkType(t)},e.ui.save=function(){var t=!0;e.model.data.accAccount||(t=!1,i.error("select an account to save !")),e.model.userPermission.add||(t=!1,i.error("you have no permission ")),e.model.data.credit||(t=!1,i.error("total value 0.00 !")),e.model.data.description||(t=!1,i.error("insert description to save !")),e.model.data.transactionDate||(t=!1,i.error("insert transaction date to save !")),e.model.data.credit<e.model.data.billTotal&&(t=!1,i.error("pay amount not enough to settle bills !")),"OVER_PAYMENT"===e.model.data.accType&&e.model.data.overPay>0&&(t=!1,i.error("can't save because there is an overpayment !")),e.model.data.credit>e.model.data.overAmount&&"OVER_PAYMENT"===e.model.data.accType&&(t=!1,i.error("overpayment value not enough to save !")),a("date")(e.model.data.transactionDate,"yyyy-MM-dd")>a("date")(new Date,"yyyy-MM-dd")&&(t=!1,i.error("transfer date not valid ! ")),t&&o.primaryConfirm("DO YOU WANT TO SAVE SUPPLIER PAYMENT !").confirm(function(){e.model.save().then(function(t){i.success("supplier payment save Success !"),e.ui.mode="IDEAL"})})},e.ui.focusAdd=function(t){13===t.which&&e.ui.addData()},e.ui.init=function(){e.ui.mode="IDEAL"},e.ui.init()}])}(),function(){angular.module("appModule").factory("supplierPaymentFactory",function(){var e={};return e.Data=function(){return{indexNo:null,transactionDate:null,currentDate:null,time:null,branch:null,currentBranch:null,user:null,debit:0,credit:0,accAccount:null,formName:"supplier_payment",refNumber:null,type:"supplier_payment",typeIndexNo:null,description:null,chequeDate:null,bankReconciliation:!1,reconcileAccount:null,reconcileGroup:0}},e})}(),function(){var e=function(e,t,n,a,i,o){function r(){this.constructor()}return r.prototype={data:{},currentBranch:{},accAccountList:[],typeAccAccountList:[],branchList:[],supplierList:[],accTypeList:[],accflowList:[],billList:[],accType:null,userPermission:{},constructor:function(){var n=this;n.data=e.Data(),t.loadBranch().success(function(e){n.branchList=e}),t.loadSupplier().success(function(e){n.supplierList=e}),t.currentBranch().success(function(e){n.currentBranch=e,n.data.branch=e.indexNo}),t.getPermission("Item Registration").success(function(e){console.log(e),n.userPermission=e}),this.loadAccAccount()},loadAccAccount:function(){var e=this;t.loadAccAccounts().success(function(t){e.accAccountList=t})},getValue:function(e){var n=this;t.loadAccBalance(e).success(function(e){n.data.value=e,console.log(n.data.value)})},getPayableBills:function(e){var n=this,a=null;angular.forEach(n.supplierList,function(t){if(e===parseInt(t.indexNo))return void(a=t.accAccount)}),null!==a?(this.getOverPaymentAmount(e),t.getPayableBills(a).success(function(e){n.billList=[],angular.forEach(e,function(e){e.pay=0,n.billList.push(e)})})):(n.billList=[],this.setPayTotalAndOverPayment(),o.error("this supplier not linked to account system yet !"))},getOverPaymentAmount:function(e){var n=this;t.getOverPaymentAmount(e).success(function(e){n.data.overAmount=e})},checkOverValueAvailable:function(){if("OVER_PAYMENT"===this.data.accType){this.data.overAmount-this.data.credit<0&&o.error("overpayment value not enough !")}},setBalanceAmountToPay:function(e){e.pay||(e.pay=e.credit-e.debit),this.setPayTotalAndOverPayment()},changePayAmount:function(){this.setPayTotalAndOverPayment()},setPayTotalAndOverPayment:function(){var e=this;e.data.billTotal=0,e.data.overPay=0,angular.forEach(e.billList,function(t){t.credit-t.debit<t.pay&&(o.error("Can't set over amount for this bill !"),t.pay=0),e.data.billTotal+=t.pay}),e.data.overPay=e.data.credit-e.data.billTotal>0?e.data.credit-e.data.billTotal:0,this.checkOverValueAvailable()},clearTypeChange:function(){var e=this;e.data.refNumber="",e.data.chequeDate=null,e.data.accAccount=null},checkType:function(e){var n=this;n.data.accType=e,this.clearTypeChange(),"CASH"===e&&(n.typeAccAccountList=[],angular.forEach(n.accAccountList,function(t){t.accType===e&&n.typeAccAccountList.push(t)})),"BANK"===e&&(n.typeAccAccountList=[],angular.forEach(n.accAccountList,function(t){t.accType===e&&n.typeAccAccountList.push(t)})),"ONLINE"===e&&(n.typeAccAccountList=[],angular.forEach(n.accAccountList,function(e){"BANK"===e.accType&&n.typeAccAccountList.push(e)})),"OVER_PAYMENT"===e&&(n.typeAccAccountList=[],t.getOverPaymentIssueAccount().success(function(e){e&&(n.typeAccAccountList.push(e),n.data.accAccount=e.indexNo)}),this.checkOverValueAvailable())},branchLable:function(e){var t;return angular.forEach(this.branchList,function(n){if(n.indexNo===e)return void(t=n.branchCode+" - "+n.name)}),t},supplierLable:function(e){var t;return angular.forEach(this.supplierList,function(n){if(n.indexNo===e)return void(t=n.indexNo+" - "+n.name)}),t},accountLable:function(e){var t;return angular.forEach(this.accAccountList,function(n){if(n.indexNo===e)return void(t=n.accCode+" - "+n.name)}),t},save:function(){var a=this,o={};o.dataList=this.billList,this.data.transactionDate=i("date")(this.data.transactionDate,"yyyy-MM-dd"),this.data.chequeDate=i("date")(this.data.chequeDate,"yyyy-MM-dd"),o.data=this.data,console.log(o);var r=n.defer();return t.saveSupplierPayment(JSON.stringify(o)).success(function(t){a.billList=[],a.data=e.Data(),r.resolve(t)}).error(function(e){r.reject(e)}),r.promise}},r};e.$inject=["supplierPaymentFactory","supplierPaymentService","$q","$timeout","$filter","Notification"],angular.module("appModule").factory("supplierPaymentModel",e)}(),function(){var e=function(e,t){this.loadAccAccounts=function(){return e.get(t.apiUrl+"/api/care-point/account/master/acc-account/find-only-account")},this.currentBranch=function(){return e.get(t.apiUrl+"/api/care-point/master/branch/current-branch")},this.loadBranch=function(){return e.get(t.apiUrl+"/api/care-point/master/branch")},this.loadAccBalance=function(n){return e.get(t.apiUrl+"/api/care-point/account/master/acc-account/find-account-value/"+n)},this.loadSupplier=function(){return e.get(t.apiUrl+"/api/care-point/master/supplier")},this.getOverPaymentIssueAccount=function(){return e.get(t.apiUrl+"/api/care-point/account/master/acc-account/find-over-payment-issue-account")},this.getPayableBills=function(n){return e.get(t.apiUrl+"/api/care-point/transaction/supplier-payment/get-payable-bills/"+n)},this.getOverPaymentAmount=function(n){return e.get(t.apiUrl+"/api/care-point/transaction/supplier-payment/get-over-payment-amount/"+n)},this.saveSupplierPayment=function(n){return e.post(t.apiUrl+"/api/care-point/transaction/supplier-payment/save",n)},this.getPermission=function(n){return e.get(t.apiUrl+"/api/care-point/account/account-setting/user-permission/by-form/"+n)}};e.$inject=["$http","systemConfig"],angular.module("appModule").service("supplierPaymentService",e)}(),function(){angular.module("appModule").controller("trialBalanceController",["$scope","trialBalanceModel","$timeout","Notification",function(e,t,n,a){e.model=new t,e.ui={},e.ui.focus=function(e){n(function(){document.querySelectorAll(e)[0].focus()},10)},e.ui.new=function(){e.ui.mode="NEW",e.ui.focus("#date"),e.model.date=new Date},e.ui.selectDate=function(){console.log("data"),e.model.selectDate()},e.ui.init=function(){e.ui.mode="IDEAL"},e.ui.init()}])}(),function(){var e=function(e,t){function n(){this.constructor()}return n.prototype={accMainList:[],totalDebit:0,totalCredit:0,level:1,subAccountOf:0,constructor:function(){},selectDate:function(){var n=this;n.loderView=!0;var a=e("date")(n.date,"yyyy-MM-dd");t.loadMainAcc(a).success(function(e){n.accMainList=e,n.totalCalc()})},totalCalc:function(){var e=0,t=0,n=this;angular.forEach(n.accMainList,function(n){1===n.isAccAccount&&(e+=n.debit,t+=n.credit),n.view=!1,n.amountShow=!0,1===n.level&&(n.view=!0)}),n.totalCredit=t,n.totalDebit=e,n.loderView=!1},viewLevel:function(e){var t=this;t.level=parseInt(e.level)+1,e.count>0&&(e.amountShow=!0!==e.amountShow),t.filter1(e)},filter1:function(e){console.log("filter func");var t=this;angular.forEach(t.accMainList,function(n){var a=e.accCode;console.log(n.accCode.substring(0,a.length)),n.accCode.substring(0,a.length)===a&&t.level>=n.level&&n.subAccountOf===e.accNo&&(n.view=!0!==n.view)})}},n};e.$inject=["$filter","trialBalanceService"],angular.module("appModule").factory("trialBalanceModel",e)}(),function(){var e=function(e,t){this.loadMainAcc=function(n){return e.get(t.apiUrl+"/api/care-point/view/trial-balance/get-main-acc-balance/"+n)}};e.$inject=["$http","systemConfig"],angular.module("appModule").service("trialBalanceService",e)}(),function(){angular.module("appModule").controller("voucherController",["$scope","voucherModel","$timeout","$uibModal","Notification","ConfirmPane",function(e,t,n,a,i,o){e.model=new t,e.ui={},e.model.currentBranch={},e.model.type=null,e.ui.focus=function(e){n(function(){document.querySelectorAll(e)[0].focus()},10)},e.ui.new=function(){e.ui.mode="NEW",e.ui.focus("#account"),e.model.tempData.transactionDate=new Date,e.model.data.transactionDate=new Date,e.model.tempData.branch=e.model.data.branch},e.ui.addData=function(){var t=!0;e.model.tempData.accAccount||(t=!1,i.error("Select a Account to add !")),e.model.tempData.branch||(t=!1,i.error("Select a branch to add !")),e.model.data.transactionDate||(t=!1,i.error("insert a Date to add !")),e.model.tempData.debit||(t=!1,i.error("insert amount to add !")),e.model.data.accAccount||(t=!1,i.error("select a main account to add !")),t&&(e.model.addData(),e.ui.new(),e.ui.focus("#subAccount"))},e.ui.save=function(){var t=!0;e.model.data.accAccount||(t=!1,i.error("select a main account to save !")),0===e.model.saveDataList.length&&(t=!1,i.error("Empty voucher item to save !")),e.model.data.credit||(t=!1,i.error("total value 0.00 !")),e.model.userPermission.add||(t=!1,i.error("you have no permission ")),"BANK"===e.model.selectAccType.name&&(e.model.data.refNumber||(t=!1,i.error("Cheque No is Empty !")),e.model.data.chequeDate||(t=!1,i.error("plz enter Cheque Date !")),e.model.data.description||(t=!1,i.error("Description is empty !"))),t&&e.model.save().then(function(t){i.success("Payment voucher save Sucess"),e.ui.mode="IDEAL",e.model.data={},e.model.saveDataList=[]})},e.ui.edit=function(t,n){e.model.tempData=n,e.model.saveDataList.splice(t,1),e.model.totalCalculation()},e.ui.delete=function(t){e.model.saveDataList.splice(t,1),e.model.totalCalculation()},e.ui.selectAccType=function(t){e.model.selectAccType=t,e.model.type=t.value,e.ui.focus("#account"),e.model.setClear(),console.log(e.model.selectAccType)},e.ui.focusAdd=function(t){13===t.which&&e.ui.addData()},e.ui.init=function(){e.ui.mode="IDEAL"},e.ui.init()}])}(),function(){angular.module("appModule").factory("voucherFactory",function(){var e={};return e.Data=function(){return{indexNo:null,transactionDate:null,currentDate:null,time:null,branch:null,currentBranch:null,user:null,debit:0,credit:0,accAccount:null,formName:"payment_voucher",refNumber:null,type:"voucher",typeIndexNo:null,description:"",chequeDate:null,bankReconciliation:!1,reconcileAccount:null,isMain:!1,isCheque:!1}},e.tempData=function(){return{indexNo:null,transactionDate:null,currentDate:null,time:null,branch:null,currentBranch:null,user:null,debit:0,credit:0,accAccount:null,formName:"payment_voucher",refNumber:null,type:"voucher",typeIndexNo:null,description:"",chequeDate:null,bankReconciliation:!1,reconcileAccount:null,isMain:!1,isCheque:!1}},e})}(),function(){var e=function(e,t,n,a,i,o){function r(){this.constructor()}return r.prototype={data:{},tempData:{},currentBranch:{},selectAccType:{},userPermission:{},accAccountList:[],branchList:[],saveDataList:[],accTypeList:[],constructor:function(){var n=this;n.data=e.Data(),n.tempData=e.tempData(),t.loadBranch().success(function(e){n.branchList=e}),t.currentBranch().success(function(e){n.currentBranch=e,n.data.branch=e.indexNo}),t.loadAccTypes().success(function(e){n.accTypeList=e}),t.getPermission("General Voucher").success(function(e){console.log(e),n.userPermission=e}),this.loadAccAccount()},loadAccAccount:function(){var e=this;t.loadAccAccounts().success(function(t){e.accAccountList=t})},getValue:function(e){var n=this;t.loadAccBalance(e).success(function(e){n.data.value=e})},branchLable:function(e){var t;return angular.forEach(this.branchList,function(n){if(n.indexNo===e)return void(t=n.branchCode+" - "+n.name)}),t},accountLable:function(e){var t;return angular.forEach(this.accAccountList,function(n){if(n.indexNo===e)return void(t=n.accCode+" - "+n.name)}),t},addData:function(){var t=this;this.tempData.transactionDate=i("date")(this.data.transactionDate,"yyyy-MM-dd"),this.saveDataList.push(this.tempData),this.tempData=e.tempData(),a(function(){t.totalCalculation()},30)},totalCalculation:function(){var e=0;angular.forEach(this.saveDataList,function(t){console.log(t),e+=parseFloat(t.debit)}),this.data.credit=e},save:function(){var e={};e.voucherList=this.saveDataList,this.data.transactionDate=i("date")(this.data.transactionDate,"yyyy-MM-dd"),this.data.chequeDate=i("date")(this.data.chequeDate,"yyyy-MM-dd"),e.voucher=this.data,"BANK"===this.selectAccType.name&&(e.voucher.bankReconciliation=!0),console.log(e);var a=n.defer();return t.saveVoucher(JSON.stringify(e)).success(function(e){a.resolve(e)}).error(function(e){a.reject(e)}),a.promise},setClear:function(){this.tempData=e.tempData(),this.data=e.Data(),this.tempData.transactionDate=new Date,this.data.transactionDate=new Date,this.tempData.branch=this.currentBranch.indexNo,this.data.branch=this.currentBranch.indexNo,this.saveDataList=[]}},r};e.$inject=["voucherFactory","voucherService","$q","$timeout","$filter","Notification"],angular.module("appModule").factory("voucherModel",e)}(),function(){var e=function(e,t){this.loadAccAccounts=function(){return e.get(t.apiUrl+"/api/care-point/account/master/acc-account/find-only-account")},this.currentBranch=function(){return e.get(t.apiUrl+"/api/care-point/master/branch/current-branch")},this.loadBranch=function(){return e.get(t.apiUrl+"/api/care-point/master/branch")},this.loadAccBalance=function(n){return e.get(t.apiUrl+"/api/care-point/account/master/acc-account/find-account-value/"+n)},this.loadAccTypes=function(){return e.get(t.apiUrl+"/api/care-point/master/account-type")},this.saveVoucher=function(n){return e.post(t.apiUrl+"/api/care-point/transaction/voucher/save",n)},this.delete=function(n){return e.delete(t.apiUrl+"/api/care-point/account/master/acc-account/delete-account/"+n)},this.getPermission=function(n){return e.get(t.apiUrl+"/api/care-point/account/account-setting/user-permission/by-form/"+n)}};e.$inject=["$http","systemConfig"],angular.module("appModule").service("voucherService",e)}(),function(){angular.module("clientModule",["ui.bootstrap","ui-notification"]),angular.module("clientModule").factory("clientFactory",["$http","systemConfig",function(e,t){var n={};return n.lordClientFactory=function(n){var a=t.apiUrl+"/api/care-point/master/client";e.get(a).success(function(e,t,a){n(e)}).error(function(e,t,a){n(e)})},n.getNewClientList=function(n){var a=t.apiUrl+"/api/care-point/master/client/get-new-client-list";e.get(a).success(function(e,t,a){n(e)}).error(function(e,t,a){n(e)})},n.getPermission=function(n,a){var i=t.apiUrl+"/api/care-point/account/account-setting/user-permission/by-form/"+n;e.get(i).success(function(e,t,n){a(e)}).error(function(e,t,n){a(e)})},n.saveClientFactory=function(n,a,i){var o=t.apiUrl+"/api/care-point/master/client/insert-client";e.post(o,n).success(function(e,t,n){a(e)}).error(function(e,t,n){i&&i(e)})},n.deleteClientFactory=function(n,a,i){var o=t.apiUrl+"/api/care-point/master/client/delete-client/"+n;e.delete(o).success(function(e,t,n){a(e)}).error(function(e,t,n){i&&i(e)})},n}]),angular.module("clientModule").controller("clientController",["$scope","$rootScope","$filter","$log","$routeParams","clientFactory","Notification","$timeout",function(e,t,n,a,i,o,r,c){e.model={},e.model.newClientList=[],e.ui={},e.http={},e.ui.mode=null,t.ctrlDown=!1,e.model.reset=function(){e.model.client={indexNo:null,name:null,address1:null,address2:null,address3:null,mobile:null,branch:null,nic:null,resident:null,date:null,isNew:!1}},e.http.saveClient=function(){e.model.client.branch=1,e.model.client.date||(e.model.client.date=n("date")(new Date,"yyyy-MM-dd")),e.model.client.isNew=!1;var t=e.model.client,a=!0;if(t.indexNo?e.model.userPermission.update||(a=!1,r.error("you have no permission !")):e.model.userPermission.add||(a=!1,r.error("you have no permission !")),e.model.client.name||(a=!1,r.error("name is empty !")),e.model.client.resident||(a=!1,r.error("resident is empty !")),a){var i=JSON.stringify(t);o.saveClientFactory(i,function(t){e.model.clientList.splice(e.model.customerPlace(t.indexNo),1),e.model.clientList.push(t),r.success(t.indexNo+" - "+t.name+" Save Successfully"),e.model.reset(),e.ui.focus()},function(e){r.error(e.message)})}},e.http.deleteClient=function(t,n){var a=!0;e.model.userPermission.delete||(a=!1,r.error("you have no permission  !")),a&&o.deleteClientFactory(t,function(){e.model.clientList.splice(n,1),r.success(t+" - Client Delete Successfully")},function(e){r.error(e)})},e.ui.save=function(){e.http.saveClient()},e.ui.editNewClient=function(t,n){var a=!0;e.model.userPermission.update||(a=!1,r.error("you have no permission  !")),a&&(e.ui.mode="EDIT",e.model.client=t,e.model.newClientList.splice(e.model.customerPlace(t.indexNo),1))},e.ui.changeTab=function(){e.ui.mode="IDEAL",e.model.client={}},e.ui.focus=function(){c(function(){document.querySelectorAll("#resident")[0].focus()},10)},e.ui.new=function(){e.ui.mode="NEW",e.ui.focus()},e.ui.edit=function(t,n){e.ui.mode="EDIT",e.model.client=t,e.model.clientList.splice(n,1),e.ui.focus()},e.model.findCustomer=function(t){for(var n=0;n<e.model.clientList.length;n++)if(e.model.clientList[n].indexNo===parseInt(t))return e.model.clientList[n];e.ui.mode="EDIT"},e.model.customerPlace=function(t){for(var n=0;n<e.model.clientList.length;n++)if(e.model.clientList[n].indexNo===parseInt(t))return n},e.ui.keyPressFunction=function(n){t.ctrlDown&&83===n.keyCode?e.ui.save():t.ctrlDown&&78===n.keyCode?e.ui.new():t.ctrlDown&&70===n.keyCode&&e.ui.focus()},e.ui.init=function(){e.ui.mode="IDEAL",e.model.reset(),e.ui.new(),o.lordClientFactory(function(t){e.model.clientList=t}),o.getPermission("Client Registration",function(t){e.model.userPermission=t}),o.getNewClientList(function(t){e.model.newClientList=t})},e.ui.init()}])}(),function(){angular.module("appModule").controller("createAccountController",["$scope","createAccountModel","$timeout","Notification","ConfirmPane",function(e,t,n,a,i){e.model=new t,e.ui={},e.ui.focus=function(){n(function(){document.querySelectorAll("#categoryMain")[0].focus()},10)},e.ui.new=function(){e.ui.mode="NEW",e.ui.focus()},e.ui.edit=function(t,n){e.model.userPermission.update?(e.model.edit(t),e.model.accAccountList.splice(n,1),e.model.data.clearAll=!0,e.ui.mode="EDIT"):a.error("you have no permission to edit account !")},e.ui.refersh=function(){e.model.refresh()},e.ui.delete=function(t){var n=!0;t.isAccAccount||(n=!1,a.error("Can't delete because there are another transaction with relation  !")),e.model.userPermission.delete||(n=!1,a.error("you have no permission to delete account !")),n&&i.warningConfirm("DO YOU WANT TO DELECT !").confirm(function(){e.model.delete(t.indexNo).then(function(e){a.success("Delete success !")})})},e.ui.save=function(){var t=!0;e.model.data.name||(t=!1,a.error("Insert a name to save !")),e.model.data.accType||(t=!1,a.error("Select Account Type to save !")),e.model.data.subAccountOf||(t=!1,a.error("Select subAccountOf to save !")),e.model.data.indexNo?e.model.userPermission.update||(t=!1,a.error("you have no permission to edit account !")):e.model.userPermission.add||(t=!1,a.error("you have no permission to save new account !")),t&&(e.ui.mode="IDEAL",e.model.save().then(function(t){a.success("New Account save Sucess"),e.model.data.clearAll&&e.model.clearData()}))},e.ui.init=function(){e.ui.mode="IDEAL"},e.ui.init()}])}(),function(){angular.module("appModule").factory("createAccountFactory",function(){var e={};return e.Data=function(){return{indexNo:null,name:"",level:null,accCode:null,cop:!1,user:null,accType:"COMMON",isAccAccount:!0,description:null,subAccountOf:null,accMain:null}},e})}(),function(){var e=function(e,t,n,a,i){function o(){this.constructor()}return o.prototype={data:{},accAccountList:[],userPermission:{},accTypeList:["COMMON","CASH","BANK"],constructor:function(){this.data=e.Data(),this.loadAccAccount(),this.loadPermission()},loadAccAccount:function(){var e=this;t.loadAccAccounts().success(function(t){e.accAccountList=t})},loadPermission:function(){var e=this;t.getPermission("Create Account").success(function(t){console.log(t),e.userPermission=t})},refresh:function(){this.loadAccAccount(),this.data=e.Data()},clearData:function(){this.data=e.Data()},edit:function(e){this.clearData(),this.data=e},delete:function(e){var a=this,o=n.defer();return t.delete(e).success(function(e){a.clearData(),a.loadAccAccount(),o.resolve(e)}).error(function(e){i.error(e),o.reject(e)}),o.promise},accAccountLabel:function(e){var t;return angular.forEach(this.accAccountList,function(n){if(n.indexNo===e)return void(t=n.accCode+" - "+n.name)}),t},save:function(){var e=this;console.log(this.data);var a=n.defer();return t.saveNewAccount(JSON.stringify(e.data)).success(function(t){e.loadAccAccount(),a.resolve()}).error(function(){a.reject()}),a.promise}},o};e.$inject=["createAccountFactory","createAccountService","$q","$filter","Notification"],angular.module("appModule").factory("createAccountModel",e)}(),function(){var e=function(e,t){this.loadAccAccounts=function(){return e.get(t.apiUrl+"/api/care-point/account/master/acc-account")},this.getPermission=function(n){return e.get(t.apiUrl+"/api/care-point/account/account-setting/user-permission/by-form/"+n)},this.saveNewAccount=function(n){return e.post(t.apiUrl+"/api/care-point/account/master/acc-account/save-new-account",n)},this.delete=function(n){return e.delete(t.apiUrl+"/api/care-point/account/master/acc-account/delete-account/"+n)}};e.$inject=["$http","systemConfig"],angular.module("appModule").service("createAccountService",e)}(),function(){angular.module("appModule").controller("employeeController",["$scope","employeeModel","systemConfig","$timeout","Notification",function(e,t,n,a,i){e.model=new t,e.ui={},e.imagemodel=[],e.imagemodelX=[],e.ui.imageShowMode1="NotAvalable",e.ui.changeFunction=function(t){"NotAvalable"===e.ui.imageShowMode1&&(e.ui.imageShowMode1="Avalable");for(var n=t.target.files,a=0;a<n.length;a++){var i=n[a];e.imagemodel.push(i);var o=new FileReader;o.onload=e.imageIsLoaded,o.readAsDataURL(i)}},e.imageIsLoaded=function(t){e.$apply(function(){e.imagemodelX.push(t.target.result)})},e.ui.showImg=function(){e.imageModel&&e.ui.showImg},e.ui.saveImage=function(t,a){for(var i=0;i<e.imagemodel.length;i++){var o=n.apiUrl+"/api/care-point/master/employee/upload-image/"+a+"/"+t,r=new FormData;r.append("file",e.imagemodel[i]);var c=new XMLHttpRequest;c.open("POST",o),c.send(r)}},e.ui.clearImage=function(){e.imagemodel=[],e.imagemodelX=[],e.imagemodels={},e.ui.imageShowMode1="NotAvalable"},e.ui.downloardImage=function(t){e.imagemodelX[0]=n.apiUrl+"/api/care-point/master/employee/download-image/"+t.image,e.ui.imageShowMode1="Avalable"},e.ui.save=function(){e.model.saveEmployee().then(function(t){e.ui.saveImage(t.indexNo,t.name),e.model.employeeData={},e.imagemodel=[],e.imagemodelX=[],e.ui.imageShowMode1="NotAvalable",i.success("Save Success...!!")},function(){})},e.ui.deleteEmployee=function(t,n){e.model.deleteEmployee(t,n).then(function(e){i.success("Delete Success...!!")},function(e){i.error(e)})},e.ui.edit=function(t,n){e.model.employeeData=t,e.ui.downloardImage(t),e.model.editEmployee(n)},e.ui.focus=function(){a(function(){document.querySelectorAll("#name")[0].focus()},10)},e.ui.new=function(){e.ui.mode="NEW",e.ui.focus()},e.ui.init=function(){e.ui.mode="IDEAL"},e.ui.init()}])}(),function(){angular.module("appModule").factory("employeeFactory",function(){var e={};return e.newEmployeeData=function(){return{indexNo:null,name:null,addressLine1:null,addressLine2:null,addressLine3:null,mobile:null,branch:null,type:null,rol:null,image:null,bay:null}},e})}(),function(){var e=function(e,t,n,a){function i(){this.constructor()}return i.prototype={employeeData:{},employeeList:[],constructor:function(){var n=this;n.employeeData=e.newEmployeeData(),t.loadEmolyee().success(function(e){n.employeeList=e,console.log(e)})},saveEmployee:function(){var e=this,a=n.defer();return t.saveEmployee(JSON.stringify(e.employeeData)).success(function(t){e.employeeList.push(t),a.resolve(t)}).error(function(){a.reject()}),a.promise},editEmployee:function(e){this.employeeList.splice(e,1)},deleteEmployee:function(e,a){var i=this,o=n.defer();return t.deleteEmployee(e).success(function(e){i.employeeList.splice(a,1),o.resolve(e)}).error(function(e){o.reject(e)}),o.promise}},i};e.$inject=["employeeFactory","employeeService","$q","$filter"],angular.module("appModule").factory("employeeModel",e)}(),function(){var e=function(e,t){this.loadEmolyee=function(){return e.get(t.apiUrl+"/api/care-point/master/employee")},this.saveEmployee=function(n){return e.post(t.apiUrl+"/api/care-point/master/employee/save-employee",n)},this.deleteEmployee=function(n){return e.delete(t.apiUrl+"/api/care-point/master/employee/delete-employee/"+n)}};e.$inject=["$http","systemConfig"],angular.module("appModule").service("employeeService",e)}(),function(){angular.module("itemModule",["ui.bootstrap","ui-notification"]),angular.module("itemModule").controller("itemController",["$scope","itemModel","$timeout","Notification","ConfirmPane",function(e,t,n,a,i){e.model=new t,e.ui={},e.ui.toggleType=function(t){
"ITEMS"===t?e.ui.saveMode="ITEMS":"ITEMS_UNITS"===t?e.ui.saveMode="ITEMS_UNITS":"PACKAGE_ITEMS"===t?e.ui.saveMode="PACKAGE_ITEMS":"CONSUMABLE_ITEMS"===t?e.ui.saveMode="CONSUMABLE_ITEMS":"ITEM_CHECK_DETAIL"===t?e.ui.saveMode="ITEM_CHECK_DETAIL":"PRICE_CATEGORY_DETAIL"===t&&(e.ui.saveMode="PRICE_CATEGORY_DETAIL"),e.focus("#name")},e.ui.new=function(){e.ui.mode="EDIT",e.focus("#name")},e.focus=function(e){n(function(){document.querySelectorAll(e)[0].focus()},10)},e.ui.clear=function(){a.success("all details clear"),e.model.clear()},e.ui.selectStock=function(t){"STOCK"===t&&(e.textViewMode="STOCK"),"NON STOCK"===t&&(e.textViewMode="NON STOCK"),"SERVICE"===t&&(e.textViewMode="SERVICE"),"PACKAGE"===t&&(e.textViewMode="PACKAGE")},e.ui.findItemByItemType=function(t){e.model.findItemByItemType(t)},e.ui.saveItems=function(){var t=!0;e.model.itemData.type||(t=!1,a.error("enter item type")),e.model.itemData.name||(t=!1,a.error("enter item name")),e.model.userPermission.add||(ch=!1,a.error("you have no permission to save new item !")),t&&i.primaryConfirm("do you want to save Item !").confirm(function(){e.model.saveItem().then(function(){a.success("Item save Success")},function(){a.error("Item save Fail")})}).discard(function(){console.log("discard")})},e.ui.saveConsumable=function(){var t=!0;e.model.userPermission.add||(t=!1,a.error("you have no permission to save new Consumable Item !")),t&&i.primaryConfirm("Save this Consumable Item !").confirm(function(){e.model.saveConsumable().then(function(){a.success("Consumable Item Save Success")},function(){a.error("Consumable Item Save Fail")})}).discard(function(){console.log("discard")})},e.ui.editeItems=function(t,n){e.model.userPermission.update||(ch=!1,a.error("you have no permission to edit Item !")),e.textViewMode=t.type,e.model.editeItem(t,n)},e.ui.deleteItems=function(t,n){e.model.userPermission.delete||(ch=!1,a.error("you have no permission to delete Item !")),e.model.deleteItem(t,n)},e.ui.saveItemUnits=function(){if(e.model.itemUnitData.item)if(e.model.itemUnitData.name)if(e.model.itemUnitData.qty)if(e.model.itemUnitData.salePriceNormal)if(e.model.itemUnitData.salePriceRegister){if(e.model.itemUnitData.item&&e.model.itemUnitData.name&&e.model.itemUnitData.qty&&e.model.itemUnitData.salePriceNormal&&e.model.itemUnitData.salePriceRegister){e.model.userPermission.add||(ch=!1,a.error("you have no permission to save new Item unit !")),e.model.saveItemUnit(),e.itemType=null,e.itemUnit=null}}else a.error("enter item cost sale price register");else a.error("enter item unit sale price normal");else a.error("enter item unit qty");else a.error("enter item unit name");else a.error("select item")},e.ui.showDetails=function(){var t=!0;return e.itemType||(t=!1),e.itemUnit||(t=!1),e.model.itemUnitData.item||(t=!1),t},e.ui.editeItemUnits=function(t,n){e.model.userPermission.update||(ch=!1,a.error("you have no permission to edit Item unit !")),e.model.editeItemUnits(t,n)},e.ui.getItemType=function(t){e.itemType=e.model.item(t).type,e.itemUnit=e.model.item(t).unit,e.itemObject=e.model.item(t),e.model.loadItemUnitByItem(t)},e.ui.deleteItemUnits=function(t,n){e.model.userPermission.delete||(ch=!1,a.error("you have no permission to delete item unit !")),e.model.deleteItemUnits(t,n)},e.ui.addPackageItem=function(){e.model.userPermission.add||(ch=!1,a.error("you have no permission to save new package Item !")),e.model.packageData.packages?e.model.packageData.item?e.model.packageData.packages&&e.model.packageData.item&&e.model.addPackageItem():a.error("select item"):a.error("select package item")},e.ui.getPackageItems=function(t){e.model.getPackageItems(t)},e.ui.deleteConsumableItem=function(t){var n=!0;e.model.userPermission.delete||(n=!1,a.error("you have no permission to delete Consumable Item !")),n&&i.dangerConfirm("Delete Selected Consumable Item !").confirm(function(){e.model.deleteConsumableItem(t).then(function(){a.success("Consumable Item Delete Success")},function(){a.error("Consumable Item Delete Fail")})}).discard(function(){console.log("discard fail")})},e.ui.selectPackageItem=function(t){e.model.selectPackageItem(t)},e.ui.init=function(){e.ui.mode="IDEAL",e.ui.type="NORMAL"},e.ui.init()}])}(),function(){angular.module("appModule").factory("itemFactory",function(){var e={};return e.newItemData=function(){return{indexNo:null,name:null,barcode:null,printDescription:null,unit:0,costPrice:0,type:null,department:null,brand:null,category:null,itemCategory:null,sub_category:null,salePriceNormal:0,salePriceRegister:0,priceCategory:null,branch:null,reOrderMax:null,reOrderMin:null,discount:null,supplierPrice:null,qtyWise:null}},e.newItemData=function(){return{indexNo:null,name:null,barcode:null,printDescription:null,unit:0,costPrice:0,type:null,department:null,brand:null,category:null,itemCategory:null,sub_category:null,salePriceNormal:0,salePriceRegister:0,priceCategory:null,branch:null,reOrderMax:null,reOrderMin:null,discount:null,supplierPrice:null}},e.newItemUnitData=function(){return{indexNo:null,item:null,name:null,qty:null,priceCategory:null,salePriceNormal:0,salePriceRegister:0,costPrice:0}},e.newPackageData=function(){return{indexNo:null,packages:null,item:null}},e.newConsumableData=function(){return{indexNo:null,service:null,consumable:null,qty:null}},e.newItemCheckData=function(){return{indexNo:null,item:null,name:null}},e.newPriceCategoryDetails=function(){return{indexNo:null,item:null,priceCategory:null,normalPrice:null,registerPrice:null,time:null}},e})}(),function(){var e=function(e,t,n,a,i){function o(){this.constructor()}return o.prototype={itemData:{},tempItemData:{},itemUnitData:{},packageData:{},consumableData:{},itemCheckData:{},priceCategoryDetail:{},items:[],itemsTypeWiseItems:[],itemunits:[],itemDepartments:[],categorys:[],itemCategorys:[],subCategorys:[],brands:[],suppliers:[],consumableItemList:[],itemViewList:[],itemunitsViewList:[],packageViewList:[],itemCheckDetailList:[],priceCategoryDetailsList:[],timeList:[],selectedConsumableItem:{},selectedItem:{},selectedItemFromPriceCategory:{},userPermission:{},consumableItemIsView:!1,selectedItemIsView:!1,constructor:function(){var n=this;n.itemData=e.newItemData(),n.tempItemData=e.newItemData(),n.itemUnitData=e.newItemUnitData(),n.packageUnitData=e.newPackageData(),n.consumableData=e.newConsumableData(),n.itemCheckData=e.newItemCheckData(),n.priceCategoryDetail=e.newPriceCategoryDetails(),t.loadSupplier().success(function(e){n.suppliers=e}),t.getPermission("Item Registration").success(function(e){console.log(e),n.userPermission=e}),this.timeList=["00:00:30","00:01:00","00:10:00","00:15:00","00:20:00","00:25:00","00:30:00","00:35:00","00:40:00","00:45:00","00:50:00","00:55:00","01:00:00","01:10:00","01:20:00","01:30:00","01:40:00","01:50:00","02:00:00"],this.loadConsumableItem(),this.loadCategories(),this.loadSubCategory(),this.loadItem(),this.loadBrand(),this.loadItemDepartment(),this.loadItemCategory(),this.loadItemCheckDetailList()},clear:function(){this.constructor()},findItemByItemType:function(e){var a=this,i=n.defer();return t.findItemByItemType(e).success(function(e){a.itemsTypeWiseItems=[],a.itemsTypeWiseItems=e,i.resolve()}).error(function(){a.itemsTypeWiseItems=[],i.reject()}),i.promise},loadCategories:function(){var e=this;t.loadCategory().success(function(t){e.categorys=t})},loadItemCategory:function(){var e=this;t.loadItemCategory().success(function(t){e.itemCategorys=t})},loadSubCategory:function(){var e=this;t.loadSubCategory().success(function(t){e.subCategorys=t})},loadItemDepartment:function(){var e=this;t.loadItemDepartment().success(function(t){e.itemDepartments=t})},loadBrand:function(){var e=this;t.loadBrand().success(function(t){e.brands=t})},loadItem:function(){var e=this;t.loadItem().success(function(t){e.items=t,e.itemViewList=t})},loadConsumableItem:function(){var e=this;t.loadConsumableItem().success(function(t){e.consumableItemList=t})},loadItemCheckDetailList:function(){var e=this;t.loadItemCheckDetails().success(function(t){e.itemCheckDetailList=t})},saveItem:function(){var e=n.defer(),a=this,i={item:null,department:null,brand:null,category:null,itemCategory:null,subCategory:null};return i.item=this.itemData,i.department=this.itemDepartment(this.itemData.department),i.category=this.category(this.itemData.category),i.subCategory=this.subCategory(this.itemData.sub_category),i.brand=this.brand(this.itemData.brand),i.itemCategory=this.itemCategory(this.itemData.itemCategory),this.itemData.department=null===this.itemDepartment(this.itemData.department)?this.itemData.department:null,this.itemData.category=null===this.category(this.itemData.category)?this.itemData.category:null,this.itemData.sub_category=null===this.subCategory(this.itemData.sub_category)?this.itemData.sub_category:null,this.itemData.brand=null===this.brand(this.itemData.brand)?this.itemData.brand:null,this.itemData.itemCategory=null===this.itemCategory(this.itemData.itemCategory)?this.itemData.itemCategory:null,console.log(i),t.saveItem(JSON.stringify(i)).success(function(t){a.itemViewList.unshift(t),a.itemData={},a.refreshCategories(),e.resolve()}).error(function(t){e.reject(t)}),e.promise},refreshCategories:function(){this.loadBrand(),this.loadCategories(),this.loadSubCategory(),this.loadItemDepartment(),this.loadItemCategory()},editeItem:function(e,t){this.itemData=e,this.itemsTypeWiseItems.splice(t,1)},deleteItem:function(e,a){var i=n.defer(),o=this;return t.deleteItem(e.indexNo).success(function(e){o.itemsTypeWiseItems.splice(a,1),i.resolve()}).error(function(e){i.reject()}),i.promise},loadItemUnitByItem:function(e){var a=this,i=n;return console.log("service "+e),t.loadItemUnitByItem(e).success(function(e){a.itemunitsViewList=[],a.itemunitsViewList=e,console.log(e),i.resolve()}).error(function(){a.itemunitsViewList=[],i.reject()}),i.promise},saveItemUnit:function(){var e=n.defer(),a=this;return this.itemUnitData.itemUnitType="NORMAL",t.saveItemUnit(JSON.stringify(this.itemUnitData)).success(function(t){a.itemunitsViewList.unshift(t),a.itemUnitData={},e.resolve()}).error(function(t){e.reject()}),e.promise},editeItemUnits:function(e,t){this.itemUnitData=e,this.itemunitsViewList.splice(t,1)},deleteItemUnits:function(e,a){var i=n.defer(),o=this;return t.deleteItemUnit(e.indexNo).success(function(e){o.itemunitsViewList.splice(a,1),i.resolve()}).error(function(e){i.reject()}),i.promise},addPackageItem:function(){var e=n.defer(),a=this;return t.savePackageItem(this.packageData).success(function(t){a.packageViewList.unshift(t),a.packageData.item=null,a.packageData.time=null,a.totalTimeCalac(),e.resolve()}).error(function(t){e.reject()}),e.promise},getPackageItems:function(e){var a=n.defer(),i=this;return t.getPackageItems(e).success(function(e){i.packageViewList=[],i.packageViewList=e,i.totalTimeCalac(),a.resolve()}).error(function(){i.packageViewList=[],a.reject()}),a.promise},totalTimeCalac:function(){var e=this;e.packageData.count=e.packageViewList.length},deletePackageItems:function(e,a){var i=n.defer(),o=this;return t.deletePackageItem(e.indexNo).success(function(e){o.packageViewList.splice(a,1),o.totalTimeCalac(),i.resolve()}).error(function(e){i.reject()}),i.promise},saveConsumable:function(){var e=!0;if(this.consumableData.service||(e=!1,i.error("Select a Service Item For Save !")),this.consumableData.consumable||(e=!1,i.error("Select a Consumable Item For Save !")),this.consumableData.qty<=0&&(e=!1,i.error("Quantity less then 0 !")),e){var a=n.defer(),o=this;return t.saveConsumableItem(JSON.stringify(this.consumableData)).success(function(e){o.consumableData.consumable=null,o.consumableData.qty=0,o.loadConsumableItem(),this.consumableItemIsView=!1,a.resolve()}).error(function(e){a.reject()}),a.promise}},saveItemChechDetail:function(){var e=!0;if(this.itemCheckData.item||(e=!1,i.error("Select a Item For Save !")),this.itemCheckData.name||(e=!1,i.error("Select a Check Description !")),e){var a=n.defer(),o=this;return t.saveItemCheckDetail(JSON.stringify(this.itemCheckData)).success(function(e){o.itemCheckData.name=null,o.loadItemCheckDetailList(),a.resolve()}).error(function(e){a.reject()}),a.promise}},selectCunsumableItel:function(e){var t=this.itemObject(e);this.selectedConsumableItem=t,this.consumableItemIsView=!0},deleteConsumableItem:function(e){var a=n.defer(),i=this;return t.deleteConsumableItem(e).success(function(e){i.consumableData.consumable=null,i.consumableData.qty=0,i.loadConsumableItem(),a.resolve()}).error(function(e){a.reject()}),a.promise},deleteItemCheckDetail:function(e){var a=n.defer(),i=this;return t.deleteItemCheckDetail(e).success(function(e){i.itemCheckData.name=null,i.itemCheckData.item=null,i.loadItemCheckDetailList(),a.resolve()}).error(function(e){a.reject()}),a.promise},brandLable:function(e){var t;return angular.forEach(this.brands,function(n){if(n.indexNo===parseInt(e))return void(t=n.indexNo+"-"+n.name)}),t},supplierLable:function(e){var t;return angular.forEach(this.suppliers,function(n){if(n.indexNo===parseInt(e))return void(t=n.name+" - "+n.contactNo)}),t},itemLable:function(e){var t;return angular.forEach(this.items,function(n){if(n.indexNo===parseInt(e))return void(t=n.indexNo+" - "+n.name)}),t},itemObject:function(e){var t;return angular.forEach(this.items,function(n){if(n.indexNo===parseInt(e))return void(t=n)}),t},categoryLable:function(e){var t;return angular.forEach(this.categorys,function(n){if(n.indexNo===parseInt(e))return void(t=n.indexNo+"-"+n.name)}),t},itemCategoryLable:function(e){var t;return angular.forEach(this.itemCategorys,function(n){if(n.indexNo===parseInt(e))return void(t=n.indexNo+"-"+n.name)}),t},subCategoryLable:function(e){var t;return angular.forEach(this.subCategorys,function(n){if(n.indexNo===parseInt(e))return void(t=n.indexNo+"-"+n.name)}),t},itemDepartmentLable:function(e){var t=null;return angular.forEach(this.itemDepartments,function(n){if(n.indexNo===e)return void(t=n.indexNo+"-"+n.name)}),t},timeLable:function(e){var t=null;return angular.forEach(this.timeList,function(n){if(n===e)return void(t=n)}),t},item:function(e){var t;return angular.forEach(this.items,function(n){if(n.indexNo===parseInt(e))return void(t=n)}),t},itemDepartment:function(e){var t=e;return angular.forEach(this.itemDepartments,function(n){if(n.indexNo===e)return void(t=null)}),t},category:function(e){var t=e;return angular.forEach(this.categorys,function(n){if(n.indexNo===e)return void(t=null)}),t},subCategory:function(e){var t=e;return angular.forEach(this.subCategorys,function(n){if(n.indexNo===e)return void(t=null)}),t},brand:function(e){var t=e;return angular.forEach(this.brands,function(n){if(n.indexNo===e)return void(t=null)}),t},itemCategory:function(e){var t=e;return angular.forEach(this.itemCategorys,function(n){if(n.indexNo===e)return void(t=null)}),t},selectedItemForCheckItem:function(e){var t;angular.forEach(this.items,function(n){if(n.indexNo===parseInt(e))return void(t=n)}),this.selectedItem=t,this.selectedItemIsView=!0},loadPriceCategoryDetailByItem:function(e){var a=this,o=n.defer();if(a.tempItemData=a.item(e),"PACKAGE"===a.tempItemData.type||"SERVICE"===a.tempItemData.type)return angular.forEach(a.items,function(t){if(t.indexNo===e)return void(a.selectedItemFromPriceCategory=t)}),t.loadPriceCategoryDetailByItem(e).success(function(e){a.priceCategoryDetailsList=[],a.priceCategoryDetailsList=e,o.resolve()}).error(function(){a.priceCategoryDetailsList=[],o.reject()}),o.promise;a.selectedItemFromPriceCategory=null,a.priceCategoryDetail.item="",i.error("select Package Item or Activity to save price category !")},getTotalTimeByPriceCategory:function(e,a){var i=n.defer(),o="00:00:00";t.getTotalTimeByPriceCategory(e,a).success(function(e){o=e,console.log(o),i.resolve()}).error(function(){i.reject()})},savePriceCategoryDetail:function(){var e=this,a=n.defer();return t.saveMPriceCategoryDetails(this.priceCategoryDetail).success(function(t){e.priceCategoryDetailsList.unshift(t),e.priceCategoryDetail={},e.tempItemData={},a.resolve()}).error(function(){a.reject()}),a.promise},duplicateCheckPriceCategoryDetails:function(e,t){var n;return angular.forEach(this.priceCategoryDetailsList,function(a){if(a.item===parseInt(e)&&a.priceCategory===parseInt(t))return void(n=a)}),n},deletePriceCategoryDetail:function(e,a){var i=this,o=n.defer();return t.deleteMPriceCategoryDetails(a).success(function(t){i.priceCategoryDetailsList.splice(e,1),o.resolve()}).error(function(){o.reject()}),o.promise},editePriceCategoryDetail:function(e,t){this.priceCategoryDetail=e,this.priceCategoryDetailsList.splice(t,1)},selectPackageItem:function(e){this.packageData.time=this.item(e).time}},o};e.$inject=["itemFactory","itemService","$q","$filter","Notification"],angular.module("appModule").factory("itemModel",e)}(),function(){var e=function(e,t){this.loadCategory=function(){return e.get(t.apiUrl+"/api/care-point/master/category")},this.loadItemCategory=function(){return e.get(t.apiUrl+"/api/care-point/master/item-category")},this.loadSubCategory=function(){return e.get(t.apiUrl+"/api/care-point/master/sub-category")},this.loadBrand=function(){return e.get(t.apiUrl+"/api/care-point/master/brand")},this.loadItemDepartment=function(){return e.get(t.apiUrl+"/api/care-point/master/item-departments")},this.loadItem=function(){return e.get(t.apiUrl+"/api/care-point/master/item")},this.findItemByItemType=function(n){return e.get(t.apiUrl+"/api/care-point/master/item/find-by-item-type/"+n)},this.loadSupplier=function(){return e.get(t.apiUrl+"/api/care-point/master/supplier")},this.loadItemUnit=function(){return e.get(t.apiUrl+"/api/care-point/master/item-unit")},this.loadPackageItem=function(){return e.get(t.apiUrl+"/api/care-point/transaction/service_selections")},this.loadItemUnitByItem=function(n){return e.get(t.apiUrl+"/api/care-point/master/item-unit/find-by-item/"+n)},this.loadConsumableItem=function(){return e.get(t.apiUrl+"/api/care-point/master/consumable-item")},this.loadItemCheckDetails=function(){return e.get(t.apiUrl+"/api/care-point/master/item-check-detail")},this.getPermission=function(n){return e.get(t.apiUrl+"/api/care-point/account/account-setting/user-permission/by-form/"+n)},this.getPackageItems=function(n){return e.get(t.apiUrl+"/api/care-point/master/package-item/get-package-items/"+n)},this.loadPriceCategoryDetailByItem=function(n){return e.get(t.apiUrl+"/api/care-point/master/price-categiry-details/find-by-item/"+n)},this.getTotalTimeByPriceCategory=function(n,a){return e.get(t.apiUrl+"/api/care-point/master/price-categiry-details/get_total_time_by_price_category/"+n+"/"+a)},this.saveItem=function(n){return e.post(t.apiUrl+"/api/care-point/master/item/save-item",n)},this.saveItemUnit=function(n){return e.post(t.apiUrl+"/api/care-point/master/item-unit/save-unit",n)},this.savePackageItem=function(n){return e.post(t.apiUrl+"/api/care-point/master/package-item/save-package",n)},this.saveConsumableItem=function(n){return e.post(t.apiUrl+"/api/care-point/master/consumable-item/save-consumable",n)},this.saveItemCheckDetail=function(n){return e.post(t.apiUrl+"/api/care-point/master/item-check-detail/save-item-check-detail",n)},this.saveMPriceCategoryDetails=function(n){return e.post(t.apiUrl+"/api/care-point/master/price-categiry-details/insert-detail",n)},this.deleteItem=function(n){return e.delete(t.apiUrl+"/api/care-point/master/item/delete-item/"+n)},this.deleteItemUnit=function(n){return e.delete(t.apiUrl+"/api/care-point/master/item-unit/save-unit/"+n)},this.deletePackageItem=function(n){return e.delete(t.apiUrl+"/api/care-point/master/package-item/delete-package/"+n)},this.deleteConsumableItem=function(n){return e.delete(t.apiUrl+"/api/care-point/master/consumable-item/delete-consumable/"+n)},this.deleteItemCheckDetail=function(n){return e.delete(t.apiUrl+"/api/care-point/master/item-check-detail/delete-item-check-detail/"+n)},this.deleteMPriceCategoryDetails=function(n){return e.delete(t.apiUrl+"/api/care-point/master/price-categiry-details/delete-detail/"+n)}};e.$inject=["$http","systemConfig"],angular.module("appModule").service("itemService",e)}(),function(){"use strict";function e(e){function t(t){t<1||t>n.pager.totalPages||(n.pager=e.GetPager(n.dummyItems.length,t),n.items=n.dummyItems.slice(n.pager.startIndex,n.pager.endIndex+1))}var n=this;n.dummyItems=_.range(1,151),n.pager={},n.setPage=t,function(){n.setPage(1)}()}function t(){function e(e,t,n){t=t||1,n=n||10;var a,i,o=Math.ceil(e/n);o<=10?(a=1,i=o):t<=6?(a=1,i=10):t+4>=o?(a=o-9,i=o):(a=t-5,i=t+4);var r=(t-1)*n;return{totalItems:e,currentPage:t,pageSize:n,totalPages:o,startPage:a,endPage:i,startIndex:r,endIndex:Math.min(r+n-1,e-1),pages:_.range(a,i+1)}}var t={};return t.GetPager=e,t}e.$inject=["PagerService"],angular.module("app",[]).factory("PagerService",t).controller("ExampleController",e)}(),function(){angular.module("supplierModule",["ui.bootstrap","ui-notification"]),angular.module("supplierModule").factory("supplierFactory",["$http","systemConfig",function(e,t){var n={};return n.lordSupplierFactory=function(n){var a=t.apiUrl+"/api/care-point/master/supplier";e.get(a).success(function(e,t,a){n(e)}).error(function(e,t,a){n(e)})},n.getPermission=function(n,a){var i=t.apiUrl+"/api/care-point/account/account-setting/user-permission/by-form/"+n;e.get(i).success(function(e,t,n){a(e)}).error(function(e,t,n){a(e)})},n.saveSupplierFactory=function(n,a,i){var o=t.apiUrl+"/api/care-point/master/supplier/save";e.post(o,n).success(function(e,t,n){a(e)}).error(function(e,t,n){i&&i(e)})},n.deleteSupplierFactory=function(n,a,i){var o=t.apiUrl+"/api/care-point/master/supplier/delete/"+n;e.delete(o).success(function(e,t,n){a(e)}).error(function(e,t,n){i&&i(e)})},n}]),angular.module("supplierModule").controller("supplierController",["$scope","$filter","$log","$routeParams","supplierFactory","Notification","$timeout",function(e,t,n,a,i,o,r){e.model={},e.ui={},e.http={},e.ui.mode=null,e.model.reset=function(){e.model.supplier={indexNo:null,name:null,contactName:null,contactNo:null,address1:null,address2:null,address3:null,branch:null,type:null,creditPeriod:null,accAccount:null}},e.validateInput=function(){return!!(e.model.supplier.name|e.model.supplier.contactNo|null!==e.model.supplier.type)},e.http.saveSupplier=function(){e.model.supplier.branch=1;var t=e.model.supplier,n=JSON.stringify(t);i.saveSupplierFactory(n,function(t){e.model.supplierList.splice(e.model.supplierPlace(t.indexNo),1),e.model.supplierList.push(t),o.success(t.indexNo+" - "+t.name+" Save Successfully"),e.model.reset()},function(e){o.error(e.message)})},e.http.deleteSupplier=function(t,n){e.model.userPermission.delete||(ch=!1,o.error("you have no permission  !")),i.deleteSupplierFactory(t,function(){e.model.supplierList.splice(n,1),o.success(t+" - Supplier Delete Successfully")},function(e){o.error(e)})},e.ui.save=function(){e.model.userPermission.add||(ch=!1,o.error("you have no permission !")),e.validateInput()?e.http.saveSupplier():o.error("Please input detail")},e.ui.editNewSupplier=function(t,n){e.ui.mode="EDIT",e.model.supplier=t},e.ui.supplierTypeLable=function(t){var n="";return angular.forEach(e.model.supplierTypeList,function(e){if(e.indexNo===t)return void(n=e.indexNo+" - "+e.name)}),n},e.ui.changeTab=function(){e.ui.mode="IDEAL",e.model.supplier={}},e.ui.focus=function(){r(function(){document.querySelectorAll("#name")[0].focus()},10)},e.ui.new=function(){e.ui.mode="NEW",e.ui.focus()},e.ui.edit=function(t,n){var a=!0;e.model.userPermission.update||(a=!1,o.error("you have no permission  !")),a&&(e.ui.mode="EDIT",e.model.supplier=t,e.model.supplierList.splice(e.model.supplierPlace(t.indexNo),1),e.ui.focus())},e.model.findSupplier=function(t){for(var n=0;n<e.model.supplierList.length;n++)if(e.model.supplierList[n].indexNo===parseInt(t))return e.model.supplierList[n];e.ui.mode="EDIT"},e.model.supplierPlace=function(t){for(var n=0;n<e.model.supplierList.length;n++)if(e.model.supplierList[n].indexNo===parseInt(t))return n},e.ui.init=function(){e.ui.mode="IDEAL",e.model.reset(),i.lordSupplierFactory(function(t){e.model.supplierList=t}),i.getPermission("Supplier Registration",function(t){e.model.userPermission=t,console.log(t)})},e.ui.init()}])}(),function(){angular.module("vehicleModule",["ui.bootstrap","ui-notification"]),angular.module("vehicleModule").factory("vehicleFactory",["$http","systemConfig",function(e,t){var n={};return n.findByVehicleNumber=function(n,a){var i=t.apiUrl+"/api/care-point/master/vehicle/find-by-vehicle-no/"+n;e.get(i).success(function(e,t,n){a(e)}).error(function(e,t,n){})},n.loadVehicle=function(n){var a=t.apiUrl+"/api/care-point/master/vehicle";e.get(a).success(function(e,t,a){n(e)}).error(function(e,t,n){})},n.lordClient=function(n){var a=t.apiUrl+"/api/care-point/master/client";e.get(a).success(function(e,t,a){n(e)}).error(function(e,t,n){})},n.getBrandList=function(n){var a=t.apiUrl+"/api/care-point/service/zmaster/vehicle/get-brand-list";e.get(a).success(function(e,t,a){n(e)}).error(function(e,t,n){})},n.getModelList=function(n){var a=t.apiUrl+"/api/care-point/service/zmaster/vehicle/get-model-list";e.get(a).success(function(e,t,a){n(e)}).error(function(e,t,n){})},n.getFuelTypeList=function(n){var a=t.apiUrl+"/api/care-point/service/zmaster/vehicle/get-fuel-type-list";e.get(a).success(function(e,t,a){n(e)}).error(function(e,t,n){})},n.getNewVehicleList=function(n){var a=t.apiUrl+"/api/care-point/service/zmaster/vehicle/get-new-vehicles";e.get(a).success(function(e,t,a){n(e)}).error(function(e,t,n){})},n.lordVehicleType=function(n){var a=t.apiUrl+"/api/care-point/master/vehicle-type";e.get(a).success(function(e,t,a){n(e)}).error(function(e,t,n){})},n.lordPriceCategory=function(n){var a=t.apiUrl+"/api/care-point/master/priceCategory";e.get(a).success(function(e,t,a){n(e)}).error(function(e,t,a){n(e)})},n.insertVehicle=function(n,a,i){var o=t.apiUrl+"/api/care-point/master/vehicle/insert-detail";e.post(o,n).success(function(e,t,n){a(e)}).error(function(e,t,n){i(e)})},n.deleteVehicle=function(n,a,i){var o=t.apiUrl+"/api/care-point/master/vehicle/delete-detail/"+n;e.delete(o).success(function(e,t,n){a(e)}).error(function(e,t,n){i(e)})},n}]),angular.module("vehicleModule").controller("vehicleController",["$scope","$filter","$log","$timeout","$routeParams","vehicleFactory","Notification",function(e,t,n,a,i,o,r){e.model={},e.ui={},e.http={},e.ui.mode=null,e.model.vehicle={},e.model.vehicleList=[],e.model.brandList=[],e.model.modelList=[],e.model.fuelTypeListList=[],e.model.newVehicleList=[],e.model.searchKeyword=null,e.model.showSuggestions=!1,e.model.searchSuggestions=[],e.model.reset=function(){e.model.vehicle={}},e.ui.focus=function(){a(function(){document.querySelectorAll("#clientText")[0].focus()},10)},e.validateInput=function(){return!!(e.model.vehicle.client&&e.model.vehicle.vehicleNo&&e.model.vehicle.vehicleType&&e.model.vehicle.priceCategory&&e.model.vehicle.type&&e.model.vehicle.brand&&e.model.vehicle.fuelType&&e.model.vehicle.lastMilage&&e.model.vehicle.model)},e.http.deleteVehicle=function(t,n){o.deleteVehicle(t,function(){e.model.vehicleList.splice(n,1),r.success("delete success")},function(e){r.error(e.message)})},e.http.saveVehicle=function(){e.model.vehicle.isNew=!1,angular.isUndefined(e.model.vehicle.date)&&(e.model.vehicle.date=t("date")(new Date,"yyyy-MM-dd"));var n=e.model.vehicle,a=JSON.stringify(n);o.insertVehicle(a,function(t){e.model.vehicleList.push(t),r.success("Successfully Added"),e.model.reset(),e.ui.mode="IDEAL"},function(e){r.error(e.message)})},e.ui.save=function(){e.validateInput()?e.http.saveVehicle():r.error("Please Input Details")},e.clientData=function(t){var n="";return angular.forEach(e.model.clientList,function(e){if(console.log(t),console.log(e.indexNo+" - "+e.name),e.indexNo===parseInt(t))return void(n=e)}),n},e.clientLable=function(t){var n;return angular.forEach(e.model.clientList,function(e){if(e.indexNo===t)return void(n=e.indexNo+" - "+e.name)}),n},e.vehicleTypeLabel=function(t){var n;return angular.forEach(e.model.vehicleTypeList,function(e){if(e.indexNo===t)return void(n=e.indexNo+" - "+e.model)}),n},e.priceCategoryLabel=function(t){var n;return angular.forEach(e.model.priceCategoryList,function(e){if(e.indexNo===t)return void(n=e.name)}),n},e.ui.new=function(){e.ui.mode="NEW",e.model.reset(),e.ui.focus()},e.ui.edit=function(t,n){e.ui.mode="EDIT",e.model.vehicle=t,e.model.vehicleList.splice(n,1)},e.ui.editNewVehicle=function(t,n){e.ui.mode="EDIT",e.model.vehicle=t,e.model.newVehicleList.splice(n,1)},e.model.loadAllVehicles=function(){o.loadVehicle(function(t){e.model.vehicleList=t},function(e){r.error(e.message)})},e.model.findByVehicleNumber=function(){o.findByVehicleNumber(e.model.searchKeyword,function(t){e.model.searchSuggestions=t},function(){e.mode.searchSuggestions=[]})},e.ui.setVehicleData=function(t){e.model.vehicle=t,e.ui.mode="EDIT",e.model.searchKeyword=null},e.model.findVehicle=function(t){e.ui.mode="NEW";for(var n=0;n<e.model.newVehicleList.length;n++)if(e.model.newVehicleList[n].indexNo===parseInt(t))return e.model.newVehicleList[n]},e.ui.init=function(){e.ui.mode="IDEAL",e.model.reset(),o.getNewVehicleList(function(t){e.model.newVehicleList=t}),o.loadVehicle(function(t){e.model.vehicleList=t}),o.lordClient(function(t){e.model.clientList=t}),o.lordVehicleType(function(t){e.model.vehicleTypeList=t}),o.lordPriceCategory(function(t){e.model.priceCategoryList=t}),o.getBrandList(function(t){e.model.brandList=t}),o.getModelList(function(t){e.model.modelList=t}),o.getFuelTypeList(function(t){e.model.fuelTypeList=t}),e.$watch("model.searchKeyword",function(t,n){e.model.showSuggestions=t&&t.length,t&&t.length>=2&&e.model.findByVehicleNumber()}),e.$watch("model.vehicle",function(t){t&&(e.model.showSuggestions=!e.model.vehicle)});var t=parseInt(i.vehicle);t&&(a(function(){e.model.vehicle=e.model.findVehicle(t)},2e3),console.log(t))},e.ui.init()}])}(),function(){angular.module("appModule").controller("ReportViewerController",["$scope","$filter","$sce","reportViewerModel","ReportViewerService",function(e,t,n,a,i){e.model={},e.newModel=new a,e.model.currentReportGroup={},e.model.currentReport={},e.model.currentReport.parameterValues={},e.ui={},e.report="#",e.ui.selectReportGroup=function(t){e.model.currentReportGroup=t},e.ui.selectReport=function(t){e.model.currentReport.report=t,i.listParameters(t).success(function(t){e.model.currentReport.parameters=t}),e.activeTabIndex=1,e.ui.status="PENDING"},e.ui.viewCurrentReport=function(){e.model.currentReport.report&&(e.ui.status="LOADING",i.viewReport(e.model.currentReport.report,e.model.currentReport.parameters,e.model.currentReport.parameterValues).success(function(t){e.ui.status="LOADED";var a=new Blob([t],{type:"application/pdf"}),i=URL.createObjectURL(a);e.content=n.trustAsResourceUrl(i)}))},e.ui.isParameterAvailable=function(t){return void 0!==e.model.currentReport.parameters&&e.model.currentReport.parameters.indexOf(t)>=0},e.init=function(){i.listReports().success(function(t){e.model.reports=t}),e.ui.status="PENDING"},e.init()}])}(),function(){angular.module("appModule").factory("reportViewerModel",["ReportViewerService",function(e){function t(){this.constructor()}return t.prototype={clientList:[],supplierList:[],branchList:[],employeeList:[],accountList:[],ledgerTypeList:[],constructor:function(){var t=this;e.getClientList().success(function(e){t.clientList=e}),e.getSupplierList().success(function(e){t.supplierList=e}),e.getBranchList().success(function(e){t.branchList=e}),e.getEmployeeList().success(function(e){t.employeeList=e}),e.getAccountList().success(function(e){t.accountList=e}),this.ledgerTypeList=["voucher","reconciliation","supplier_payment","cheque_return","transfer","journal","accrued"]},accountLable:function(e){var t="";return angular.forEach(this.accountList,function(n){if(n.indexNo===parseInt(e))return void(t=n.accCode+" - "+n.name)}),t},supplierLable:function(e){var t="";return angular.forEach(this.supplierList,function(n){if(n.indexNo===parseInt(e))return void(t=n.indexNo+" - "+n.name)}),t},
branchLable:function(e){var t="";return angular.forEach(this.branchList,function(n){if(n.indexNo===parseInt(e))return void(t=n.branchCode+" - "+n.name)}),t},employeeLable:function(e){var t="";return angular.forEach(this.employeeList,function(n){if(n.indexNo===parseInt(e))return void(t=n.indexNo+" - "+n.name)}),t},ledgerTypeLable:function(e){return e}},t}])}(),function(){angular.module("appModule").service("ReportViewerService",["$http","systemConfig",function(e,t){this.listReports=function(){return e.get(t.apiUrl+"/api/v1/report/report-viewer/list")},this.listParameters=function(n){return e.post(t.apiUrl+"/api/v1/report/report-viewer/report-parameters",JSON.stringify(n))},this.getReportUrl=function(e,n,a){var i=t.apiUrl+"/api/v1/report/report-viewer/report",o=btoa(e.fileName);return i=i+"?action="+o,angular.forEach(a,function(e,t){i=i+"&"+t+"="+e}),i},this.viewReport=function(t,n,a){return e.get(this.getReportUrl(t,n,a),{responseType:"arraybuffer"})},this.getPdfBytes=function(n){console.log(n);var a={client:"K W Chaminda"};return e.post(t.apiUrl+"/api/v1/report/report-viewer/report",JSON.stringify(a),{responseType:"arraybuffer"})},this.getClientList=function(){return e.get(t.apiUrl+"/api/care-point/master/client")},this.getSupplierList=function(){return e.get(t.apiUrl+"/api/care-point/master/supplier")},this.getBranchList=function(){return e.get(t.apiUrl+"/api/care-point/master/branch")},this.getEmployeeList=function(){return e.get(t.apiUrl+"/api/care-point/master/employee")},this.getAccountList=function(){return e.get(t.apiUrl+"/api/care-point/account/master/acc-account/find-only-account")}}])}(),function(){angular.module("dashBoardModule",["ui.bootstrap","ui-notification"]),angular.module("dashBoardModule").controller("dashBoardController",["$scope","dashBoardModel",function(e,t){e.model=new t}])}(),function(){angular.module("appModule").factory("dashBoardFactory",function(){var e={};return e.newData=function(){return{indexNo:null,vehicleNo:null,year:null,engineNo:null,chasisNo:null,insuranceExpiryDate:null,revenueExpiryDate:null,lastMilage:null,nextMilage:null,colour:null,client:null,vehicleType:null,priceCategory:null,type:null,model:null,brand:null,fuelType:null}},e})}(),function(){var e=function(e,t,n,a){function i(){this.constructor()}return i.prototype={data:{},constructor:function(){this.data=t.newData()}},i};e.$inject=["dashBoardService","dashBoardFactory","$q","$filter"],angular.module("appModule").factory("dashBoardModel",e)}(),function(){var e=function(e,t){};e.$inject=["$http","systemConfig"],angular.module("appModule").service("dashBoardService",e)}(),function(){angular.module("appModule").factory("grnModelFactory",function(){var e={};return e.newData=function(){return{indexNo:null,supplier:null,number:null,date:null,creditPeriod:0,amount:0,refNumber:null,branch:null,nbt:0,nbtValue:0,vat:0,vatValue:0,grandAmount:0,payAmount:0,balanceAmount:0,returnValue:0,status:"PENDING",type:"grn receive",isNbt:!1,isVat:!1,grnItemList:[]}},e.tempData=function(){return{indexNo:null,grn:null,purchaseOrderItem:null,price:0,qty:0,value:0,discount:0,discountValue:0,netValue:0,stockQty:0}},e.summaryData=function(){return{qty:0,value:0,discount:0}},e})}(),function(){"use strict";var e=function(e,t){this.loadApprovedPurchaseOrder=function(){return t.get(e.apiUrl+"/api/care-point/transaction/grn/approve-purchasse-order")},this.loadSuppliers=function(){return t.get(e.apiUrl+"/api/care-point/master/supplier")},this.loadItems=function(){return t.get(e.apiUrl+"/api/care-point/master/item/stock-nonstock-item")},this.saveGrnReceive=function(n){return t.post(e.apiUrl+"/api/care-point/transaction/grn/save-grn-recieve",n)},this.loadPendingGrnList=function(){return t.get(e.apiUrl+"/api/care-point/transaction/grn/pending-grn-list")},this.loadApprovedPurchaseOrderItemList=function(){return t.get(e.apiUrl+"/api/care-point/transaction/grn/approve-purchase-order-item-list")},this.saveGrnApprove=function(n){return t.post(e.apiUrl+"/api/care-point/transaction/grn/save-grn-approve",n)},this.getStockQty=function(n){return t.get(e.apiUrl+"/api/care-point/transaction/purchase-order-request/stock-qty/"+n)},this.saveDirectGrn=function(n){return t.post(e.apiUrl+"/api/care-point/transaction/grn/save-direct-grn",n)},this.getPermission=function(n){return t.get(e.apiUrl+"/api/care-point/account/account-setting/user-permission/by-form/"+n)},this.listParameters=function(n){return t.post(e.apiUrl+"/api/v1/report/report-viewer/report-parameters",JSON.stringify(n))},this.reportData=function(n){return t.get(e.apiUrl+"/api/v1/report/report-viewer/invoice-report-data/"+n)},this.getReportUrl=function(t,n,a){var i=e.apiUrl+"/api/v1/report/report-viewer/report",o=btoa(t.fileName);return i=i+"?action="+o,angular.forEach(a,function(e,t){i=i+"&"+t+"="+e}),i},this.viewReport=function(e,n,a){return t.get(this.getReportUrl(e,n,a),{responseType:"arraybuffer"})}};e.$inject=["systemConfig","$http"],angular.module("appModule").service("GrnService",e)}(),function(){angular.module("itemSalesModule",["ui.bootstrap"]),angular.module("itemSalesModule").controller("itemSalesController",["$scope","$window","systemConfig","$uibModalStack","$uibModal","optionPane","itemSalesModel","Notification","ConfirmPane",function(e,t,n,a,i,o,r,c,u){e.model=new r,e.ui={},e.init=function(){e.ui.mode="NEW",e.ui.model="SELECTION"},e.ui.tabPayment=function(t){e.ui.model=0===t?"SELECTION":"PAYMENT"},e.ui.new=function(){e.ui.mode="NEW"},e.ui.save=function(){e.ui.model="NEW",e.ui.mode="IDEAL"},e.ui.dismissAllModel=function(){a.dismissAll()},e.ui.getQuickSeacrhItem=function(t){e.quickSearchMode="show",e.model.getNonPackageItemItem(t).then(function(t){e.quickSearchMode="hide"},function(){e.quickSearchMode="hide"})},e.ui.focus=function(e){$timeout(function(){angular.element(document.querySelectorAll(e))[0].focus()},10)},e.ui.getItemUnitsDetails=function(t){e.model.tempItem.item=t[0],e.model.tempItem.itemName=t[1],e.model.tempItem.itemType="STOCK_ITEM",e.model.tempItem.jobStatus="APPROVE",e.model.tempItem.orderStatus="APPROVE",e.model.getItemUnits(t[0]),e.itemName=t[1],e.itemType=t[2],e.itemStockItemQty=0,e.model.findByAvailableStockQty(t[0]).then(function(t){e.itemStockItemQty=t}),0===e.model.getItemUnits(t[0]).length?o.dangerMessage("THERE ISN'T ITEM UNIT FOR THIS ITEM !"):e.itemStockItemQty>0?o.dangerMessage("THERE ISN'T QTY FOR THIS ITEM !"):(i.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"item_selection_popup.html",scope:e,size:"lg"}),e.ui.focus("#itemName"))},e.ui.addItemUnit=function(t,n){console.log(t),t.indexNo?n>e.itemStockItemQty?"SERVICE"===e.itemType?(e.model.tempItem.itemUnit=t.indexNo,e.model.tempItem.price=t.salePriceNormal,e.model.tempItem.quantity=n,e.model.tempItem.value=t.salePriceNormal*n,e.model.tempItem.itemName=t.itemName,e.model.tempItem.itemType="SERVICE_ITEM",e.model.jobItemList.push(e.model.tempItem),console.log(e.model.jobItemList),e.ui.getTotalAmount(t.salePriceNormal,n),e.model.tempItem={},e.ui.dismissAllModel()):o.dangerMessage("NO QTY!"):(e.model.tempItem.itemUnit=t.indexNo,e.model.tempItem.price=t.salePriceNormal,e.model.tempItem.quantity=n,e.model.tempItem.value=t.salePriceNormal*n,e.model.tempItem.itemType="STOCK_ITEM",e.model.jobItemList.push(e.model.tempItem),console.log(e.model.jobItemList),e.ui.getTotalAmount(t.salePriceNormal,n),e.model.tempItem={},e.ui.dismissAllModel()):c.error("select item")},e.ui.getTotalAmount=function(t,n){e.model.invoice.amount=null;var n=parseInt(n);e.totalAmount?(e.itemCount+=1,e.totalAmount+=t*n,e.model.invoice.amount=e.totalAmount):(e.totalAmount=t*n,e.model.invoice.amount=e.totalAmount,e.itemCount=1)},e.ui.getCashPayment=function(t,n){e.model.getInsertCashPayment(t,n)},e.ui.keyEvent=function(t,n){13===t.keyCode&&e.ui.getQuickSeacrhItem(n)},e.ui.getDiscountRate=function(){e.model.invoice.discountRate=parseFloat(100*e.model.invoice.discountAmount/e.model.invoice.amount),e.model.invoice.netAmount=parseFloat(e.model.invoice.amount-e.model.invoice.discountAmount)},e.ui.getDiscountAmount=function(){e.model.invoice.discountAmount=parseFloat(e.model.invoice.amount*e.model.invoice.discountRate/100),e.model.invoice.netAmount=parseFloat(e.model.invoice.amount-e.model.invoice.discountAmount)},e.ui.getInsertCardAndChequePayment=function(t,n){"CHEQUE"===n?t.number?t.chequeDate?t.bank?t.bankBranch?t.amount?e.model.getInsertCardAndChequePayment(t,n):c.error("please enter cheque amount"):c.error("please enter cheque branch"):c.error("please enter cheque bank"):c.error("please enter cheque date"):c.error("please enter cheque no"):"CARD"===n&&(t.cardType?t.amount?e.model.getInsertCardAndChequePayment(t,n):c.error("please enter card amount"):c.error("please enter card type"))},e.ui.getInsertCardAndChequePayment=function(t,n){"CHEQUE"===n?t.number?t.chequeDate?t.bank?t.bankBranch?t.amount?e.model.getInsertCardAndChequePayment(t,n):c.error("please enter cheque amount"):c.error("please enter cheque branch"):c.error("please enter cheque bank"):c.error("please enter cheque date"):c.error("please enter cheque no"):"CARD"===n&&(t.cardType?t.amount?e.model.getInsertCardAndChequePayment(t,n):c.error("please enter card amount"):c.error("please enter card type"))},e.ui.insertClientOverPaymentSettlment=function(){e.model.information.overPayment>=e.model.paymentInformation.amount?e.model.insertClientOverPaymentSettlment(e.model.paymentInformation.amount,"OVER_PAYMENT_SETTLEMENT"):c.error("please enter valid amount")},e.ui.getRepEmployeeData=function(t,n){e.empMobile=t.mobile,e.empType=t.type,e.empRol=t.rol,console.log(t)},e.ui.saveItemSale=function(){var t=!0;e.model.customerLedger.client||(t=!1,c.error("Select Customer to save !")),e.model.userPermission.add||(t=!1,c.error("you have no permission ")),0===e.model.jobItemList.length&&(t=!1,c.error("Select Invoice Item to save !")),t&&u.successConfirm("Do you want to save Item Sale!").confirm(function(){e.model.saveItemSale().then(function(t){e.ui.mode="IDEAL",e.itemKey="",c.success("Item Sale Save Successfully !")})})},e.ui.deleteSelectDetails=function(t,n){u.dangerConfirm("Are you sure want to remove item").confirm(function(){e.itemCount-=1,e.totalAmount-=n,e.model.invoice.amount=e.totalAmount,e.model.jobItemList.splice(t,1)})},e.ui.registerNewCustomerDetail=function(){t.location.href=n.apiUrl+"#/master/client/"},e.ui.deleteOverPayment=function(){e.model.payment.overPaymentAmount=0,e.model.deleteOverPayment()},e.ui.getCashPaymentDelete=function(){e.model.information.cash=0,e.model.payment.cashAmount=0,e.model.getCashPaymentDelete()},e.ui.getCardAndChequePaymentDelete=function(t,n){e.model.getCardAndChequePaymentDelete(t,n)},e.ui.modelOpen=function(){e.model.selectedCustomerObject(e.model.customerLedger.client),i.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"customer.html",scope:e,size:"lg"})},e.ui.registerCustomer=function(){var t=!0;e.model.popupCustomer.name||(t=!1,c.error("Customer Name is Empty !")),e.model.popupCustomer.resident||(t=!1,c.error("select a resident to save !")),t&&e.model.registerCustomer().then(function(t){c.success(t.resident+" "+t.name+" registration successfully"),e.model.customerLedger.client=t.indexNo,e.ui.modelCancel()})},e.ui.modelCancel=function(){a.dismissAll()},e.init()}])}(),function(){angular.module("appModule").factory("itemSalesFactory",function(){var e={};return e.tempData=function(){return{indexNo:null,jobCard:null,item:null,itemName:null,itemUnit:null,itemType:null,quantity:null,stockRemoveQty:null,price:null,value:null,orderStatus:null,jobStatus:null,isChange:null}},e.customerData=function(){return{name:null,mobile:null}},e.customerLedger=function(){return{indexNo:null,invoice:null,payment:null,date:null,debitAmount:0,creditAmount:0,type:null,client:null,refNumber:null,formName:null}},e.payment=function(){return{indexNo:"",number:0,totalAmount:0,cashAmount:0,chequeAmount:0,cardAmount:0,balanceAmount:0,respEmployee:null,overPaymentAmount:0}},e.information=function(){return{clientMobile:null,balanceAmount:0,overPayment:0,cash:0,invoiceTotalPayment:0}},e.paymentInformation=function(){return{indexNo:null,payment:null,number:null,chequeDate:null,type:null,amount:0,formName:null,bank:null,bankBranch:null,cardType:null}},e.invoiceData=function(){return{indexNo:null,jobCard:null,date:null,number:null,amount:0,discountRate:0,discountAmount:0,netAmount:0,branch:null,status:"item_sales"}},e.saveData=function(){return{jobItem:[],customerLedger:{},payment:{},invoice:{},paymentInformationList:[]}},e})}(),function(){angular.module("appModule").factory("itemSalesModel",["itemSalesService","itemSalesFactory","$filter","$q","Notification",function(e,t,n,a,i){function o(){this.constructor()}return o.prototype={clientList:[],employeeList:[],jobItemList:[],itemsByStockLeger:[],itemUnits:[],paymentInformationList:[],branchSearchList:[],customerTypeList:[],cardReaderList:[],payment:{},information:{},paymentInformation:{},customerLedger:{},saveData:{},invoice:{},popupCustomer:{},userPermission:{},tempItem:{},itemSale:{},customerData:{},constructor:function(){var n=this;this.tempItem=t.tempData(),this.customerData=t.customerData(),this.customerLedger=t.customerLedger(),this.payment=t.payment(),this.information=t.information(),this.paymentInformation=t.paymentInformation(),this.invoice=t.invoiceData(),this.saveData=t.saveData(),e.loadClient().success(function(e){n.clientList=e}),e.loadEmployee().success(function(e){n.employeeList=e}),e.loadItemUnits().success(function(e){n.itemUnits=e}),e.loadBank().success(function(e){n.bankList=e}),e.loadBranch().success(function(e){n.branchList=e}),e.loadCardType().success(function(e){n.cardTypeList=e}),e.getCustomerTypes().success(function(e){n.customerTypeList=e}),e.getCardReaders().success(function(e){n.cardReaderList=e}),e.getPermission("Item Sales").success(function(e){n.userPermission=e})},saveItemSale:function(){var t=a.defer(),n=this;return n.saveData.jobItem=n.jobItemList,n.saveData.customerLedger=n.customerLedger,n.saveData.payment=n.payment,n.saveData.paymentInformationList=n.paymentInformationList,n.saveData.invoice=n.invoice,console.log(n.saveData),e.saveItemSale(JSON.stringify(this.saveData)).success(function(e){console.log(e),n.clear(),t.resolve(e)}).error(function(){console.log("error"),t.reject()}),t.promise},clear:function(){this.customerLedger=t.customerLedger(),this.payment=t.payment(),this.information=t.information(),this.paymentInformation=t.paymentInformation(),this.invoice=t.invoiceData(),this.saveData=t.saveData(),this.customerData={},this.itemsByStockLeger=[],this.paymentInformationList=[],this.branchSearchList=[],this.jobItemList=[]},getNonPackageItemItem:function(t){var n=this,i=a.defer();return e.getNonPackageItemItem(t).success(function(e){n.itemsByStockLeger=[],n.itemsByStockLeger=e,i.resolve(e)}).error(function(){n.itemsByStockLeger=[],i.reject()}),i.promise},getItemUnits:function(e){var t=[];return this.selectItemUnits=[],angular.forEach(this.itemUnits,function(n){if(n.item===parseInt(e))return void t.push(n)}),this.selectItemUnits=t,t},findByAvailableStockQty:function(t){var n=a.defer();return e.findByAvailableStockQty(t).success(function(e){n.resolve(e)}).error(function(){n.reject()}),n.promise},getInsertCashPayment:function(e,t){this.payment.cashAmount=0,this.payment.cashAmount=parseFloat(e),this.payment.totalAmount+=parseFloat(e),this.paymentInformation.amount=parseFloat(e),this.paymentInformation.type=t,this.paymentInformationList.push(this.paymentInformation),this.paymentInformation={},this.getPaymentDetails(),console.log(this.paymentInformationList)},getPaymentDetails:function(){this.payment.chequeAmount=parseFloat(this.getTotalPaymentTypeWise("CHEQUE")),this.payment.cardAmount=parseFloat(this.getTotalPaymentTypeWise("CARD")),this.payment.overPaymentAmount=parseFloat(this.getTotalPaymentTypeWise("OVER_PAYMENT_SETTLEMENT")),console.log(this.payment.overPaymentAmount),this.payment.totalAmount=parseFloat(this.payment.cashAmount)+parseFloat(this.payment.cardAmount)+parseFloat(this.payment.chequeAmount)+parseFloat(this.payment.overPaymentAmount),this.payment.balanceAmount=parseFloat(this.information.invoiceTotalPayment)-this.payment.totalAmount,this.payment.balanceAmount<0&&(this.payment.balanceAmount=0),this.payment.overPayment=parseFloat(this.payment.totalAmount)-parseFloat(this.information.invoiceTotalPayment)},getInsertCardAndChequePayment:function(e,t){e.type=t,this.paymentInformationList.push(e),this.paymentInformation={},this.getPaymentDetails()},insertClientOverPaymentSettlment:function(e,n){this.paymentInformation=t.paymentInformation(),this.paymentInformation.type=n,this.paymentInformation.amount=e,this.paymentInformationList.push(this.paymentInformation),this.paymentInformation={},this.getPaymentDetails()},deleteOverPayment:function(){var e=this;angular.forEach(this.paymentInformationList,function(t){"OVER_PAYMENT_SETTLEMENT"===t.type&&(e.paymentInformationList.splice(e.paymentInformationList.indexOf(t),1),e.getPaymentDetails())})},getCashPaymentDelete:function(){var e=this;angular.forEach(this.paymentInformationList,function(t){"CASH"===t.type&&(e.paymentInformationList.splice(e.paymentInformationList.indexOf(t),1),e.getPaymentDetails())})},getCardAndChequePaymentDelete:function(e,t){for(var n=this,a=-1,i=0;i<n.paymentInformationList.length;i++)n.paymentInformationList[i].type===t&&n.paymentInformationList[i].number===e&&(a=i);this.paymentInformationList.splice(a,1),this.getPaymentDetails()},getTotalPaymentTypeWise:function(e){var t=0;return angular.forEach(this.paymentInformationList,function(n){if(n.type===e)return void(t+=n.amount)}),t},cardTypeLable:function(e){var t="";return angular.forEach(this.cardTypeList,function(n){if(n.indexNo===parseInt(e))return void(t=n.name)}),t},clientBalance:function(t){var n=this;e.getClientBalance(t).success(function(e){n.information.balanceAmount=parseFloat(e)})},clientOverPayment:function(t){var n=this;e.getClientOverPayment(t).success(function(e){n.information.overPayment=parseFloat(e)})},clientLabel:function(e){var t=this;t.customerData.name=e.name,t.customerData.mobile=e.mobile,t.invoice.branch=e.branch,t.clientBalance(e.indexNo),t.clientOverPayment(e.indexNo)},clientLabelFormater:function(e){var t="";return angular.forEach(this.clientList,function(n){if(n.indexNo===parseInt(e))return void(t=n.indexNo+" - "+n.name+" - "+n.mobile)}),t},bankLable:function(e){var t="";return angular.forEach(this.bankList,function(n){if(n.indexNo===parseInt(e))return void(t=n.name)}),t},employeeLable:function(e){var t="";return angular.forEach(this.employeeList,function(n){if(n.indexNo===parseInt(e))return void(t=n.name)}),t},branchLable:function(e){var t="";return angular.forEach(this.branchSearchList,function(n){if(n.indexNo===parseInt(e))return void(t=n.name)}),t},findByBranchList:function(t){var n=this,i=a;e.loadBranchByBank(t).success(function(e){n.branchSearchList=e,i.resolve()}).error(function(){i.reject()}),i.promise},registerCustomer:function(){var t=this,n=a.defer();return e.registerCustomer(JSON.stringify(this.popupCustomer)).success(function(e){t.clientList.push(e),n.resolve(e)}).error(function(){n.reject()}),n.promise},client:function(e){var t="";return angular.forEach(this.clientList,function(n){if(n.indexNo===parseInt(e))return void(t=n)}),t},customerTypeLable:function(e){var t="";return angular.forEach(this.customerTypeList,function(n){if(n.indexNo===parseInt(e))return void(t=n.indexNo+" - "+n.name)}),t},cardReaderLable:function(e){var t="";return angular.forEach(this.cardReaderList,function(n){if(n.indexNo===parseInt(e))return void(t=n.indexNo+" - "+n.name)}),t},selectedCustomerObject:function(e){this.popupCustomer=this.client(e)}},o}])}(),function(){"use strict";var e=function(e,t){this.loadClient=function(){return t.get(e.apiUrl+"/api/care-point/master/client")},this.loadEmployee=function(){return t.get(e.apiUrl+"/api/care-point/master/employee")},this.loadItemUnits=function(){return t.get(e.apiUrl+"/api/care-point/master/item-unit")},this.getClientBalance=function(n){return t.get(e.apiUrl+"/api/care-point/transaction/customer-payment-voucher/get-client-balance/"+n)},this.getClientOverPayment=function(n){return t.get(e.apiUrl+"/api/care-point/transaction/customer-payment-voucher/get-client-over-payment/"+n)},this.getBalanceInvoiceCount=function(n){return t.get(e.apiUrl+"/api/care-point/transaction/customer-payment-voucher/get-balance-invoice-count/"+n)},this.getBalanceInvoiceList=function(n){return t.get(e.apiUrl+"/api/care-point/transaction/customer-payment-voucher/get-balance-invoice/"+n)},this.loadBranch=function(){return t.get(e.apiUrl+"/api/care-point/service/bank-branch/branch")},this.loadCardType=function(){return t.get(e.apiUrl+"/api/care-point/service/bank-branch/card_type")},this.loadBranchByBank=function(n){return t.get(e.apiUrl+"/api/care-point/service/bank-branch/find-by-branch/"+n)},this.loadBank=function(){return t.get(e.apiUrl+"/api/care-point/service/bank-branch/bank")},this.getCustomerTypes=function(){return t.get(e.apiUrl+"/api/care-point/master/customer-type")},this.getCardReaders=function(){return t.get(e.apiUrl+"/api/care-point/master/card-reader/by-branch")},this.getNonPackageItemItem=function(n){return t.get(e.apiUrl+"/api/care-point/transaction/job-item/get-non-package-item/"+n)},this.findByAvailableStockQty=function(n){return t.get(e.apiUrl+"/api/care-point/transaction/job-item/get-item-qty-by-stocks/"+n)},this.saveItemSale=function(n){return t.post(e.apiUrl+"/api/care-point/service/item-sale/save-item-sale",n)},this.registerCustomer=function(n){return t.post(e.apiUrl+"/api/care-point/master/client/insert-client",n)},this.getPermission=function(n){return t.get(e.apiUrl+"/api/care-point/account/account-setting/user-permission/by-form/"+n)}};e.$inject=["systemConfig","$http"],angular.module("appModule").service("itemSalesService",e)}(),function(){angular.module("paymentVoucherModule",["ui.bootstrap"]),angular.module("paymentVoucherModule").controller("customerPaymentVoucherController",["$scope","$filter","customerPaymentVoucherModel","Notification","ConfirmPane",function(e,t,n,a,i){e.model=new n,e.prineModel={},e.ui={},e.ui.type="ADVANCE PAYMENT",e.ui.paymentType=function(t){e.ui.type=t,e.ui.mode="IDEAL",e.model.clear()},e.ui.selectClient=function(t){e.model.selectClient(t)},e.ui.selectClientFromBalance=function(t){e.model.selectClientFromBalance(t)},e.ui.selectVehicle=function(t){e.model.selectVehicle(t)},e.ui.getCashPayment=function(t,n){e.model.getInsertCashPayment(t,n)},e.ui.getCashPaymentDelete=function(){e.model.information.cash=0,e.model.payment.cashAmount=0,e.model.getCashPaymentDelete()},e.ui.new=function(){e.ui.mode="NEW",e.model.customerLedger.date=t("date")(new Date,"yyyy-MM-dd")},e.ui.getInsertCardAndChequePayment=function(t,n){"CHEQUE"===n?t.number?t.chequeDate?t.bank?t.bankBranch?t.amount?e.model.getInsertCardAndChequePayment(t,n):a.error("please enter cheque amount"):a.error("please enter cheque branch"):a.error("please enter cheque bank"):a.error("please enter cheque date"):a.error("please enter cheque no"):"CARD"===n&&(t.cardType?t.amount?e.model.getInsertCardAndChequePayment(t,n):a.error("please enter card amount"):a.error("please enter card type"))},e.ui.getCardAndChequePaymentDelete=function(t){e.model.getCardAndChequePaymentDelete(t)},e.ui.saveAdvancePayment=function(){var t=!0;e.model.payment.totalAmount||(t=!1,a.error("Empty Value to save Advance Payment")),e.model.userPermission.add||(t=!1,a.error("you have no permission ")),t&&i.successConfirm("Do you want to save advance payment !").confirm(function(){e.model.saveAdvancePayment().then(function(t){e.ui.mode="IDEAL",a.success("Advance Payment Save Successfully !")})})},e.ui.saveBalancePayment=function(){var t=!0;e.model.userPermission.add||(t=!1,a.error("you have no permission ")),t&&(e.model.payment.totalAmount?e.model.payment.totalAmount===e.model.information.invoiceTotalPayment?i.successConfirm("Do you want to save balance payment !").confirm(function(){e.ui.saveBalancePaymentSecond()}):e.model.payment.totalAmount>e.model.information.invoiceTotalPayment?i.warningConfirm("There is a Balance Payment.Do you want to Save ? ").confirm(function(){e.ui.saveBalancePaymentSecond()}):a.error("Pay Amount and Paid Total doesn't Match !"):a.error("Empty Value to save Advance Payment"))},e.ui.saveBalancePaymentSecond=function(){var t=!0;e.model.userPermission.add||(t=!1,a.error("you have no permission ")),t&&e.model.saveBalancePayment().then(function(t){e.ui.mode="IDEAL",a.success("Customer Balance Payment Save Successfully !")})},e.ui.insertClientOverPaymentSettlment=function(){e.model.information.overPayment>=e.model.paymentInformation.amount?(console.log(e.model.paymentInformation.amount),e.model.insertClientOverPaymentSettlment(e.model.paymentInformation.amount,"OVER_PAYMENT_SETTLEMENT")):a.error("plase enter valid amount")},e.init=function(){e.$watch("[model.balanceInvoiceList]",function(t,n){e.model.getInvoicePayAmount()},!0),e.ui.mode="IDEAL"},e.init()}])}(),function(){angular.module("appModule").factory("customerPaymentVoucherFactory",function(){var e={};return e.customerLedger=function(){return{indexNo:null,invoice:null,payment:null,date:null,debitAmount:0,creditAmount:0,type:null,client:null,refNumber:null,formName:null}},e.payment=function(){return{indexNo:"",number:0,totalAmount:0,cashAmount:0,chequeAmount:0,cardAmount:0,balanceAmount:0,respEmployee:null}},e.information=function(){return{clientMobile:null,vehicles:null,vehicle:null,pendingVehicles:null,balanceAmount:0,overPayment:0,cash:0,invoiceTotalPayment:0}},e.paymentInformation=function(){return{indexNo:null,payment:null,number:null,chequeDate:null,type:null,amount:0,fromName:"PAYMENT VOUCHER",bank:null,bankBranch:null,cardType:null}},e.saveData=function(){return{customerLedger:{},payment:{},paymentInformationList:[]}},e})}(),function(){angular.module("appModule").factory("customerPaymentVoucherModel",["customerPaymentVoucherService","customerPaymentVoucherFactory","$filter","$q","Notification",function(e,t,n,a,i){function o(){this.constructor()}return o.prototype={vehicleList:[],clientList:[],customerLedger:{},payment:{},information:{},paymentInformation:{},saveData:{},userPermission:{},paymentInformationList:[],branchSearchList:[],cardTypeList:[],balanceInvoiceList:[],constructor:function(){var n=this;this.customerLedger=t.customerLedger(),this.payment=t.payment(),this.information=t.information(),this.paymentInformation=t.paymentInformation(),this.saveData=t.saveData(),e.loadClient().success(function(e){n.clientList=e}),e.loadBank().success(function(e){n.bankList=e}),e.loadBranch().success(function(e){n.branchList=e}),e.loadCardType().success(function(e){n.cardTypeList=e}),e.getPermission("Customer Payment").success(function(e){n.userPermission=e})},selectClient:function(e){var t=this,n=this.client(e);t.information.clientMobile=n.mobile,t.information.vehicle="",this.clientBalance(e),this.clientOverPayment(e),this.getBalanceInvoiceCount(e)},selectClientFromBalance:function(e){var t=this;this.clientBalance(e),this.clientOverPayment(e),t.information.vehicle="",this.getBalanceInvoiceList(e)},selectVehicle:function(e){var t=this.vehicle(e),n=this.client(t.client);this.customerLedger.client=n.indexNo,this.information.clientMobile=n.mobile,this.clientVehicles(n.indexNo),this.clientBalance(n.indexNo),this.clientOverPayment(n.indexNo),this.getBalanceInvoiceCount(n.indexNo),this.getBalanceInvoiceList(n.indexNo)},vehicle:function(e){var t="";return angular.forEach(this.vehicleList,function(n){if(n.indexNo===parseInt(e))return void(t=n)}),t},client:function(e){var t="";return angular.forEach(this.clientList,function(n){if(n.indexNo===parseInt(e))return void(t=n)}),t},clear:function(){this.customerLedger=t.customerLedger(),this.payment=t.payment(),this.information=t.information(),this.paymentInformation=t.paymentInformation(),this.saveData=t.saveData(),this.paymentInformationList=[],this.branchSearchList=[],this.balanceInvoiceList=[]},clientLable:function(e){var t="";return angular.forEach(this.clientList,function(n){if(n.indexNo===parseInt(e))return void(t=n.indexNo+" - "+n.name)}),t},vehicleLable:function(e){var t="";return angular.forEach(this.vehicleList,function(n){if(n.indexNo===parseInt(e))return void(t=n.indexNo+" - "+n.vehicleNo)}),t},clientBalance:function(t){var n=this;e.getClientBalance(t).success(function(e){n.information.balanceAmount=parseFloat(e)})},getInvoicePayAmount:function(){var e=this,t=0;angular.forEach(e.balanceInvoiceList,function(n){t+=n.pay,e.information.invoiceTotalPayment=parseFloat(t)}),console.log(t)},clientOverPayment:function(t){var n=this;e.getClientOverPayment(t).success(function(e){n.information.overPayment=parseFloat(e)})},setBalanceAmountToText:function(e){var t=this;angular.forEach(t.balanceInvoiceList,function(t){t.invoice===parseInt(e)&&(t.pay=t.balance)})},checkBalanceAmount:function(e){var t=this;angular.forEach(t.balanceInvoiceList,function(t){t.invoice===parseInt(e)&&(console.log(t.balance),console.log(t.pay),t.balance<t.pay&&(t.pay=t.balance,i.error(t.balance+" is maximum pay amount for this invoice ! ")))})},getBalanceInvoiceList:function(t){var n=this;e.getBalanceInvoiceList(t).success(function(e){var t={};n.balanceInvoiceList=[],angular.forEach(e,function(e){t={},t.invoice=e[0],t.date=e[1],t.amount=e[2],t.paid=e[3],t.balance=e[4],t.pay=0,n.balanceInvoiceList.push(t)})})},getBalanceInvoiceCount:function(t){var n=this;e.getBalanceInvoiceCount(t).success(function(e){n.information.pendingVehicles=parseInt(e)})},getInsertCashPayment:function(e,t){this.payment.cashAmount=0,this.payment.cashAmount=parseFloat(e),this.payment.totalAmount+=parseFloat(e),this.paymentInformation.amount=parseFloat(e),this.paymentInformation.type=t,this.paymentInformationList.push(this.paymentInformation),this.paymentInformation={},this.getPaymentDetails(),console.log(this.paymentInformationList)},getCashPaymentDelete:function(){var e=this;angular.forEach(this.paymentInformationList,function(t){"CASH"===t.type&&(e.paymentInformationList.splice(e.paymentInformationList.indexOf(t),1),e.getPaymentDetails())})},getPaymentDetails:function(){this.payment.chequeAmount=parseFloat(this.getTotalPaymentTypeWise("CHEQUE")),this.payment.cardAmount=parseFloat(this.getTotalPaymentTypeWise("CARD")),this.payment.overPaymentSettlementAmount=parseFloat(this.getTotalPaymentTypeWise("OVER_PAYMENT_SETTLEMENT")),console.log(this.payment.overPaymentSettlementAmount),this.payment.totalAmount=parseFloat(this.payment.cashAmount)+parseFloat(this.payment.cardAmount)+parseFloat(this.payment.chequeAmount)+parseFloat(this.payment.overPaymentSettlementAmount),this.payment.balanceAmount=parseFloat(this.information.invoiceTotalPayment)-this.payment.totalAmount,this.payment.balanceAmount<0&&(this.payment.balanceAmount=0),this.payment.overPayment=parseFloat(this.payment.totalAmount)-parseFloat(this.information.invoiceTotalPayment)},getTotalPaymentTypeWise:function(e){var t=0;return angular.forEach(this.paymentInformationList,function(n){if(n.type===e)return void(t+=n.amount)}),t},getInsertCardAndChequePayment:function(e,t){e.type=t,this.paymentInformationList.push(e),this.paymentInformation={},this.getPaymentDetails()},bankLable:function(e){var t="";return angular.forEach(this.bankList,function(n){if(n.indexNo===parseInt(e))return void(t=n.name)}),t},branchLable:function(e){var t="";return angular.forEach(this.branchSearchList,function(n){if(n.indexNo===parseInt(e))return void(t=n.name)}),t},findByBranchList:function(t){var n=this,i=a;e.loadBranchByBank(t).success(function(e){n.branchSearchList=e,i.resolve()}).error(function(){i.reject()}),i.promise},cardTypeLable:function(e){var t="";return angular.forEach(this.cardTypeList,function(n){if(n.indexNo===parseInt(e))return void(t=n.name)}),t},getCardAndChequePaymentDelete:function(e){for(var t=this,n=-1,a=0;a<t.paymentInformationList.length;a++)t.paymentInformationList[a].number===e&&(n=a)
;this.paymentInformationList.splice(n,1),this.getPaymentDetails()},insertClientOverPaymentSettlment:function(e,n){this.paymentInformation=t.paymentInformation(),this.paymentInformation.type=n,this.paymentInformation.amount=e,this.paymentInformationList.push(this.paymentInformation),this.paymentInformation={},this.getPaymentDetails()},saveAdvancePayment:function(){this.saveData.customerLedger=this.customerLedger,this.saveData.payment=this.payment,this.saveData.paymentInformationList=this.paymentInformationList,console.log(this.saveData);var t=this,n=a.defer();return e.savePaymentVoucher(JSON.stringify(this.saveData)).success(function(e){console.log(e),t.clear(),n.resolve(e)}).error(function(){console.log("error"),n.reject()}),n.promise},saveBalancePayment:function(){this.saveData.customerLedger=this.customerLedger,this.saveData.payment=this.payment,this.saveData.paymentInformationList=this.paymentInformationList,this.saveData.invoice=this.balanceInvoiceList,console.log(this.saveData);var t=this,n=a.defer();return e.saveBalancePaymentVoucher(JSON.stringify(this.saveData)).success(function(e){console.log(e),t.clear(),n.resolve(e)}).error(function(){console.log("error"),n.reject()}),n.promise}},o}])}(),function(){"use strict";var e=function(e,t){this.loadClient=function(){return t.get(e.apiUrl+"/api/care-point/master/client")},this.getClientBalance=function(n){return t.get(e.apiUrl+"/api/care-point/transaction/customer-payment-voucher/get-client-balance/"+n)},this.getClientOverPayment=function(n){return t.get(e.apiUrl+"/api/care-point/transaction/customer-payment-voucher/get-client-over-payment/"+n)},this.getBalanceInvoiceCount=function(n){return t.get(e.apiUrl+"/api/care-point/transaction/customer-payment-voucher/get-balance-invoice-count/"+n)},this.getBalanceInvoiceList=function(n){return t.get(e.apiUrl+"/api/care-point/transaction/customer-payment-voucher/get-balance-invoice/"+n)},this.loadBank=function(){return t.get(e.apiUrl+"/api/care-point/service/bank-branch/bank")},this.loadBranch=function(){return t.get(e.apiUrl+"/api/care-point/service/bank-branch/branch")},this.loadCardType=function(){return t.get(e.apiUrl+"/api/care-point/service/bank-branch/card_type")},this.savePaymentVoucher=function(n){return t.post(e.apiUrl+"/api/care-point/transaction/customer-payment-voucher/save-payment-voucher",n)},this.saveBalancePaymentVoucher=function(n){return t.post(e.apiUrl+"/api/care-point/transaction/customer-payment-voucher/save-balance-payment-voucher",n)},this.loadBranchByBank=function(n){return t.get(e.apiUrl+"/api/care-point/service/bank-branch/find-by-branch/"+n)},this.getPermission=function(n){return t.get(e.apiUrl+"/api/care-point/account/account-setting/user-permission/by-form/"+n)}};e.$inject=["systemConfig","$http"],angular.module("appModule").service("customerPaymentVoucherService",e)}(),function(){angular.module("appModule").factory("PurchaseOrderRequestModelFactory",function(){var e={};return e.newData=function(){return{indexNo:null,supplier:null,number:null,date:null,deliverDate:null,approvedDate:null,status:null,isView:null,formName:null,itemValue:null,nbt:0,nbtValue:0,vat:0,vatValue:0,grandTotal:0,returnStatus:null,purchaseOrderItemList:[]}},e.tempData=function(){return{indexNo:null,purchaseOrder:null,item:null,price:0,qty:null,value:0,discount:0,discountValue:0,netValue:0,stockQty:0,orderQty:0,recieveQty:0,balanceQty:0,status:"PENDING"}},e.summaryData=function(){return{qty:null,value:null,discount:null}},e.reOrderData=function(){return{reOrderIndexNo:null,item:null,maxReOrder:null,minReOrder:null,branch:null,branchId:null,itemName:null,supplierName:null,supplierId:null,stockQty:null,orderQty:null,totalOrder:null,branchColor:null,availableQty:null,purchasingQty:null}},e.reOrderTempData=function(){return{reOrderIndexNo:null,item:null,maxReOrder:null,minReOrder:null,branch:null,branchId:null,itemName:null,supplierName:null,supplierId:null,stockQty:null,orderQty:null,totalOrder:null,branchColor:null,availableQty:null,netRequiredQty:null,purchasingQty:null}},e})}(),function(){"use strict";var e=function(e,t){this.loadSuppliers=function(){return t.get(e.apiUrl+"/api/care-point/master/supplier")},this.loadItems=function(){return t.get(e.apiUrl+"/api/care-point/master/item/stock-nonstock-item")},this.savePurchaseOrderRequest=function(n){return t.post(e.apiUrl+"/api/care-point/transaction/purchase-order-request/save",n)},this.getStockQty=function(n){return t.get(e.apiUrl+"/api/care-point/transaction/purchase-order-request/stock-qty/"+n)},this.loadPendingPurchaseOrderByNumber=function(n){return t.get(e.apiUrl+"/api/care-point/transaction/purchase-order-request/load-pending-purchase-order/"+n)},this.loadReOrderItem=function(){return t.get(e.apiUrl+"/api/care-point/transaction/purchase-order-request/getOrderRequestItems")},this.loadPendingPurchaseOrder=function(){return t.get(e.apiUrl+"/api/care-point/transaction/purchase-order-approve/pending-purchase-order")},this.getPermission=function(n){return t.get(e.apiUrl+"/api/care-point/account/account-setting/user-permission/by-form/"+n)},this.savePurchaseOrderApprove=function(n){return t.post(e.apiUrl+"/api/care-point/transaction/purchase-order-approve/save",n)},this.deletePurchaseOrder=function(n){return t.get(e.apiUrl+"/api/care-point/transaction/purchase-order-approve/delete/"+n)},this.getBranchesStock=function(n){return t.get(e.apiUrl+"/api/care-point/transaction/purchase-order-request/load-stock-in-branches/"+n)},this.getMainBranchAvailableStock=function(n){return t.get(e.apiUrl+"/api/care-point/transaction/purchase-order-request/get-main-branch-available-stock/"+n)},this.listParameters=function(n){return t.post(e.apiUrl+"/api/v1/report/report-viewer/report-parameters",JSON.stringify(n))},this.reportData=function(n){return t.get(e.apiUrl+"/api/v1/report/report-viewer/invoice-report-data/"+n)},this.getReportUrl=function(t,n,a){var i=e.apiUrl+"/api/v1/report/report-viewer/report",o=btoa(t.fileName);return i=i+"?action="+o,angular.forEach(a,function(e,t){i=i+"&"+t+"="+e}),i},this.viewReport=function(e,n,a){return t.get(this.getReportUrl(e,n,a),{responseType:"arraybuffer"})}};e.$inject=["systemConfig","$http"],angular.module("appModule").service("PurchaseOrderRequestService",e)}(),function(){angular.module("accountSettingModule",["ui.bootstrap","ui-notification"]),angular.module("accountSettingModule").factory("accountSettingFactory",["$http","systemConfig",function(e,t){var n={};return n.loadAllSetting=function(n){var a=t.apiUrl+"/api/care-point/account/account-setting";e.get(a).success(function(e,t,a){n(e)}).error(function(e,t,a){n(e)})},n.loadAllAccounts=function(n){var a=t.apiUrl+"/api/care-point/account/master/acc-account";e.get(a).success(function(e,t,a){n(e)}).error(function(e,t,a){n(e)})},n.save=function(n,a,i){var o=t.apiUrl+"/api/care-point/account/account-setting/save";e.post(o,n).success(function(e,t,n){a(e)}).error(function(e,t,n){i&&i(e)})},n}]),angular.module("accountSettingModule").controller("accountSettingController",["$scope","$filter","$log","ConfirmPane","$routeParams","accountSettingFactory","Notification","$timeout",function(e,t,n,a,i,o,r,c){e.model={},e.model.accSettingList=[],e.model.accAccountList=[],e.ui={},e.http={},e.ui.mode=null,e.ui.focus=function(e){c(function(){document.querySelectorAll(e)[0].focus()},10)},e.ui.new=function(){e.ui.mode="NEW",angular.forEach(e.model.accSettingList,function(e){e.tempAccount=e.accAccount}),console.log(e.model.accSettingList)},e.ui.save=function(){a.successConfirm("Do you want to save account setting !").confirm(function(){angular.forEach(e.model.accSettingList,function(e){e.accAccount=e.tempAccount}),e.http.save()})},e.model.accAccountLabel=function(t){var n="";return angular.forEach(e.model.accAccountList,function(e){if(e.indexNo===t)return void(n=e.accCode+" - "+e.name)}),n},e.http.save=function(){var t=e.model.accSettingList,n=JSON.stringify(t);o.save(n,function(e){r.success("Setting save success !")})},e.ui.init=function(){e.ui.mode="IDEAL",o.loadAllSetting(function(t){e.model.accSettingList=t}),o.loadAllAccounts(function(t){e.model.accAccountList=t})},e.ui.init()}])}(),function(){angular.module("userPermissionModule",["ui.bootstrap","ui-notification"]),angular.module("userPermissionModule").factory("userPermissionFactory",["$http","systemConfig",function(e,t){var n={};return n.loadUsers=function(n){var a=t.apiUrl+"/security/user-list";e.get(a).success(function(e,t,a){n(e)}).error(function(e,t,a){n(e)})},n.loadForm=function(n){var a=t.apiUrl+"/api/care-point/master/form-name";e.get(a).success(function(e,t,a){n(e)}).error(function(e,t,a){n(e)})},n.loadBranch=function(n){var a=t.apiUrl+"/api/care-point/master/branch";e.get(a).success(function(e,t,a){n(e)}).error(function(e,t,a){n(e)})},n.loadUserPermissionDetails=function(n,a,i){var o=t.apiUrl+"/api/care-point/account/account-setting/user-permission/by-user/"+n;e.get(o).success(function(e,t,n){a(e)}).error(function(e,t,n){i&&i(e)})},n.save=function(n,a,i){var o=t.apiUrl+"/api/care-point/account/account-setting/user-permission/save";e.post(o,n).success(function(e,t,n){a(e)}).error(function(e,t,n){i&&i(e)})},n.getPermission=function(n,a){var i=t.apiUrl+"/api/care-point/account/account-setting/user-permission/by-form/"+n;e.get(i).success(function(e,t,n){a(e)}).error(function(e,t,n){a(e)})},n}]),angular.module("userPermissionModule").controller("userPermissionController",["$scope","$filter","$log","ConfirmPane","$routeParams","userPermissionFactory","Notification","$timeout",function(e,t,n,a,i,o,r,c){e.model={},e.model.userList=[],e.model.detailList=[],e.model.formList=[],e.model.branchList=[],e.model.permission={},e.ui={},e.http={},e.ui.mode=null,e.ui.focus=function(e){c(function(){document.querySelectorAll(e)[0].focus()},10)},e.ui.new=function(){e.ui.mode="NEW",e.ui.focus("#user")},e.ui.selectUser=function(t){o.loadUserPermissionDetails(t,function(t){e.model.detailList=t})},e.ui.refresh=function(){e.model.selectedUser&&e.ui.selectUser(e.model.selectedUser)},e.ui.permissionTypeClick=function(t,n){console.log(n),"all"===t&&e.ui.setAllPermission(n),"view"===t&&e.ui.setViewPermission(n),"add"===t&&e.ui.setAddPermission(n),"update"===t&&e.ui.setEditPermission(n),"delete"===t&&e.ui.setDeletePermission(n)},e.ui.setAllPermission=function(t){angular.forEach(e.model.detailList,function(e){e.view=t,e.add=t,e.update=t,e.delete=t}),e.model.permission.view=t,e.model.permission.add=t,e.model.permission.edit=t,e.model.permission.delete=t},e.ui.setViewPermission=function(t){angular.forEach(e.model.detailList,function(e){e.view=t})},e.ui.setAddPermission=function(t){angular.forEach(e.model.detailList,function(e){e.add=t})},e.ui.setEditPermission=function(t){angular.forEach(e.model.detailList,function(e){e.update=t})},e.ui.setDeletePermission=function(t){angular.forEach(e.model.detailList,function(e){e.delete=t})},e.ui.save=function(){console.log(e.model.userPermission);var t=!0;e.model.userPermission.add||(t=!1,r.error("you have no permission !")),t&&a.successConfirm("Do you want to save user permissions !").confirm(function(){e.http.save()})},e.model.userLabel=function(t){var n="";return angular.forEach(e.model.userList,function(e){if(e.indexNo===parseInt(t))return void(n=e.indexNo+" - "+e.name)}),n},e.model.getUser=function(t){var n={};return angular.forEach(e.model.userList,function(e){if(e.indexNo===parseInt(t))return void(n=e)}),n},e.model.formLabel=function(t){var n="";return angular.forEach(e.model.formList,function(e){if(e.indexNo===parseInt(t))return void(n=e.name)}),n},e.model.branchLable=function(t){var n=e.model.getUser(t).branch,a="";return angular.forEach(e.model.branchList,function(e){if(e.indexNo===parseInt(n))return void(a=e.branchCode+" - "+e.name)}),a},e.http.save=function(){var t={userPermissionList:e.model.detailList};console.log(t),o.save(JSON.stringify(t),function(e){r.success("user permission save success !")})},e.ui.init=function(){e.ui.mode="IDEAL",o.loadUsers(function(t){e.model.userList=t}),o.loadForm(function(t){e.model.formList=t}),o.loadBranch(function(t){e.model.branchList=t}),o.getPermission("User Permission",function(t){e.model.userPermission=t})},e.ui.init()}])}(),function(){angular.module("appModule").controller("appController",["$scope","$cookies","$rootScope","$window","$filter","$location","SecurityService",function(e,t,n,a,i,o,r){e.hamburgerOpen=!0,e.ui={},n.$watch("layout.loading",function(){e.routeLoading=n.layout.loading}),e.userRoles=n.userRoles,e.homepageUrls=[],e.currentPageName="",e.loginUser="",e.currentBranch="",e.loginUser=t.get("nick-name"),e.currentBranch=t.get("branch-name"),e.date=i("date")(new Date,"yyyy-MM-dd"),angular.forEach(e.userRoles,function(t){t.homepageUrl&&e.homepageUrls.push({name:t.name,url:t.homepageUrl})}),e.toggleHamburger=function(t){e.hamburgerOpen=!e.hamburgerOpen,e.currentPageName=t,e.hamburgerOpen?$timeout(function(){angular.element(document.querySelector(".side-bar-left")).css("display","none")},600):angular.element(document.querySelector(".side-bar-left")).css("display","flex")},e.isHomepage=function(){return e.loginUser=t.get("nick-name"),e.currentBranch=t.get("branch-name"),"/"===o.path()},e.logout=function(){r.logout().success(function(){o.path("/login")})},angular.element(a).bind("keyup",function(t){18===t.keyCode&&(n.ctrlDown=!1),e.$apply()}),angular.element(a).bind("keydown",function(t){18===t.keyCode&&(n.ctrlDown=!0),e.$apply()})}])}(),function(){angular.module("appModule").controller("LoginController",["$scope","$cookies","$location","$timeout","SecurityService",function(e,t,n,a,i){e.ui={},e.model={},e.ui.focus=null,e.model.data={username:null,password:null},e.ui.onFocus=function(t){e.ui.focus=t},e.ui.onBlur=function(){e.ui.focus=null},e.ui.login=function(o){13===(o?o.keyCode||o.which:13)&&e.model.data.username&&e.model.data.password&&i.login(e.model.data).success(function(e,a,i){n.path("/"),t.put("nick-name",e.principal.nickName),t.put("branch-index-no",e.principal.branch),t.put("branch-name",e.principal.branchName)}).error(function(e,t){var n=angular.element(document.querySelectorAll(".login-form")[0]);n.addClass("login-failed"),a(function(){n.removeClass("login-failed")},1e3)})}}])}(),function(){angular.module("appModule").service("ConfirmPane",["$uibModal","$q",function(e,t){var n,a=function(e,t,a){function i(n,i){switch(this.modalInstance=n,this.timeout=i,this.message=t,this.title=a,e){case"primary":this.optionPaneClass="option-pane-primary",this.optionPaneIcon="glyphicon glyphicon-tag",this.title=void 0===this.title?"Confirm":this.title;break;case"info":this.optionPaneClass="option-pane-info",this.optionPaneIcon="glyphicon-bell",this.title=void 0===this.title?"Information":this.title;break;case"success":this.optionPaneClass="option-pane-success",this.optionPaneIcon="glyphicon-ok",this.title=void 0===this.title?"Success":this.title;break;case"warning":this.optionPaneClass="option-pane-warning",this.optionPaneIcon="glyphicon-warning-sign",this.title=void 0===this.title?"Warning":this.title;break;case"danger":this.optionPaneClass="option-pane-danger",this.optionPaneIcon="glyphicon-remove",this.title=void 0===this.title?"Danger":this.title;break;default:this.optionPaneClass="option-pane-default",this.optionPaneIcon="glyphicon-bell",this.title=void 0===this.title?"Note":this.title}}return i.prototype={confirm:function(){var e=this;this.timeout(function(){e.modalInstance.close(),n.resolve()},250)},discard:function(){var e=this;this.timeout(function(){e.modalInstance.close(),n.reject()},250)}},["$uibModalInstance","$timeout",i]};this.confirm=function(i,o,r){return n=t.defer(),e.open({animation:!0,backdrop:"static",ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"./app/util/dialog/confirm-pane.html",controller:a(i,o,r),controllerAs:"$ctrl",size:"md"}),{confirm:function(e){return n.promise.then(e,null),this},discard:function(e){return n.promise.then(null,e),this}}},this.primaryConfirm=function(e,t){return this.confirm("primary",e,t)},this.infoConfirm=function(e,t){return this.confirm("info",e,t)},this.successConfirm=function(e,t){return this.confirm("success",e,t)},this.warningConfirm=function(e,t){return this.confirm("warning",e,t)},this.dangerConfirm=function(e,t){return this.confirm("danger",e,t)},this.defaultConfirm=function(e,t){return this.confirm("default",e,t)}}])}(),function(){angular.module("appModule").service("InputPane",["$uibModal","$q","Notification",function(e,t,n){var a,i=function(e,t){function i(n,a){switch(this.modalInstance=n,this.timeout=a,this.type=e,this.title=t,e){case"primary":this.optionPaneClass="option-pane-primary",this.optionPaneIcon="glyphicon glyphicon-tag",this.title=void 0===this.title?"Confirm":this.title;break;default:this.optionPaneClass="option-pane-default",this.optionPaneIcon="glyphicon-bell",this.title=void 0===this.title?"Note":this.title}}return i.prototype={confirm:function(e){var t=this;this.timeout(function(){angular.isUndefined(e)?n.error("please input text"):(t.modalInstance.close(),a.resolve(e))},250)},discard:function(){var e=this;this.timeout(function(){e.modalInstance.close(),a.reject()},250)}},["$uibModalInstance","$timeout",i]};this.confirm=function(n,o){return a=t.defer(),e.open({animation:!0,backdrop:"static",ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"./app/util/dialog/input-option-pane.html",controller:i(n,o),controllerAs:"$ctrl",size:"md"}),{confirm:function(e){return a.promise.then(e,null),this},discard:function(e){return a.promise.then(null,e),this}}},this.primaryInput=function(e){return this.confirm("primary",e)},this.defaultInput=function(e){return this.confirm("default",e)}}])}(),function(){angular.module("appModule").service("optionPane",["$uibModal",function(e){var t=function(e,t,n){function a(a,i){switch(this.modalInstance=a,this.timeout=i,this.message=t,this.title=n,e){case"primary":this.optionPaneClass="option-pane-primary",this.optionPaneIcon="glyphicon glyphicon-tag",this.title=void 0===this.title?"Message":this.title;break;case"info":this.optionPaneClass="option-pane-info",this.optionPaneIcon="glyphicon-bell",this.title=void 0===this.title?"Information":this.title;break;case"success":this.optionPaneClass="option-pane-success",this.optionPaneIcon="glyphicon-ok",this.title=void 0===this.title?"Success":this.title;break;case"warning":this.optionPaneClass="option-pane-warning",this.optionPaneIcon="glyphicon-warning-sign",this.title=void 0===this.title?"Warning":this.title;break;case"danger":this.optionPaneClass="option-pane-danger",this.optionPaneIcon="glyphicon-remove",this.title=void 0===this.title?"Danger":this.title;break;default:this.optionPaneClass="option-pane-default",this.optionPaneIcon="glyphicon-bell",this.title=void 0===this.title?"Note":this.title}}return a.prototype={continue:function(){var e=this;this.timeout(function(){e.modalInstance.close()},250)}},["$uibModalInstance","$timeout",a]};this.message=function(n,a,i){e.open({animation:!0,backdrop:"static",ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"./app/util/dialog/option-pane.html",controller:t(n,a,i),controllerAs:"$ctrl",size:"md"})},this.primaryMessage=function(e,t){this.message("primary",e,t)},this.infoMessage=function(e,t){this.message("info",e,t)},this.successMessage=function(e,t){this.message("success",e,t)},this.warningMessage=function(e,t){this.message("warning",e,t)},this.dangerMessage=function(e,t){this.message("danger",e,t)},this.defaultMessage=function(e,t){this.message("default",e,t)}}])}(),function(){angular.module("appModule").service("ProgressPane",["$uibModal","$timeout",function(e,t){var n=function(e,t){function n(n,a){switch(this.modalInstance=n,this.timeout=a,this.title=t,this.title=void 0===this.title?"Loading...":this.title,e){case"primary":this.progressClass="progress-bar-primary",this.optionPaneClass="option-pane-primary";break;case"info":this.progressClass="progress-bar-info",this.optionPaneClass="option-pane-info";break;case"success":this.progressClass="progress-bar-success",this.optionPaneClass="option-pane-success";break;case"warning":this.progressClass="progress-bar-warning",this.optionPaneClass="option-pane-warning";break;case"danger":this.progressClass="progress-bar-danger",this.optionPaneClass="option-pane-danger";break;default:this.progressClass="progress-bar-default",this.optionPaneClass="option-pane-default"}}return n.prototype={continue:function(){var e=this;this.timeout(function(){e.modalInstance.close()},250)}},["$uibModalInstance","$timeout",n]};this.progress=function(a,i,o){var r=e.open({animation:!0,backdrop:"static",ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"./app/util/dialog/progress-pane.html",controller:n(a,i),controllerAs:"$ctrl",size:"md"});return{close:function(){t(function(){r.close()},1e3)}}},this.primaryProgress=function(e){return this.progress("primary",e)},this.infoProgress=function(e){return this.progress("info",e)},this.successProgress=function(e){return this.progress("success",e)},this.warningProgress=function(e){return this.progress("warning",e)},this.dangerProgress=function(e){return this.progress("danger",e)},this.defaultProgress=function(e){return this.progress("default",e)}}])}(),angular.module("appModule").service("ngDraggable",[function(){this.inputEvent=function(e){return angular.isDefined(e.touches)?e.touches[0]:angular.isDefined(e.originalEvent)&&angular.isDefined(e.originalEvent.touches)?e.originalEvent.touches[0]:e}}]),angular.module("appModule").directive("ngDrag",["$rootScope","$parse","$document","$window","ngDraggable",function(e,t,n,a,i){return{restrict:"A",link:function(o,r,c){o.value=c.ngDrag;var u,s,l,d,m,p,f,h,g=!1,v="ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch,y="touchmove mousemove",D=o.$id,b=null,I=null,L=!1,C=null,A=t(c.ngDragSuccess)||null,P=!angular.isDefined(c.allowTransform)||o.$eval(c.allowTransform),N=t(c.ngDragData),M=angular.noop,S=function(e){e&&(o.$on("$destroy",w),o.$watch(c.ngDrag,x),o.$watch(c.ngCenterAnchor,E),h?h.on("touchstart mousedown",O):r.on("touchstart mousedown",O),v||"img"!=r[0].nodeName.toLowerCase()||r.on("mousedown",function(){return!1}))},w=function(e){S(!1)},x=function(e,t){L=e},E=function(e,t){angular.isDefined(e)&&(g=e||"true")},T=function(e){return angular.isDefined(angular.element(e.target).attr("ng-cancel-drag"))},O=function(e){L&&(T(e)||"mousedown"==e.type&&0!=e.button||(v?(U(),C=setTimeout(function(){U(),B(e)},100),n.on(y,U),n.on("touchend mouseup",U)):B(e)))},U=function(){clearTimeout(C),n.off(y,U),n.off("touchend mouseup",U)},B=function(t){L&&(t.preventDefault(),u=r[0].getBoundingClientRect(),I=P?u:{left:document.body.scrollLeft,top:document.body.scrollTop},r.centerX=r[0].offsetWidth/2,r.centerY=r[0].offsetHeight/2,s=i.inputEvent(t).pageX,l=i.inputEvent(t).pageY,p=s-u.left,f=l-u.top,g?(d=s-r.centerX-a.pageXOffset,m=l-r.centerY-a.pageYOffset):(d=s-p-a.pageXOffset,m=l-f-a.pageYOffset),n.on(y,F),n.on("touchend mouseup",k),M=e.$on("draggable:_triggerHandlerMove",function(e,t){F(t)}))},F=function(t){L&&(t.preventDefault(),r.hasClass("dragging")||(b=N(o),r.addClass("dragging"),e.$broadcast("draggable:start",{x:s,y:l,tx:d,ty:m,event:t,element:r,data:b})),s=i.inputEvent(t).pageX,l=i.inputEvent(t).pageY,g?(d=s-r.centerX-I.left,m=l-r.centerY-I.top):(d=s-p-I.left,m=l-f-I.top),R(d,m),e.$broadcast("draggable:move",{x:s,y:l,tx:d,ty:m,event:t,element:r,data:b,uid:D}))},k=function(t){L&&(t.preventDefault(),e.$broadcast("draggable:end",{x:s,y:l,tx:d,ty:m,event:t,element:r,data:b,callback:V,uid:D}),r.removeClass("dragging"),r.parent().find(".drag-enter").removeClass("drag-enter"),$(),n.off(y,F),n.off("touchend mouseup",k),M())},V=function(e){A&&o.$apply(function(){A(o,{$data:b,$event:e})})},$=function(){P?r.css({transform:"","z-index":"","-webkit-transform":"","-ms-transform":""}):r.css({position:"",top:"",left:""})},R=function(e,t){P?r.css({transform:"matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, "+e+", "+t+", 0, 1)","z-index":99999,"-webkit-transform":"matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, "+e+", "+t+", 0, 1)","-ms-transform":"matrix(1, 0, 0, 1, "+e+", "+t+")"}):r.css({left:e+"px",top:t+"px",position:"fixed"})};!function(){if(r.attr("draggable","false"),r[0].querySelectorAll)var e=angular.element(r[0].querySelectorAll("[ng-drag-handle]"));else var e=r.find("[ng-drag-handle]");e.length&&(h=e),S(!0)}()}}}]).directive("ngDrop",["$parse","$timeout","$window","$document","ngDraggable",function(e,t,n,a,i){return{restrict:"A",link:function(n,i,o){n.value=o.ngDrop,n.isTouching=!1;var r=null,c=n.$id,u=!1,s=e(o.ngDropSuccess),l=e(o.ngDragStart),d=e(o.ngDragStop),m=e(o.ngDragMove),p=function(e){e&&(n.$watch(o.ngDrop,h),n.$on("$destroy",f),n.$on("draggable:start",g),n.$on("draggable:move",v),n.$on("draggable:end",y))},f=function(e){p(!1)},h=function(e,t){u=e},g=function(e,a){u&&(D(a.x,a.y,a.element),o.ngDragStart&&t(function(){l(n,{$data:a.data,$event:a})}))},v=function(e,a){u&&(D(a.x,a.y,a.element),o.ngDragMove&&t(function(){m(n,{$data:a.data,$event:a})}))},y=function(e,a){if(!u||c===a.uid)return void b(!1,a.element);D(a.x,a.y,a.element)&&(a.callback&&a.callback(a),o.ngDropSuccess&&t(function(){s(n,{$data:a.data,$event:a,$target:n.$eval(n.value)})})),o.ngDragStop&&t(function(){d(n,{$data:a.data,$event:a})}),b(!1,a.element)},D=function(e,t,a){var o=I(e,t);return n.isTouching=o,o&&(r=i),b(o,a),o},b=function(e,t){e?(i.addClass("drag-enter"),t.addClass("drag-over")):r==i&&(r=null,i.removeClass("drag-enter"),t.removeClass("drag-over"))},I=function(e,t){var n=i[0].getBoundingClientRect();return e-=a[0].body.scrollLeft+a[0].documentElement.scrollLeft,t-=a[0].body.scrollTop+a[0].documentElement.scrollTop,e>=n.left&&e<=n.right&&t<=n.bottom&&t>=n.top};!function(){p(!0)}()}}}]).directive("ngDragClone",["$parse","$timeout","ngDraggable",function(e,t,n){return{restrict:"A",link:function(e,t,n){var a,i=!0,o=null;e.clonedData={};var r=function(t){t&&(e.$on("draggable:start",u),e.$on("draggable:move",s),e.$on("draggable:end",l),c())},c=function(){a.off("mousedown touchstart touchmove touchend touchcancel",p),a.on("mousedown touchstart touchmove touchend touchcancel",p)},u=function(n,a,r){i=!0,angular.isDefined(a.data.allowClone)&&(i=a.data.allowClone),i&&(e.$apply(function(){e.clonedData=a.data}),t.css("width",a.element[0].offsetWidth),t.css("height",a.element[0].offsetHeight),m(a.tx,a.ty)),o=t[0].getBoundingClientRect()},s=function(e,t){i&&(_tx=t.tx+o.left,_ty=t.ty+o.top,m(_tx,_ty))},l=function(e,t){i&&d()},d=function(){t.css({left:0,top:0,position:"fixed","z-index":-1,visibility:"hidden"})},m=function(e,n){t.css({transform:"matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, "+e+", "+n+", 0, 1)","z-index":99999,visibility:"visible","-webkit-transform":"matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, "+e+", "+n+", 0, 1)","-ms-transform":"matrix(1, 0, 0, 1, "+e+", "+n+")"})},p=function(e){var t=e;return t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.cancelBubble=!0,t.returnValue=!1,!1};!function(){a=t.find("img"),t.attr("draggable","false"),a.attr("draggable","false"),d(),r(!0)}()}}}]).directive("ngPreventDrag",["$parse","$timeout",function(e,t){return{restrict:"A",link:function(e,t,n){var a=function(e){e&&t.on("mousedown touchstart touchmove touchend touchcancel",i)},i=function(e){var t=e.originalEvent;return t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.cancelBubble=!0,t.returnValue=!1,!1};!function(){t.attr("draggable","false"),a(!0)}()}}}]).directive("ngCancelDrag",[function(){return{restrict:"A",link:function(e,t,n){t.find("*").attr("ng-cancel-drag","ng-cancel-drag")}}}]).directive("ngDragScroll",["$window","$interval","$timeout","$document","$rootScope",function(e,t,n,a,i){return{restrict:"A",link:function(t,n,o){var r=null,c={verticalScroll:o.verticalScroll||!0,horizontalScroll:o.horizontalScroll||!0,activationDistance:o.activationDistance||75,scrollDistance:o.scrollDistance||15},u=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e,t){window.setTimeout(e,1e3/60)}}(),s=!1,l=function(){function t(e){var n=Array.prototype.slice.call(arguments);s&&u(function(){i.$apply(function(){e.apply(null,n),t(e)})})}s=!0,t(function(){if(r){var t=Math.max(document.documentElement.clientWidth,window.innerWidth||0),o=Math.max(document.documentElement.clientHeight,window.innerHeight||0),u=0,s=0;if(c.horizontalScroll&&(r.clientX<c.activationDistance?u=-c.scrollDistance:r.clientX>t-c.activationDistance&&(u=c.scrollDistance)),c.verticalScroll&&(r.clientY<c.activationDistance?s=-c.scrollDistance:r.clientY>o-c.activationDistance&&(s=c.scrollDistance)),0!==u||0!==s){var l=e.pageXOffset||a[0].documentElement.scrollLeft,d=e.pageYOffset||a[0].documentElement.scrollTop,m=n.css("transform");n.css("transform","initial"),e.scrollBy(u,s);var p=(e.pageXOffset||a[0].documentElement.scrollLeft)-l,f=(e.pageYOffset||a[0].documentElement.scrollTop)-d;n.css("transform",m),r.pageX+=p,r.pageY+=f,i.$emit("draggable:_triggerHandlerMove",r)}}})},d=function(){s=!1};t.$on("draggable:start",function(e,t){t.element[0]===n[0]&&(s||l())}),t.$on("draggable:end",function(e,t){t.element[0]===n[0]&&s&&d()}),t.$on("draggable:move",function(e,t){t.element[0]===n[0]&&(r=t.event)})}}}]),function(){angular.module("appModule").directive("btn",["rippleService",function(e){return{restrict:"C",link:e.ripple}}]).directive("fab",["rippleService",function(e){return{restrict:"C",link:e.ripple,scope:{show:"=fabShow"}}}]),angular.module("appModule").service("rippleService",["$timeout",function(e){this.ripple=function(t,n,a){void 0===t.show&&n.bind("click",function(t){t.preventDefault();var n=angular.element("<div/>"),a=this.getBoundingClientRect(),i=t.pageX-a.left,o=t.pageY-a.top;n.addClass("ripple-effect"),n.css("height",this.offsetWidth+"px"),n.css("width",this.offsetWidth+"px"),n.css({top:o-this.offsetWidth/2+"px",left:i-this.offsetWidth/2+"px"}),angular.element(this).append(n),e(function(){n.remove()},1e3)}),t.$watch("show",function(e,t){void 0!==e&&(n.hasClass("show")||n.hasClass("hide")?i(e):e?n.addClass("show"):n.addClass("hide"))});var i=function(t){n.removeClass("show"),n.removeClass("hide"),t?(n.addClass("show-start"),e(function(){n.addClass("show-active"),e(function(){n.addClass("show"),n.removeClass("show-active"),n.removeClass("show-start")},225)},250)):(n.addClass("hide-start"),n.addClass("hide-active"),e(function(){n.addClass("hide"),n.removeClass("hide-active"),n.removeClass("hide-start")},225))}}}])}(),function(){angular.module("appModule").filter("fixedLength",function(){return function(e,t){return(1e4+""+e).slice(-t)}})}(),function(){angular.module("appModule").directive("input",["focusService",function(e){return{restrict:"E",link:e.focus}}]),angular.module("appModule").service("focusService",function(){this.focus=function(e,t,n){t.bind("keypress",function(e){if(13===(e.keyCode||e.which)){e.preventDefault();for(var t=document.querySelectorAll("input, select, button"),n=e.srcElement,a=!1,i=t.length,o=0;o<i;o++){var r=t[o];if(a){if("none"!==r.style.display&&!1===r.disabled){r.focus();break}}else r===n&&(a=!0)}}})}})}(),angular.module("appModule").directive("grid",["gridService",function(e){return{restrict:"A",link:e.grid}}]),angular.module("appModule").service("gridService",function(){this.grid=function(e,t,n){var a={x:12,y:12},i=angular.fromJson(n.grid),o=i.x,r=i.y,c=i.w,u=i.h,s=i.color;t.css("position","absolute"),t.css("display","block"),t.css("width",c/a.x*100+"%"),t.css("height",u/a.y*100+"%"),t.css("left",o/a.x*100+"%"),t.css("top",r/a.y*100+"%"),t.css("background-color",s)}}),function(){angular.module("appModule").directive("smartInput",function(){function e(e,t){if(null!==e)if(e.createTextRange){var n=e.createTextRange();n.move("character",t),n.select()}else e.setSelectionRange?(e.setSelectionRange(t,t),e.focus()):e.focus()}return{require:"?ngModel",
restrict:"A",link:function(t,n,a,i){n.bind("focus",function(){try{this.selectionStart=0,this.selectionEnd=this.value.length+1}catch(e){this.select()}}),n.bind("blur",function(){o()}),i.$parsers.push(function(t){var o=n.val(),r=a.smartInput;if(void 0!==r&&""!==r||(r="text"),"decimal"===r||"integer"===r){for(;"0"===o.charAt(0);)o=o.substr(1);var c;"decimal"===r?(o=o.replace(/[^\d.\',']/g,""),c=parseInt(a.decimalPrecision),isNaN(c)&&(c=2)):"integer"===r&&(o=o.replace(/[^\d\',']/g,""),c=-1);var u=o.indexOf(".");u>=0&&(o=o.slice(0,u+1+c));var s=o.split("."),l=s[0],d=s[1];if(l=l.replace(/[^\d]/g,""),l.length>3)for(var m=Math.floor(l.length/3);m>0;){var p=l.indexOf(",");p<0&&(p=l.length),p-3>0&&(l=l.slice(0,p-3)+","+l.slice(p-3)),m--}d=void 0===d?"":"."+d;var f=l+d;f!==t&&(i.$setViewValue(f),i.$render());var h=parseFloat(f.replace(/[\',']/g,""));return isNaN(h)?0:h}if("date"===r){for(;"0"===o.charAt(0);)o=o.substr(1);o=o.replace(/[^\d\'#'\-]/g,""),console.log(o+"---");var g=o.split("-"),v=g[0],y=g[1],D=g[2];console.log(v+"+"+y+"+"+D);var b=-1;void 0===v?(v="#".repeat(4),b=0):(v=v.replace(/[^\d]/g,""),b=v.length,v=v.substr(0,4),v+="#".repeat(4-v.length)),void 0===y?(y="#".repeat(2),b=4===b?5:b):(y=y.replace(/[^\d]/g,""),parseInt(y)>12&&(y=""),b=4===b?5+y.length:b,y=y.substr(0,2),y+="#".repeat(2-y.length)),void 0===D?(D="#".repeat(2),b=7===b?8:b):(D=D.replace(/[^\d]/g,""),D>new Date(parseInt(v),parseInt(y),0).getDate()&&(D=""),b=7===b?8+D.length:b,D=D.substr(0,2),D+="#".repeat(2-D.length));var f=v+"-"+y+"-"+D;return f!==o&&(i.$setViewValue(f),i.$render(),e(n[0],b)),f.indexOf("#")>0?null:new Date(f)}});var o=function(){var e=n.val(),t=a.smartInput;if(void 0!==t&&""!==t||(t="text"),"decimal"===t){var i=parseInt(a.inputDecimal);isNaN(i)&&(i=2);var o=e.split("."),r=o[0],c=o[1];void 0!==r&&""!==r||(r="0"),void 0===c?c="0".repeat(i):c+="0".repeat(i-c.length),n.val(r+"."+c)}else"integer"===t?(void 0!==e&&""!==e||(e="0"),n.val(e)):"date"===t&&(void 0!==e&&""!==e||(e="####-##-##"),n.val(e))};n.ready(function(){o()})}}})}(),function(){angular.module("appModule").directive("inputHint",["InputHintService","$document","$compile",function(e,t,n){return{restrict:"A",scope:!0,link:e.inputHint}}]),angular.module("appModule").service("InputHintService",["$document","$compile",function(e,t){this.inputHint=function(n,a,i){var o=t('<div ng-class="tipClass">{{ text }}<div class="input-hint-arrow"></div></div>')(n);n.tipClass=["input-hint"],n.text=i.inputHint,i.tooltipPosition?n.tipClass.push("input-hint-"+i.tooltipPosition):n.tipClass.push("input-hint-down"),i.$set("placeholder",n.text),e.find("body").append(o),a.bind("focus",function(e){o.addClass("input-hint-show"),o=angular.element(o);var t=e.target.getBoundingClientRect(),n={},a=o[0].offsetHeight,i=o[0].offsetWidth,r=t.width||t.right-t.left,c=t.height||t.bottom-t.top;o.hasClass("input-hint-down")?(n.top=t.top+c+5,n.left=t.left-i/2+r/2):(n.top=t.top-a-5,n.left=t.left-i/2+r/2),o.css({top:n.top+"px",left:n.left+"px"})}),a.bind("blur",function(e){o.removeClass("input-hint-show")})}}])}(),function(){angular.module("appModule").service("ModalDialog",["$uibModal",function(e){this.showModel=function(t,n,a){e.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:n,controller:a,size:t})},this.modalOpen=function(e,t,n){return this.showModel(e,t,n)}}])}(),angular.module("appModule").directive("rangeSpinner",function(){return{restrict:"AE",scope:{rangeMin:"@",rangeStep:"@",rangeMax:"@",rangeDefaultValue:"@",acceptDecimal:"@",rangeModel:"=",nameOfField:"@",idOfField:"@",rangeDecimalPrecision:"@"},templateUrl:"tmpl/rangeSpinner.html",controller:["$scope","$element","$attrs",function(e,t,n){if(e.minRange=+(angular.isDefined(n.rangeMin)?n.rangeMin:0),e.step=+(angular.isDefined(n.rangeStep)?n.rangeStep:0),e.maxRange=+(angular.isDefined(n.rangeMax)?n.rangeMax:100),e.rangeDecPrec=+(angular.isDefined(n.rangeDecimalPrecision)?n.rangeDecimalPrecision:1),angular.isDefined(e.rangeDefaultValue)&&!isNaN(e.rangeDefaultValue)){var a=parseFloat(e.rangeDefaultValue);a>=e.minRange&&a<=e.maxRange?e.rangeModel=parseFloat(e.rangeDefaultValue).toFixed(e.rangeDecPrec):e.rangeModel=parseFloat(e.minRange).toFixed(e.rangeDecPrec)}e.rangePlusFunc=function(){angular.isUndefined(e.rangeModel)||isNaN(e.rangeModel)||""===e.rangeModel?e.rangeModel=e.minRange:e.rangeModel<e.maxRange&&("true"==e.acceptDecimal?e.rangeModel=parseFloat(parseFloat(e.rangeModel)+parseFloat(e.step)).toFixed(e.rangeDecPrec):e.rangeModel=parseInt(parseInt(e.rangeModel)+parseInt(e.step)))},e.rangeMinusFunc=function(){angular.isUndefined(e.rangeModel)||isNaN(e.rangeModel)||""===e.rangeModel?e.rangeModel=e.minRange:e.rangeModel>e.minRange&&("true"==e.acceptDecimal?e.rangeModel=parseFloat(parseFloat(e.rangeModel)-parseFloat(e.step)).toFixed(e.rangeDecPrec):e.rangeModel=parseInt(parseInt(e.rangeModel)-parseInt(e.step)))},e.$watch(function(){return e.rangeModel},function(t,n){if(angular.isDefined(e.rangeModel))if(isNaN(e.rangeModel))e.rangeModel=n;else if(e.rangeModel>e.maxRange)e.rangeModel=e.maxRange;else if(e.rangeModel<e.minRange)e.rangeModel=e.minRange;else if("true"==e.acceptDecimal){var a=String(e.rangeModel).split(".");a.length>1&&a[1].length>e.rangeDecPrec&&(e.rangeModel=parseFloat(e.rangeModel).toFixed(e.rangeDecPrec))}else e.rangeModel=parseInt(e.rangeModel)},!0)}]}}).run(["$templateCache",function(e){e.put("tmpl/rangeSpinner.html",'<div class="input-group" style="width: 80px;">                         <span class="input-group-btn"> \t\t\t\t<button class="btn btn-primary" type="button" ng-click="rangeMinusFunc()" style="background: #9DA5BE !important;color: white! important;font-weight:700;">-</button> \t\t\t</span>                                 <input class="form-control" style="width: 50px;margin-top: 7px;font-weight:700;text-align: center;" name="{{nameOfField}}" id="{{idOfField}}" type="text" range-min="{{rangeMin}}" range-step="{{rangeStep}}" range-max="{{rangeMax}}" ng-model="rangeModel" required read-only/>  \t\t\t<span class="input-group-btn">                                 <button class="btn btn-primary" type="button" ng-click="rangePlusFunc()" style="background: #9DA5BE !important;color: white! important;font-weight:700;">+</button>\t\t\t</span> \t\t\t</div>')}]),function(){angular.module("appModule").service("optionPane",["$uibModal",function(e){var t=function(e,t,n){function a(a,i){switch(this.modalInstance=a,this.timeout=i,this.message=t,this.title=n,e){case"primary":this.optionPaneClass="option-pane-primary",this.optionPaneIcon="glyphicon glyphicon-tag",this.title=void 0===this.title?"Message":this.title;break;case"info":this.optionPaneClass="option-pane-info",this.optionPaneIcon="glyphicon-bell",this.title=void 0===this.title?"Information":this.title;break;case"success":this.optionPaneClass="option-pane-success",this.optionPaneIcon="glyphicon-ok",this.title=void 0===this.title?"Success":this.title;break;case"warning":this.optionPaneClass="option-pane-warning",this.optionPaneIcon="glyphicon-warning-sign",this.title=void 0===this.title?"Warning":this.title;break;case"danger":this.optionPaneClass="option-pane-danger",this.optionPaneIcon="glyphicon-remove",this.title=void 0===this.title?"Danger":this.title;break;default:this.optionPaneClass="option-pane-default",this.optionPaneIcon="glyphicon-bell",this.title=void 0===this.title?"Note":this.title}}return a.prototype={continue:function(){var e=this;this.timeout(function(){e.modalInstance.close()},250)}},["$uibModalInstance","$timeout",a]};this.message=function(n,a,i){e.open({animation:!0,backdrop:"static",ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"./app/util/option-pane/option-pane.html",controller:t(n,a,i),controllerAs:"$ctrl",size:"md"})},this.primaryMessage=function(e,t){this.message("primary",e,t)},this.infoMessage=function(e,t){this.message("info",e,t)},this.successMessage=function(e,t){this.message("success",e,t)},this.warningMessage=function(e,t){this.message("warning",e,t)},this.dangerMessage=function(e,t){this.message("danger",e,t)},this.defaultMessage=function(e,t){this.message("default",e,t)}}])}(),function(){angular.module("appModule").filter("unique",function(){return function(e,t){var n=[],a=[];return angular.forEach(e,function(e){var i=e[t];-1===a.indexOf(i)&&(a.push(i),n.push(e))}),n}})}(),function(){angular.module("appModule").run(["$rootScope","$location","$route","$timeout",function(e,t,n,a){e.config={},e.config.app_url=t.url(),e.config.app_path=t.path(),e.layout={},e.layout.loading=!1,e.$on("$routeChangeStart",function(t,n,i){n&&"/login"!==n.$$route.originalPath&&i&&"/login"!==i.$$route.originalPath&&a(function(){e.layout.loading=!0})}),e.$on("$routeChangeSuccess",function(){a(function(){e.layout.loading=!1},700)}),e.$on("$routeChangeError",function(){e.layout.loading=!1})}])}(),function(){angular.module("appModule").factory("XSRFInterceptor",["$cookies","$log",function(e,t){return{request:function(t){var n=e.get("XSRF-TOKEN");return n&&(t.headers["X-XSRF-TOKEN"]=n),t}}}]),angular.module("appModule").config(["$httpProvider",function(e){e.defaults.headers.common["X-Requested-With"]="XMLHttpRequest",e.defaults.withCredentials=!0,e.interceptors.push("XSRFInterceptor")}]),angular.module("appModule").run(["$rootScope","$location","$cookies","SecurityService",function(e,t,n,a){e.$on("$routeChangeStart",function(e,n,i){a.ping().success(function(e,n,a){"/login"===t.path()&&t.path("/")}).error(function(e,n){t.path("/login")})})}])}(),function(){var e=function(e,t){this.login=function(n){var a=n?{authorization:"Basic "+btoa(n.username+":"+n.password)}:{};return t.get(e.apiUrl+"/security/login",{headers:a})},this.logout=function(){return t.get(e.apiUrl+"/security/logout")},this.ping=function(){var n={"X-Requested-With":"XMLHttpRequest","Access-Control-Allow-Origin":"*"};return t.get(e.apiUrl+"/api/v1/system/environment/ping",{headers:n})}};e.$inject=["systemConfig","$http"],angular.module("appModule").service("SecurityService",e)}(),function(){angular.module("grnApproveModule",["ui.bootstrap"]),angular.module("grnApproveModule").controller("grnApproveController",["$scope","GrnApproveModel","$timeout","$filter","Notification","ConfirmPane",function(e,t,n,a,i,o){e.model=new t,e.ui={},e.ui.new=function(){e.ui.mode="NEW",e.model.data.approveDate=a("date")(new Date,"yyyy-MM-dd")},e.ui.selectGrn=function(t,n){e.model.selectGrn(t,n)},e.ui.edit=function(t){e.model.edit(t),console.log(t)},e.ui.addData=function(){e.model.addData()},e.ui.save=function(){var t=!0;e.model.userPermission.add||(t=!1,i.error("you have no permission !")),t&&o.primaryConfirm("Do you want to Approve this GRN !").confirm(function(){e.model.save(),e.ui.mode="IDEAL",e.chxNBT=!1,e.chxVAT=!1}).discard(function(){console.log("fail")})},e.ui.discard=function(){},e.ui.valueCalculater=function(t){e.model.tempData.value=parseFloat((t*e.model.tempData.qty).toFixed(2)),e.model.tempData.netValue=e.model.tempData.value.toFixed(2),e.model.tempData.discount=0,e.model.tempData.discountValue=0},e.ui.discountCalculator=function(){e.model.tempData.discountValue=(parseFloat(e.model.tempData.value)*parseFloat(e.model.tempData.discount)/100).toFixed(2),e.model.tempData.netValue=parseFloat(e.model.tempData.value)-parseFloat(e.model.tempData.discountValue)},e.ui.discountValueCalculator=function(){e.model.tempData.discount=parseFloat((100*e.model.tempData.discountValue/e.model.tempData.value).toFixed(2)),e.model.tempData.netValue=parseFloat(e.model.tempData.value)-parseFloat(e.model.tempData.discountValue)},e.ui.checkBoxNBTFunction=function(){e.chxNBT?e.model.data.nbt=2:e.model.data.nbt=0,e.ui.calculateNBT()},e.ui.checkBoxVATFunction=function(){e.chxVAT?e.model.data.vat=15:e.model.data.vat=0,e.ui.calculateVAT()},e.ui.calculateNBT=function(){e.model.data.nbtValue=parseFloat((e.model.data.amount*e.model.data.nbt/100).toFixed(2)),e.model.data.grandAmount=parseFloat(e.model.data.amount)+parseFloat(e.model.data.nbtValue),e.model.data.vatValue=null,e.model.data.vat=null,e.chxVAT=!1},e.ui.calculateVAT=function(){var t=e.model.data.nbtValue;e.model.data.nbtValue||(t=0),e.model.data.vatValue=parseFloat(((e.model.data.amount+t)*e.model.data.vat/100).toFixed(2)),e.model.data.grandAmount=(parseFloat(e.model.data.amount)+parseFloat(t)+parseFloat(e.model.data.vatValue)).toFixed(2)},e.init=function(){e.ui.mode="IDEAL",e.$watch("[model.mainList]",function(t,n){e.model.calculateMainListValue()},!0),e.$watch("[model.data.grnItemList]",function(t,n){e.model.calculateDataValue()},!0)},e.init()}])}(),function(){angular.module("appModule").factory("GrnApproveModel",["GrnService","grnModelFactory","$q","$timeout","Notification",function(e,t,n,a,i){function o(){this.constructor()}return o.prototype={data:{},tempData:{},summaryData:{},userPermission:{},suppliers:[],items:[],mainList:[],mainListValue:0,selectedGrnIndex:-1,approvedPurchaseOrderItemList:[],constructor:function(){var n=this;n.data=t.newData(),n.tempData=t.tempData(),n.summaryData=t.tempData(),e.loadSuppliers().success(function(e){n.suppliers=e}),e.loadItems().success(function(e){n.items=e}),this.loadPendingGrnList(),e.loadApprovedPurchaseOrderItemList().success(function(e){n.approvedPurchaseOrderItemList=e}),e.getPermission("Grn Approve").success(function(e){n.userPermission=e})},loadPendingGrnList:function(){var t=this;t.mainList=[],e.loadPendingGrnList().success(function(e){angular.forEach(e,function(e){var n=0;angular.forEach(e.grnItemList,function(e){n+=e.netValue}),e.grnAmount=n,t.mainList.push(e)})})},getSupplier:function(e){var t;return angular.forEach(this.suppliers,function(n){if(n.indexNo===e)return void(t=n.indexNo+" - "+n.name)}),t},getItemLabel:function(e){var t;return angular.forEach(this.items,function(n){if(n.indexNo===e)return void(t=n.barcode+" - "+n.name)}),t},getItem:function(e){var t,n=this;angular.forEach(n.approvedPurchaseOrderItemList,function(n){if(n.indexNo===e)return void(t=n.item)});var a;return angular.forEach(n.items,function(e){if(e.indexNo===t)return void(a=e)}),a},calculateMainListValue:function(){this.mainListValue=0;var e=0;angular.forEach(this.mainList,function(t){e+=t.grnAmount}),this.mainListValue=e},selectGrn:function(e,t){this.data=this.mainList[e],console.log(this.data.grnItemList),this.data.grandAmount=this.data.amount.toFixed(2),this.selectedGrnIndex=t},edit:function(e){this.tempData=this.data.grnItemList[e],this.tempData.item=this.getItem(this.tempData.purchaseOrderItem).indexNo,this.tempData.barcode=this.getItem(this.tempData.purchaseOrderItem).barcode,this.data.grnItemList.splice(e,1)},addData:function(){var e=this,n=!0;e.tempData.item||(n=!1,i.error("Empty Value.Can't be Added !")),e.tempData.qty||(n=!1,i.error("Quantity must be Greater Than 0. Can't be Added !")),e.tempData.price||(n=!1,i.error("Price must be Greater Than 0. Can't be Added !")),n&&(this.data.grnItemList.push(this.tempData),this.tempData=t.tempData())},calculateDataValue:function(){var e=0,t=0,n=0,a=0;angular.forEach(this.data.grnItemList,function(i){e+=i.qty,t+=i.value,n+=i.discountValue,a+=i.netValue}),this.summaryData.qty=parseFloat(e.toFixed(2)),this.summaryData.value=parseFloat(t.toFixed(2)),this.summaryData.discount=parseFloat(n.toFixed(2)),this.data.amount=parseFloat(a.toFixed(2))},save:function(){var t=this,a=!0;if(t.tempData.item&&(a=!1,i.error("Finish Edting Item for Approve Purchase Order !")),t.data.approveDate||(a=!1,i.error("Insert Approved Date for Approve Purchase Order !")),t.data.supplier||(a=!1,i.error("Can't be Approved this GRN without Supplier !")),(t.data.nbt>=3||t.data.nbt<=-1)&&(a=!1,i.error("NBT Out Of Range !")),a){this.data.grandTotal=this.data.grandAmount;var o=n.defer();return e.saveGrnApprove(JSON.stringify(this.data)).success(function(e){i.success("GRN Approved Success !"),t.clear(),o.resolve()}).error(function(e){i.error("GRN Approved Fail !"),o.reject()}),o.promise}},clear:function(){var e=this;e.data=t.newData(),e.tempData=t.tempData(),e.summaryData=t.tempData(),this.loadPendingGrnList(),this.selectedGrnIndex=-1}},o}])}(),function(){angular.module("directGrnModule",["ui.bootstrap"]),angular.module("directGrnModule").controller("directGrnController",["$scope","$timeout","$filter","directGrnModel","Notification","ConfirmPane",function(e,t,n,a,i,o){e.model=new a,e.ui={},e.ui.new=function(){e.ui.mode="NEW",e.ui.focus("#date"),e.model.data.date=n("date")(new Date,"yyyy-MM-dd")},e.ui.validateBarcode=function(t){13===(t?t.keyCode||t.which:13)&&(e.model.validateBarcode(e.model.tempData.barcode),e.model.tempData.item?e.ui.focus("#price"):(i.error("Item not found!"),e.ui.focus("#barcode")))},e.ui.calculatedValue=function(){e.model.tempData.value=e.model.tempData.qty*e.model.tempData.price,e.model.tempData.discountValue=0,e.model.tempData.discount=0,e.model.tempData.netValue=e.model.tempData.value},e.ui.calculateDiscountWithRate=function(){e.model.tempData.discountValue=e.model.tempData.value*e.model.tempData.discount/100,e.model.tempData.netValue=e.model.tempData.value-e.model.tempData.discountValue},e.ui.calculateDiscountWithValue=function(){e.model.tempData.discount=100*e.model.tempData.discountValue/e.model.tempData.value,e.model.tempData.netValue=e.model.tempData.value-e.model.tempData.discountValue},e.ui.callAddData=function(){13===(event?event.keyCode||event.which:13)&&e.ui.addData()},e.ui.checkBoxNBTFunction=function(){e.chxNBT?e.model.data.nbt=2:e.model.data.nbt=0,e.ui.calculateNBT()},e.ui.checkBoxVATFunction=function(){e.chxVAT?e.model.data.vat=15:e.model.data.vat=0,e.ui.calculateVAT(e.model.data.vat)},e.ui.calculateNBT=function(){e.model.data.nbtValue=e.model.data.amount*e.model.data.nbt/100,e.model.data.grandAmount=e.model.data.amount+e.model.data.nbtValue,e.model.data.vatValue=null,e.model.data.vat=null,e.chxVat=!1},e.ui.calculateVAT=function(t){var n=e.model.data.nbtValue;console.log("work"),e.model.data.nbtValue||(n=0),e.model.data.vatValue=(e.model.data.amount+n)*t/100,e.model.data.grandAmount=e.model.data.amount+n+e.model.data.vatValue,console.log(e.model.data.vat),console.log(t)},e.ui.edit=function(t){e.model.edit(t)},e.ui.delete=function(t){e.model.delete(t)},e.ui.addData=function(){e.model.addData(),e.ui.focus("#barcode")},e.ui.focus=function(e){t(function(){angular.element(document.querySelectorAll(e))[0].focus()},10)},e.ui.save=function(){var t=!0;e.model.userPermission.add||(t=!1,i.error("you have no permission !")),t&&o.primaryConfirm("Do you want to Save Direct GRN !").confirm(function(){e.model.saveDirectGrn().then(function(){e.ui.mode="IDEAL",i.success("Direct GRN Save Success !"),e.chxVat=!1,e.chxNbt=!1})}).discard(function(){i.error("Direct GRN Save Fail !"),console.log("fail")})},e.init=function(){e.ui.mode="IDEAL"},e.init()}])}(),function(){angular.module("appModule").factory("directGrnModel",["GrnService","grnModelFactory","$q","optionPane","Notification",function(e,t,n,a,i){function o(){this.constructor()}return o.prototype={data:{},tempData:{},summaryData:{},userPermission:{},items:[],suppliers:[],categoryIndex:null,brandIndex:null,constructor:function(){var n=this;n.data=t.newData(),n.tempData=t.tempData(),n.summaryData=t.summaryData(),e.loadItems().success(function(e){n.items=e}),e.loadSuppliers().success(function(e){n.suppliers=e}),e.getPermission("Grn Direct").success(function(e){n.userPermission=e})},itemLable:function(e){var t,n=this;return angular.forEach(this.items,function(a){if(a.indexNo===e)return t=a.barcode+" - "+a.name,void n.getStockQty(a)}),t},getStockQty:function(t){e.getStockQty(t.indexNo).success(function(e){this.tempData.stockQty=e,console.log(this.tempData.stockQty)})},supplierLable:function(e){var t,n=this;return angular.forEach(this.suppliers,function(a){if(a.indexNo===e)return t=a.indexNo+" - "+a.name,void n.getCreditPeriod(a)}),t},getCreditPeriod:function(e){this.data.creditPeriod=e.creditPeriod},validateBarcode:function(e){var t=null;angular.forEach(this.items,function(n){if(n.barcode===e)return void(t=n)}),t?(this.tempData.item=t.indexNo,this.tempData.price=t.costPrice):this.tempData.item=null},addData:function(){var e=this,n=!0;e.tempData.item||(n=!1,i.error("Select Item for Add Purchase Order Item !")),e.tempData.price||(n=!1,i.error("Select price for Add Purchase Order Item !")),e.tempData.qty||(n=!1,i.error("Select Qty for Add Purchase Order Item !")),e.tempData.netValue||(n=!1,i.error("Invalide Format")),n&&(this.data.grnItemList.push(this.tempData),this.tempData=t.tempData(),this.summaryCalculator())},getItemName:function(e){var t=null;return angular.forEach(this.items,function(n){if(n.indexNo===e)return void(t=n.name)}),t},summaryCalculator:function(){var e=0,t=0,n=0,a=0;angular.forEach(this.data.grnItemList,function(i){e=parseFloat(e)+parseFloat(i.qty),t=parseFloat(t)+parseFloat(i.value),n=parseFloat(n)+parseFloat(i.discountValue),a=parseFloat(a)+parseFloat(i.netValue)}),this.summaryData.qty=e,this.summaryData.value=t,this.summaryData.discountValue=n,this.data.amount=a,this.data.grandAmount=a},edit:function(e){this.tempData=this.data.grnItemList[e],this.data.grnItemList.splice(e,1),this.summaryCalculator()},delete:function(e){this.data.grnItemList.splice(e,1),this.summaryCalculator()},saveDirectGrn:function(){console.log(this.data);var t=n.defer(),a=this,o=!0;if(a.data.supplier||(o=!1,i.error("Select Supplier for Save GRN !")),a.data.date||(o=!1,i.error("Select Date for Save GRN !")),0===a.data.grnItemList.length&&(o=!1,i.error("Add GRN Item for Save GRN !")),a.tempData.netValue&&(o=!1,i.error("Remove Editing Item for save GRN !")),a.tempData.item&&(o=!1,i.error("Remove Editing Item for save GRN !")),o)return console.log(this.data),e.saveDirectGrn(JSON.stringify(this.data)).success(function(e){a.clear(),t.resolve()}).error(function(e){t.reject()}),t.promise},clear:function(){this.data=t.newData(),this.tempData=t.tempData(),this.summaryData=t.summaryData()}},o}])}(),function(){angular.module("grnModule",["ui.bootstrap"]),angular.module("grnModule").controller("grnController",["$scope","$timeout","$uibModal","$sce","$filter","GrnModel","Notification","GrnService","ConfirmPane",function(e,t,n,a,i,o,r,c,u){e.model=new o,e.ui={},e.filterList=[],e.printModel={},e.printModel.currentReportGroup={},e.printModel.currentReport={report:null,parameters:null,parameterValues:{}},e.ui.new=function(){e.ui.mode="NEW",e.model.data.date=i("date")(new Date,"yyyy-MM-dd")},e.ui.selectPurchaseOrder=function(t,n){e.model.selectPurchaseOrder(t,n)},e.ui.select=function(t){e.model.select(t)},e.ui.editItemQty=function(t){e.model.editItemQty(t)},e.ui.addData=function(){e.model.addData()},e.ui.save=function(){var t=!0;e.model.userPermission.add||(t=!1,r.error("you have no permission !")),t&&u.primaryConfirm("Do you want to save GRN Receive !").confirm(function(){e.model.save().then(function(t){u.successConfirm("Do You Want To Print grn request note !").confirm(function(){e.ui.modalOpen(t)})})}).discard(function(){})},e.ui.deleteItem=function(t){console.log("deleteItem"),e.model.deleteItem(t)},e.ui.discard=function(){e.model.discard()},e.ui.changeSupplier=function(){e.model.changeSupplier(),e.ui.mode="IDEAL"},e.init=function(){e.ui.mode="IDEAL",e.$watch("model.purchaseOrderItemList",function(){e.model.itemTotal()})},e.ui.modalOpen=function(t){c.reportData("GRN_NOTE").success(function(i){e.printModel.currentReport.report=i,c.listParameters(i).success(function(t){e.printModel.currentReport.parameters=t}),e.printModel.currentReport.parameterValues.GRN_NO=t,c.viewReport(e.printModel.currentReport.report,e.printModel.currentReport.parameters,e.printModel.currentReport.parameterValues).success(function(t){var i=new Blob([t],{type:"application/pdf"}),o=URL.createObjectURL(i);e.content=a.trustAsResourceUrl(o),n.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"grn_recieve_popup.html",scope:e,size:"lg"})})})},e.init()}])}(),function(){angular.module("appModule").factory("GrnModel",["GrnService","grnModelFactory","$q","$timeout","Notification",function(e,t,n,a,i){function o(){this.constructor()}return o.prototype={data:{},tempData:{},userPermission:{},pendingPurchaseOrderList:[],purchaseOrderItemList:[],suppliers:[],items:[],grandTotalValue:0,itemTotalQty:0,itemTotalCount:0,selectedDetailIndex:-1,selectedPONumber:-1,totalGrnQty:0,approvedPurchaseOrderList:[],constructor:function(){var n=this;n.data=t.newData(),n.tempData=t.tempData(),this.loadApprovedPurchaseOrder(),e.loadSuppliers().success(function(e){n.suppliers=e}),e.loadItems().success(function(e){n.Items=e}),e.loadApprovedPurchaseOrder().success(function(e){n.approvedPurchaseOrderList=e}),this.getPendingOrderTotalAmount(),e.getPermission("Grn Request").success(function(e){n.userPermission=e})},getSupplier:function(e){var t;return angular.forEach(this.suppliers,function(n){if(n.indexNo===e)return void(t=n.indexNo+" - "+n.name)}),t},getItemObject:function(e){var t;return angular.forEach(this.Items,function(n){if(n.indexNo===e)return void(t=n)}),t},getPurchaseOrderItem:function(e){var t;return angular.forEach(this.purchaseOrderItemList,function(n){if(n.indexNo===e)return void(t=n)}),t},getItemLable:function(e){var t;return angular.forEach(this.Items,function(n){if(n.indexNo===e)return void(t=n.barcode+" - "+n.name)}),t},getPendingOrderTotalAmount:function(){var e=0;angular.forEach(this.pendingPurchaseOrderList,function(t){e+=parseFloat(t.grandTotal)}),this.PendingOrderTotalAmount=e},loadApprovedPurchaseOrder:function(){var t=this;e.loadApprovedPurchaseOrder().success(function(e){t.pendingPurchaseOrderList=e,angular.forEach(e,function(e){t.grandTotalValue+=parseFloat(e.grandTotal)})})},selectPurchaseOrder:function(e,t){var n=this;n.purchaseOrderItemList=[],this.selectedDetailIndex=e,this.selectedPONumber=t,angular.forEach(n.pendingPurchaseOrderList,function(t){e===t.indexNo&&(n.purchaseOrderItemList=t.purchaseOrderItemList,n.data.deliverDate=t.deliverDate,n.data.requestDate=t.date,n.data.approvedDate=t.approvedDate,n.data.supplier=t.supplier)}),angular.forEach(n.suppliers,function(e){if(n.data.supplier===e.indexNo)return void(n.data.creditPeriod=e.creditPeriod)})},select:function(e){var t=-1;angular.forEach(this.purchaseOrderItemList,function(n,a){e===n.indexNo&&(t=a)});var n=this.purchaseOrderItemList[t];n.purchaseOrderItem=n.indexNo,n.selectedPONumber=this.selectedPONumber,n.receiveQty=n.balanceQty,n.qty=n.balanceQty,n.value=n.receiveQty*n.price,n.discountValue=n.value*n.discount/100,n.netValue=n.value-n.discountValue,this.data.amount+=n.netValue,this.data.grnItemList.push(n),this.purchaseOrderItemList.splice(t,1),this.grnQtyCount()},editItemQty:function(e){var t=!0;if(this.tempData.item&&(t=!1,i.error("Already Select Edit Item..")),t){var n=-1;angular.forEach(this.purchaseOrderItemList,function(t,a){e===t.indexNo&&(n=a)});var a=this.purchaseOrderItemList[n];a.purchaseOrderItem=a.indexNo,a.selectedPONumber=this.selectedPONumber,a.receiveQty=a.balanceQty,a.barcode=this.getItemObject(a.item).barcode,this.tempData=a,this.purchaseOrderItemList.splice(n,1)}},addData:function(){var e=this,t=!0;e.tempData.item||(t=!1,i.error("Empty Value.Can't be Added !")),e.tempData.receiveQty||(t=!1,i.error("Quantity must be Greater Than 0. Can't be Added !")),e.tempData.receiveQty>e.tempData.orderQty&&(t=!1,i.error("Quantity Out of Range ! Max Quantity "+e.tempData.balanceQty)),t&&(this.data.amount+=this.tempData.netValue,this.tempData.qty=this.tempData.receiveQty,this.tempData.value=this.tempData.qty*this.tempData.price,this.tempData.netValue=this.tempData.value,this.tempData.discount=0,this.tempData.discountValue=0,this.data.grnItemList.push(this.tempData),this.tempData={},this.grnQtyCount())},save:function(){var t=this,a=!0;if(t.data.supplier||(a=!1,i.error("Select Supplier for Save GRN Receive !")),t.tempData.item&&(a=!1,i.error("Finish Edting Item for Save GRN Receive !")),!t.data.grnItemList.length>0&&(a=!1,i.error("Add GRN Item for Save GRN Receive !")),a){var o=n.defer();return this.data.grandAmount=this.data.amount,e.saveGrnReceive(JSON.stringify(this.data)).success(function(e){i.success("GRN Receive Save Success !"),t.clear(),o.resolve(e)}).error(function(e){i.error("GRN Receive Save Fail !"),o.reject(e)}),o.promise}},clear:function(){this.purchaseOrderItemList=[],this.grandTotalValue=0,this.itemTotalQty=0,this.selectedDetailIndex=-1,this.selectedPONumber=-1,this.data=t.newData(),this.tempData=t.tempData(),this.totalGrnQty=0,this.loadApprovedPurchaseOrder()},deleteItem:function(e){this.purchaseOrderItemList.push(this.data.grnItemList[e]),this.data.grnItemList.splice(e,1),this.grnQtyCount()},grnQtyCount:function(){var e=0;angular.forEach(this.data.grnItemList,function(t){e+=parseFloat(t.qty)}),this.totalGrnQty=e},itemTotal:function(){var e=this;e.itemTotalQty=0,e.itemTotalCount=0,angular.forEach(e.purchaseOrderItemList,function(t){"APPROVED"===t.status&&(e.itemTotalQty+=t.balanceQty,e.itemTotalCount++)})},orderLengthCheck:function(e){var t=!1;return angular.forEach(e,function(e){if("APPROVED"===e.status&&e.balanceQty>0)return void(t=!0)}),t},changeSupplier:function(){console.log("change supplier"),this.purchaseOrderItemList=[],this.grandTotalValue=0,this.itemTotalQty=0,this.selectedDetailIndex=-1,this.selectedPONumber=-1,this.data.grnItemList=[],this.tempData=t.tempData(),this.totalGrnQty=0,this.loadApprovedPurchaseOrder(),this.itemTotalCount=0,this.totalGrnQty=0}},o}])}(),function(){angular.module("purchaseOrderApproveModule",["ui.bootstrap"]),angular.module("purchaseOrderApproveModule").controller("purchaseOrderApproveController",["$scope","$filter","$uibModal","$sce","$timeout","purchaseOrderApproveModel","PurchaseOrderRequestService","Notification","ConfirmPane",function(e,t,n,a,i,o,r,c,u){e.model=new o,e.ui={},e.ui.selectedDetailIndex=-1,e.printModel={},e.printModel.currentReportGroup={},e.printModel.currentReport={report:null,parameters:null,parameterValues:{}},e.ui.selectPurchaseOrder=function(n){e.model.selectPurchaseOrder(n),e.model.data.vat?e.chxVAT=!0:e.chxVAT=!1,e.model.data.nbt?e.chxNBT=!0:e.chxNBT=!1,e.ui.selectedDetailIndex=n.indexNo,e.model.data.approvedDate=t("date")(new Date,"yyyy-MM-dd"),e.ui.focus("#approvedDate")},e.ui.focus=function(e){i(function(){angular.element(document.querySelectorAll(e))[0].focus()},10)},e.ui.delete=function(t){e.model.delete(t),0===e.model.data.purchaseOrderItemList.length&&(e.model.tempData.netValue||(e.chxNBT=!1,e.chxVAT=!1,e.model.data.nbt=0,e.model.data.vat=0))},e.ui.discard=function(){e.model.data.indexNo?u.dangerConfirm("Delete Selected Purchase Order !").confirm(function(){e.model.discard(),e.chxNBT=!1,e.chxVAT=!1}).discard(function(){console.log("discard fail")}):c.error("Please Select Porchase Order to Delete !")},e.ui.edit=function(t){e.model.edit(t),0===e.model.data.purchaseOrderItemList.length&&(e.model.tempData.netValue||(e.chxNBT=!1,e.chxVAT=!1,e.model.data.nbt=0,e.model.data.vat=0))},e.ui.addData=function(){e.model.addData()},e.ui.checkBoxNBTFunction=function(){console.log("checkBoxNBTFunction"),e.chxNBT?e.model.data.nbt=2:e.model.data.nbt=0,e.ui.calculateNBT()},e.ui.checkBoxVATFunction=function(){console.log("checkBoxVATFunction"),e.chxVAT?e.model.data.vat=15:e.model.data.vat=0,e.ui.calculateVAT(e.model.data.vat)},e.ui.calculateNBT=function(){e.model.data.nbtValue=(e.model.data.itemValue*e.model.data.nbt/100).toFixed(2),e.model.data.grandTotal=parseFloat(e.model.data.itemValue)+parseFloat(e.model.data.nbtValue),e.model.data.vatValue=0,e.model.data.vat=0},e.ui.calculateVAT=function(t){var n=e.model.data.nbtValue;e.model.data.nbtValue||(n=0),e.model.data.vatValue=((parseFloat(e.model.data.itemValue)+parseFloat(n))*parseFloat(t)/100).toFixed(2),e.model.data.grandTotal=parseFloat(e.model.data.itemValue)+parseFloat(n)+parseFloat(e.model.data.vatValue)},e.ui.calculatedValue=function(){e.model.tempData.value=(e.model.tempData.qty*e.model.tempData.price).toFixed(2),e.model.tempData.discountValue=0,e.model.tempData.discount=0,e.model.tempData.netValue=e.model.tempData.value},
e.ui.calculateDiscountWithRate=function(){e.model.tempData.discountValue=(e.model.tempData.value*e.model.tempData.discount/100).toFixed(2),e.model.tempData.netValue=parseFloat(e.model.tempData.value)-parseFloat(e.model.tempData.discountValue)},e.ui.calculateDiscountWithValue=function(){e.model.tempData.discount=(100*e.model.tempData.discountValue/e.model.tempData.value).toFixed(2),e.model.tempData.netValue=parseFloat(e.model.tempData.value)-parseFloat(e.model.tempData.discountValue)},e.ui.priceChange=function(){e.model.tempData.qty?(e.model.tempData.value=(e.model.tempData.qty*e.model.tempData.price).toFixed(2),e.model.tempData.netValue=e.model.tempData.value):e.model.tempData.value=0,e.model.tempData.discountValue=0,e.model.tempData.discount=0},e.ui.callAddData=function(){13===(event?event.keyCode||event.which:13)&&e.ui.addData()},e.ui.save=function(){var t=!0;e.model.userPermission.add||(t=!1,c.error("you have no permission !")),t&&u.primaryConfirm("Save Purchase Order Request !").confirm(function(){e.model.save().then(function(t){e.ui.mode="NEW",c.success(t.number+" Purchase Order Approved !"),e.chxNBT=!1,e.chxVAT=!1,u.successConfirm("Do You Want To Print Purchase Order !").confirm(function(){e.ui.modalOpen(t.indexNo)})})}).discard(function(){c.error("Purchase Order Approved Fail !")})},e.ui.modalOpen=function(t){r.reportData("Purchase_Order").success(function(i){e.printModel.currentReport.report=i,r.listParameters(i).success(function(t){e.printModel.currentReport.parameters=t}),e.printModel.currentReport.parameterValues.PO_NO=t,r.viewReport(e.printModel.currentReport.report,e.printModel.currentReport.parameters,e.printModel.currentReport.parameterValues).success(function(t){var i=new Blob([t],{type:"application/pdf"}),o=URL.createObjectURL(i);e.content=a.trustAsResourceUrl(o),n.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"purchase_order_popup.html",scope:e,size:"lg"})})})},e.init=function(){e.ui.mode="NEW"},e.init()}])}(),function(){angular.module("appModule").factory("purchaseOrderApproveModel",["PurchaseOrderRequestService","Notification","PurchaseOrderRequestModelFactory","$q",function(e,t,n,a){function i(){this.constructor()}return i.prototype={data:{},tempData:{},summaryData:{},userPermission:{},pendingPurchaseOrderList:[],suppliers:[],allItems:[],grandTotalValue:0,constructor:function(){var t=this;this.data=n.newData(),this.tempData=n.tempData(),this.summaryData=n.summaryData(),this.loadPendingPurchaseOrder(),e.loadSuppliers().success(function(e){t.suppliers=e}),e.loadItems().success(function(e){t.allItems=e}),e.getPermission("Purchase Order Approve").success(function(e){t.userPermission=e})},getSupplier:function(e){var t;return angular.forEach(this.suppliers,function(n){if(n.indexNo===e)return void(t=n.indexNo+" - "+n.name)}),t},getItem:function(e){var t;return angular.forEach(this.allItems,function(n){if(n.indexNo===e)return void(t=n)}),t},itemLable:function(e){var t;return angular.forEach(this.allItems,function(n){if(n.indexNo===e)return void(t=n.barcode+" - "+n.name)}),t},calculatePendingGrandTotal:function(){return angular.forEach(this.pendingPurchaseOrderList,function(e){e+=parseFloat(e.grandTotal2)}),0},loadPendingPurchaseOrder:function(){var t=this;t.grandTotalValue=0,e.loadPendingPurchaseOrder().success(function(e){angular.forEach(e,function(e){t.grandTotalValue+=parseFloat(e.grandTotal),e.grandTotal2=e.grandTotal}),t.pendingPurchaseOrderList=e})},selectPurchaseOrder:function(e){var t=e;this.data=t,this.summaryCalculator()},summaryCalculator:function(){var e=this,t=0,n=0,a=0,i=0;angular.forEach(e.data.purchaseOrderItemList,function(e){t=parseFloat(t)+parseFloat(e.qty),n=parseFloat(n)+parseFloat(e.value),a=parseFloat(a)+parseFloat(e.discountValue),i=parseFloat(i)+parseFloat(e.netValue)}),this.summaryData.qty=t,this.summaryData.value=n,this.summaryData.discountValue=a,this.data.itemValue=i.toFixed(2),this.data.nbt&&(this.data.nbtValue=(this.data.itemValue*this.data.nbt/100).toFixed(2)),this.data.vat&&(this.data.vatValue=((this.data.itemValue+this.data.nbtValue)*this.data.vat/100).toFixed(2)),e.data.grandTotal=(i+this.data.nbtValue+this.data.vatValue).toFixed(2)},save:function(){var n=a.defer(),i=this,o=!0;if(i.data.supplier||(o=!1,t.error("Select Supplier for Approve Purchase Order !")),i.data.date||(o=!1,t.error("Select Date for Save Approve Order !")),i.data.approvedDate||(o=!1,t.error("Select Date for Approve Purchase Order !")),i.data.deliverDate||(o=!1,t.error("Select DeliverDate for Approve Purchase Order !")),0===i.data.purchaseOrderItemList.length&&(o=!1,t.error("Add Purchase Order Item for Save Purchase Order !")),o){var i=this;return this.data.grandAmount=this.data.grandTotal,e.savePurchaseOrderApprove(JSON.stringify(this.data)).success(function(e){i.clear(),n.resolve(e)}).error(function(e){n.reject(e)}),n.promise}},delete:function(e){this.data.purchaseOrderItemList.splice(e,1),this.summaryCalculator()},edit:function(e){this.tempData=this.data.purchaseOrderItemList[e],this.data.purchaseOrderItemList.splice(e,1),this.tempData.barcode=this.getItem(this.tempData.item).barcode,this.summaryCalculator()},discard:function(){var n=this;e.deletePurchaseOrder(this.data.indexNo).success(function(e){t.success("Selected Pending Purchase Order Deleted Success !"),n.clear()})},addData:function(){var e=this,n=!0;e.tempData.item||(n=!1,t.error("select item !")),e.tempData.price||(n=!1,t.error("add price !")),e.tempData.qty||(n=!1,t.error("add quantity !")),n&&(this.data.purchaseOrderItemList.unshift(this.tempData),this.tempData={},this.summaryCalculator())},clear:function(){this.data=n.newData(),this.tempData=n.tempData(),this.summaryData=n.summaryData(),this.loadPendingPurchaseOrder()}},i}])}(),function(){angular.module("purchaseOrderRequestModule",["ui.bootstrap"]),angular.module("purchaseOrderRequestModule").controller("purchaseOrderRequestController",["$scope","$rootScope","$uibModal","$uibModalStack","$filter","$timeout","purchaseOrderRequestModel","Notification","ConfirmPane","ModalDialog","optionPane",function(e,t,n,a,i,o,r,c,u,s,l){e.model=new r,e.ui={},e.selectedIndex=-1,e.ui.new=function(){e.ui.mode="NEW",e.model.clear(),e.chxNBT=!1,e.chxVAT=!1,e.model.data.date=i("date")(new Date,"yyyy-MM-dd"),e.model.data.deliverDate=i("date")(new Date,"yyyy-MM-dd"),e.ui.focus("#date")},e.ui.edit=function(t){e.model.edit(t)},e.ui.removeAll=function(){u.primaryConfirm("Do you want to remove all !").confirm(function(){e.model.removeAll(),e.ui.mode="IDEAL"})},e.ui.selectRequiredItems=function(){e.model.selectRequiredItems()},e.ui.delete=function(t){e.model.delete(t)},e.ui.loadPendingPurchaseOrderByNumber=function(t){13===(t?t.keyCode||t.which:13)&&(e.model.loadPendingPurchaseOrderByNumber(),o(function(){e.chxVAT=!!e.model.data.vat,e.chxNBT=!!e.model.data.nbt},100))},e.ui.save=function(){var t=!0;e.model.userPermission.add||(t=!1,c.error("you have no permission !")),t&&u.primaryConfirm("Save Purchase Order Request !").confirm(function(){e.model.savePurchaseOrderRequest().then(function(){e.ui.mode="IDEAL",e.model.clear(),e.chxNBT=!1,e.chxVAT=!1,c.success("Purchase Order Request Save Success !")})}).discard(function(){c.error("Purchase Order Request Save Fail !"),console.log("fail")})},e.ui.addData=function(){e.model.addData(),e.ui.focus("#barcode")},e.ui.focus=function(e){o(function(){angular.element(document.querySelectorAll(e))[0].focus()},10)},e.ui.validateBarcode=function(t){13===(t?t.keyCode||t.which:13)&&(e.model.data.supplier?(e.model.validateBarcode(e.model.tempData.barcode),e.model.tempData.item?e.ui.focus("#qty"):(c.error("Item not found!"),e.ui.focus("#barcode"))):c.error("Select Supplier for add Item"))},e.ui.setItemDetail=function(t){e.model.data.supplier?(e.model.setItemDetail(t),e.model.tempData.item?e.ui.focus("#qty"):e.ui.focus("#item")):c.error("Select Supplier for add Item")},e.ui.loadItem=function(t){0===e.model.data.purchaseOrderItemList.length?e.model.loadItem(t):u.primaryConfirm("Do you want to change Supplier !").confirm(function(){e.model.data={},e.model.tempData={},e.model.summaryData={},e.model.supplierItems=[],e.chxNBT=!1,e.chxVAT=!1,c.success("Supplier Chaneged !")}).discard(function(){e.model.data.supplier=null,console.log("fail")})},e.ui.calculatedValue=function(){e.model.tempData.value=(parseFloat(e.model.tempData.qty)*parseFloat(e.model.tempData.price)).toFixed(2),e.model.tempData.netValue=e.model.tempData.value,e.ui.calculateDiscountWithRate()},e.ui.calculateDiscountWithRate=function(){e.model.tempData.discountValue=(parseFloat(e.model.tempData.value)*parseFloat(e.model.tempData.discount)/100).toFixed(2),e.model.tempData.netValue=(parseFloat(e.model.tempData.value)-parseFloat(e.model.tempData.discountValue)).toFixed(2)},e.ui.calculateDiscountWithValue=function(){e.model.tempData.discount=(100*parseFloat(e.model.tempData.discountValue)/parseFloat(e.model.tempData.value)).toFixed(2),e.model.tempData.netValue=(parseFloat(e.model.tempData.value)-parseFloat(e.model.tempData.discountValue)).toFixed(2)},e.ui.callAddData=function(){13===(event?event.keyCode||event.which:13)&&e.ui.addData()},e.ui.checkBoxNBTFunction=function(){e.chxNBT?e.model.data.nbt=2:e.model.data.nbt=0,e.ui.calculateNBT()},e.ui.checkBoxVATFunction=function(){e.chxVAT?e.model.data.vat=15:e.model.data.vat=0,e.ui.calculateVAT(e.model.data.vat)},e.ui.calculateNBT=function(){e.model.data.nbtValue=(parseFloat(e.model.data.itemValue)*parseFloat(e.model.data.nbt)/100).toFixed(2),e.model.data.grandTotal=(parseFloat(e.model.data.itemValue)+parseFloat(e.model.data.nbtValue)).toFixed(2),e.model.data.vatValue=null,e.model.data.vat=null,e.chxVat=!1},e.ui.calculateVAT=function(t){var n=e.model.data.nbtValue;e.model.data.nbtValue||(n=0),e.model.data.vatValue=((parseFloat(e.model.data.itemValue)+parseFloat(n))*parseFloat(t)/100).toFixed(2),e.model.data.grandTotal=(parseFloat(e.model.data.itemValue)+parseFloat(n)+parseFloat(e.model.data.vatValue)).toFixed(2)},e.modalOpen=function(){e.model.tempData.item?(e.model.getBranchesStock(),o(function(){t.getBranchesStockList=e.model.branchesStockList,n.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"app/service/purchase-order/popup-dialog/branch-stock-popup.html",controller:"purchaseOrderRequestController",size:"lg"})},1e3)):c.error("Select a Item for View Branches Stock Quantity")},e.dismissAllModel=function(){a.dismissAll()},e.ui.selectAllReOrderItem=function(t){e.model.selectAllReOrderItem(t)},e.ui.editReOrderItem=function(t){e.model.editReOrderItem(t)},e.ui.setEditableReOrderItem=function(){e.model.setEditableReOrderItem()},e.ui.selectReOrderItemIndex=function(t){e.selectedIndex===t?e.selectedIndex=-1:e.selectedIndex=t},e.init=function(){e.ui.mode="IDEAL"},e.init()}])}(),function(){angular.module("appModule").factory("purchaseOrderRequestModel",["PurchaseOrderRequestService","Notification","PurchaseOrderRequestModelFactory","$q",function(e,t,n,a){function i(){this.constructor()}return i.prototype={data:{},tempData:{},summaryData:{},reOrderData:{},reOrderTempData:{},userPermission:{},suppliers:[],allItems:[],supplierItems:[],branchesStockList:[],reOrderItems:[],mainBranchAvailableStock:0,constructor:function(){var t=this;this.data=n.newData(),this.tempData=n.tempData(),this.summaryData=n.summaryData(),this.reOrderData=n.reOrderData(),this.reOrderTempData=n.reOrderTempData(),e.loadSuppliers().success(function(e){t.suppliers=e}),e.loadItems().success(function(e){t.allItems=e}),e.getPermission("Purchase Order Request").success(function(e){t.userPermission=e})},supplierLable:function(e){var t;return angular.forEach(this.suppliers,function(n){if(n.indexNo===e)return void(t=n.indexNo+" - "+n.name)}),t},loadItem:function(e){var t=this;this.supplierItems=[],angular.forEach(this.allItems,function(n){n.supplier===e&&t.supplierItems.push(n)})},validateBarcode:function(e){var t=null;angular.forEach(this.supplierItems,function(n){if(n.barcode===e)return void(t=n)}),t?(this.tempData.item=t.indexNo,this.tempData.price=t.supplierPrice,this.tempData.discount=t.discount,this.getStockQty(t.indexNo)):this.tempData.item=null},itemLable:function(e){var t;return angular.forEach(this.supplierItems,function(n){if(n.indexNo===e)return void(t=n.barcode+" - "+n.name)}),t},itemLableByAllItem:function(e){var t;return angular.forEach(this.allItems,function(n){if(n.indexNo===e)return void(t=n.barcode+" - "+n.name)}),t},setItemDetail:function(e){var t=null;angular.forEach(this.supplierItems,function(n){if(n.indexNo===e)return void(t=n)}),t?(this.tempData.barcode=t.barcode,this.tempData.price=t.supplierPrice,this.tempData.discount=t.discount,this.getStockQty(t.indexNo)):this.tempData.item=null},getBranchesStock:function(){var t=this,n=this.tempData.item;e.getBranchesStock(n).success(function(e){t.branchesStockList=e})},addData:function(){var e=this,a=!0;e.tempData.item||(a=!1,t.error("Select Item for Add Purchase Order Item !")),e.tempData.price||(a=!1,t.error("Select price for Add Purchase Order Item !")),e.tempData.qty||(a=!1,t.error("Select Qty for Add Purchase Order Item !")),e.tempData.netValue||(a=!1,t.error("Invalide Format")),a&&(this.data.purchaseOrderItemList.push(this.tempData),this.tempData=n.tempData(),this.summaryCalculator())},edit:function(e){this.tempData=this.data.purchaseOrderItemList[e],this.data.purchaseOrderItemList.splice(e,1),this.summaryCalculator()},removeAll:function(){this.data=n.newData(),this.tempData=n.tempData(),this.summaryData=n.summaryData()},delete:function(e){this.data.purchaseOrderItemList.splice(e,1),this.summaryCalculator()},getItemName:function(e){var t=null;return angular.forEach(this.supplierItems,function(n){if(n.indexNo===e)return void(t=n.name)}),t},getItem:function(e){var t=null;return angular.forEach(this.allItems,function(n){if(n.indexNo===e)return void(t=n)}),t},summaryCalculator:function(){var e=0,t=0,n=0,a=0;angular.forEach(this.data.purchaseOrderItemList,function(i){e=(parseFloat(e)+parseFloat(i.qty)).toFixed(2),t=(parseFloat(t)+parseFloat(i.value)).toFixed(2),n=(parseFloat(n)+parseFloat(i.discountValue)).toFixed(2),a=(parseFloat(a)+parseFloat(i.netValue)).toFixed(2)}),this.summaryData.qty=e,this.summaryData.value=t,this.summaryData.discountValue=n,this.data.itemValue=a,this.data.grandTotal=a},summaryCalculatorForLoad:function(){var e=0,t=0,n=0,a=0;angular.forEach(this.data.purchaseOrderItemList,function(i){e=(parseFloat(e)+parseFloat(i.qty)).toFixed(2),t=(parseFloat(t)+parseFloat(i.value)).toFixed(2),n=(parseFloat(n)+parseFloat(i.discountValue)).toFixed(2),a=(parseFloat(a)+parseFloat(i.netValue)).toFixed(2)}),this.summaryData.qty=e,this.summaryData.value=t,this.summaryData.discountValue=n,this.data.itemValue=a},getStockQty:function(t){var n=this;t&&e.getStockQty(t).success(function(e){n.tempData.stockQty=e})},savePurchaseOrderRequest:function(){var n=a.defer(),i=this,o=!0;if(i.data.supplier||(o=!1,t.error("Select Supplier for Save Purchase Order Request!")),i.data.date||(o=!1,t.error("Select Date for Save Purchase Order Request !")),i.data.deliverDate||(o=!1,t.error("Select DeliverDate for Save Purchase Order Request !")),0===i.data.purchaseOrderItemList.length&&(o=!1,t.error("Add Purchase Order Item for Save Purchase Order Request !")),i.tempData.netValue&&(o=!1,t.error("Remove Editing Item for save Purchase Order Request !")),i.tempData.item&&(o=!1,t.error("Remove Editing Item for save Purchase Order Request !")),o)return e.savePurchaseOrderRequest(JSON.stringify(this.data)).success(function(e){n.resolve()}).error(function(e){n.reject()}),n.promise},clear:function(){this.data=n.newData(),this.tempData=n.tempData(),this.summaryData=n.summaryData()},loadPendingPurchaseOrderByNumber:function(){var a=this;return this.tempData=n.tempData(),this.summaryData=n.summaryData(),e.loadPendingPurchaseOrderByNumber(this.data.number).success(function(e){a.data=e,a.summaryCalculatorForLoad(),a.data.number?t.info("This Purchasse Order status is "+a.data.status+"."):t.error("Not Found Purchase Order for this Number !")}),a.data.number},loadReOrderItem:function(){var t=this;e.loadReOrderItem().success(function(e){t.reOrderItems=e,console.log(e),console.log("data")})},selectAllReOrderItem:function(e){var t=this;angular.forEach(this.reOrderItems,function(n){if(e===n.reOrderIndexNo){var a=t.getItem(n.item);t.loadItem(n.supplierId),t.data.supplier=n.supplierId;var i={indexNo:null,purchaseOrder:null,item:n.item,barcode:a.barcode,price:a.supplierPrice,qty:n.netRequiredQty,value:(parseFloat(a.supplierPrice)*parseFloat(n.netRequiredQty)).toFixed(2),discount:a.discount,discountValue:(parseFloat(n.netRequiredQty)*parseFloat(a.supplierPrice)*parseFloat(a.discount)/100).toFixed(2),netValue:(parseFloat(a.supplierPrice)*parseFloat(n.netRequiredQty)-parseFloat(n.netRequiredQty)*parseFloat(a.supplierPrice)*parseFloat(a.discount)/100).toFixed(2),stockQty:n.stockQty,orderQty:n.netRequiredQty,recieveQty:0,balanceQty:n.netRequiredQty,status:"PENDING"};return void t.data.purchaseOrderItemList.push(i)}}),this.summaryCalculator()},editReOrderItem:function(e){var t=this;angular.forEach(this.reOrderItems,function(n,a){e===n.reOrderIndexNo&&(console.log(a),t.reOrderTempData=n)})},setEditableReOrderItem:function(){var e=!0;if(this.reOrderTempData.item||(e=!1,t.error("Not Found ReOrder Editable Item !")),this.reOrderTempData.netRequiredQty<0&&(e=!1,t.error("Wrong Quantity !")),this.reOrderTempData.netRequiredQty>this.reOrderTempData.totalOrder&&(t.error("Quantity Out of Range !"),e=!1),e){var a=this,i=this.reOrderTempData,o=a.getItem(i.item);a.loadItem(i.supplierId),a.data.supplier=i.supplierId;var r={indexNo:null,purchaseOrder:null,item:i.item,barcode:o.barcode,price:o.supplierPrice,qty:i.netRequiredQty,value:parseFloat(o.supplierPrice)*parseFloat(i.netRequiredQty),discount:o.discount,discountValue:parseFloat(i.netRequiredQty)*parseFloat(o.supplierPrice)*parseFloat(o.discount)/100,netValue:parseFloat(o.supplierPrice)*parseFloat(i.netRequiredQty)-parseFloat(i.netRequiredQty)*parseFloat(o.supplierPrice)*parseFloat(o.discount)/100,stockQty:i.stockQty,orderQty:i.netRequiredQty,recieveQty:0,balanceQty:i.netRequiredQty,status:"PENDING"};a.data.purchaseOrderItemList.push(r),this.reOrderTempData=n.reOrderTempData(),this.summaryCalculator()}},selectRequiredItems:function(){}},i}])}();